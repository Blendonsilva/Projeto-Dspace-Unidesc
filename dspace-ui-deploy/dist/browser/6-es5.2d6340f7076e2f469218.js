!function(){function e(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var i,a,r=[],o=!0,c=!1;try{for(n=n.call(e);!(o=(i=n.next()).done)&&(r.push(i.value),!t||r.length!==t);o=!0);}catch(s){c=!0,a=s}finally{try{o||null==n.return||n.return()}finally{if(c)throw a}}return r}(e,t)||n(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||n(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function a(){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=r(e,t);if(i){var a=Object.getOwnPropertyDescriptor(i,t);return a.get?a.get.call(arguments.length<3?e:n):a.value}}).apply(this,arguments)}function r(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=m(e)););return e}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function s(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=m(e);if(t){var a=m(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return u(this,n)}}function u(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{"0TMo":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("HENg"),a=n("lJxs"),r=function(e){l(n,e);var t=p(n);function n(){return o(this,n),t.apply(this,arguments)}return s(n,[{key:"getFeatureIDs",value:function(e,t){return this.getFeatureID(e,t).pipe(Object(a.a)((function(e){return[e]})))}}]),n}(i.a)},"0qhl":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("fXoL"),a=function(){var e=function(){function e(){o(this,e)}return s(e,[{key:"canActivate",value:function(e,t){return e.data={title:e.params.configuration+".search.title"},!0}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=i["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac}),e}()},"4vdZ":function(e,t,n){"use strict";n.d(t,"a",(function(){return Q}));var i,r,c,d,u=n("fXoL"),f=n("LvDl"),b=n("SxV6"),v=n("eIep"),h=n("1QIV"),g=n("cBt8"),x=n("GsQf"),y=n("J3qs"),j=n("ac5F"),O=n("X8f1"),S=function e(t,n){o(this,e),this.op=t,this.field=n},I=((d=function(e){l(n,e);var t=p(n);function n(e,i){var a;return o(this,n),(a=t.call(this,n.operationType,e)).value=i,a}return s(n,[{key:"toOperation",value:function(){return{op:this.op,path:"/metadata/".concat(this.field,"/-"),value:this.value}}}]),n}(S)).operationType="add",d),C=((c=function(e){l(n,e);var t=p(n);function n(e,i){var a;return o(this,n),(a=t.call(this,n.operationType,e)).place=i,a}return s(n,[{key:"toOperation",value:function(){return{op:this.op,path:"/metadata/".concat(this.field,"/").concat(this.place)}}}]),n}(S)).operationType="remove",c),w=((r=function(e){l(n,e);var t=p(n);function n(e,i,a){var r;return o(this,n),(r=t.call(this,n.operationType,e)).place=i,r.value=a,r}return s(n,[{key:"toOperation",value:function(){return{op:this.op,path:"/metadata/".concat(this.field,"/").concat(this.place),value:this.value}}}]),n}(S)).operationType="replace",r),k=((i=function(){function e(){o(this,e)}return s(e,[{key:"fieldUpdatesToPatchOperations",value:function(e){var t=this.fieldUpdatesToMetadataPatchOperations(e),n=new Map,i=[];return t.forEach((function(e){e.op!==C.operationType&&e.op!==w.operationType||!Object(y.b)(e.place)||n.has(e.field)&&n.get(e.field).forEach((function(t){t<e.place&&e.place--})),e.op===C.operationType&&Object(y.b)(e.place)&&(n.has(e.field)||n.set(e.field,[]),n.get(e.field).push(e.place)),i.push(e.toOperation())})),i}},{key:"fieldUpdatesToMetadataPatchOperations",value:function(e){var t=[];return Object.keys(e).forEach((function(n){var i,a=e[n],r=a.field,o={value:r.value,language:r.language};switch(a.changeType){case O.c.ADD:i=new I(r.key,[o]);break;case O.c.REMOVE:i=new C(r.key,r.place);break;case O.c.UPDATE:i=new w(r.key,r.place,o)}t.push(i)})),t}}]),e}()).\u0275fac=function(e){return new(e||i)},i.\u0275prov=u["\u0275\u0275defineInjectable"]({token:i,factory:i.\u0275fac,providedIn:"root"}),i),E=n("iqTE"),M=n("loKC"),B=n("tyNb"),V=n("lI3o"),R=n("sYmb"),P=n("ofXK"),T=n("mo41"),F=n("VYMa"),$=n("snSO");function D(e,t){if(1&e){var n=u["\u0275\u0275getCurrentView"]();u["\u0275\u0275elementStart"](0,"button",14),u["\u0275\u0275listener"]("click",(function(){return u["\u0275\u0275restoreView"](n),u["\u0275\u0275nextContext"]().reinstate()})),u["\u0275\u0275element"](1,"i",15),u["\u0275\u0275text"](2,"\n      "),u["\u0275\u0275elementStart"](3,"span",4),u["\u0275\u0275text"](4),u["\u0275\u0275pipe"](5,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](6,"\n    "),u["\u0275\u0275elementEnd"]()}2&e&&(u["\u0275\u0275advance"](4),u["\u0275\u0275textInterpolate1"]("\xa0",u["\u0275\u0275pipeBind1"](5,1,"item.edit.metadata.reinstate-button"),""))}function U(e,t){if(1&e){var n=u["\u0275\u0275getCurrentView"]();u["\u0275\u0275elementStart"](0,"button",16),u["\u0275\u0275listener"]("click",(function(){return u["\u0275\u0275restoreView"](n),u["\u0275\u0275nextContext"]().discard()})),u["\u0275\u0275pipe"](1,"async"),u["\u0275\u0275element"](2,"i",17),u["\u0275\u0275text"](3,"\n      "),u["\u0275\u0275elementStart"](4,"span",4),u["\u0275\u0275text"](5),u["\u0275\u0275pipe"](6,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](7,"\n    "),u["\u0275\u0275elementEnd"]()}if(2&e){var i=u["\u0275\u0275nextContext"]();u["\u0275\u0275property"]("disabled",!u["\u0275\u0275pipeBind1"](1,2,i.hasChanges())),u["\u0275\u0275advance"](5),u["\u0275\u0275textInterpolate1"]("\xa0",u["\u0275\u0275pipeBind1"](6,4,"item.edit.metadata.discard-button"),"")}}var z=function(){return{}},L=function(e,t,n){return{"table-warning":e,"table-danger":t,"table-success":n}};function _(e,t){if(1&e&&(u["\u0275\u0275elementStart"](0,"tr",24),u["\u0275\u0275text"](1,"\n\n    "),u["\u0275\u0275elementEnd"]()),2&e){var n=t.$implicit,i=u["\u0275\u0275nextContext"](2);u["\u0275\u0275property"]("fieldUpdate",n||u["\u0275\u0275pureFunction0"](3,z))("url",i.url)("ngClass",u["\u0275\u0275pureFunction3"](4,L,0===n.changeType,2===n.changeType,1===n.changeType))}}function A(e,t){if(1&e&&(u["\u0275\u0275elementStart"](0,"table",18),u["\u0275\u0275text"](1,"\n    "),u["\u0275\u0275elementStart"](2,"thead"),u["\u0275\u0275text"](3,"\n    "),u["\u0275\u0275elementStart"](4,"tr"),u["\u0275\u0275text"](5,"\n      "),u["\u0275\u0275elementStart"](6,"th"),u["\u0275\u0275elementStart"](7,"span",19),u["\u0275\u0275text"](8),u["\u0275\u0275pipe"](9,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](10,"\n      "),u["\u0275\u0275elementStart"](11,"th"),u["\u0275\u0275elementStart"](12,"span",20),u["\u0275\u0275text"](13),u["\u0275\u0275pipe"](14,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](15,"\n      "),u["\u0275\u0275elementStart"](16,"th",21),u["\u0275\u0275elementStart"](17,"span",22),u["\u0275\u0275text"](18),u["\u0275\u0275pipe"](19,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](20,"\n      "),u["\u0275\u0275elementStart"](21,"th",21),u["\u0275\u0275text"](22),u["\u0275\u0275pipe"](23,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](24,"\n    "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](25,"\n    "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](26,"\n    "),u["\u0275\u0275elementStart"](27,"tbody"),u["\u0275\u0275text"](28,"\n    "),u["\u0275\u0275template"](29,_,2,8,"tr",23),u["\u0275\u0275pipe"](30,"dsObjectValues"),u["\u0275\u0275pipe"](31,"async"),u["\u0275\u0275text"](32,"\n    "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](33,"\n  "),u["\u0275\u0275elementEnd"]()),2&e){var n=u["\u0275\u0275nextContext"]();u["\u0275\u0275advance"](8),u["\u0275\u0275textInterpolate"](u["\u0275\u0275pipeBind1"](9,6,"item.edit.metadata.headers.field")),u["\u0275\u0275advance"](5),u["\u0275\u0275textInterpolate"](u["\u0275\u0275pipeBind1"](14,8,"item.edit.metadata.headers.value")),u["\u0275\u0275advance"](5),u["\u0275\u0275textInterpolate"](u["\u0275\u0275pipeBind1"](19,10,"item.edit.metadata.headers.language")),u["\u0275\u0275advance"](4),u["\u0275\u0275textInterpolate"](u["\u0275\u0275pipeBind1"](23,12,"item.edit.metadata.headers.edit")),u["\u0275\u0275advance"](7),u["\u0275\u0275property"]("ngForOf",u["\u0275\u0275pipeBind1"](30,14,u["\u0275\u0275pipeBind1"](31,16,n.updates$)))("ngForTrackBy",n.trackUpdate)}}function N(e,t){if(1&e&&(u["\u0275\u0275elementStart"](0,"div"),u["\u0275\u0275text"](1,"\n    "),u["\u0275\u0275element"](2,"ds-alert",25),u["\u0275\u0275text"](3,"\n  "),u["\u0275\u0275elementEnd"]()),2&e){var n=u["\u0275\u0275nextContext"]();u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("content","item.edit.metadata.empty")("type",n.AlertTypeEnum.Info)}}function q(e,t){if(1&e){var n=u["\u0275\u0275getCurrentView"]();u["\u0275\u0275elementStart"](0,"button",14),u["\u0275\u0275listener"]("click",(function(){return u["\u0275\u0275restoreView"](n),u["\u0275\u0275nextContext"]().reinstate()})),u["\u0275\u0275element"](1,"i",15),u["\u0275\u0275text"](2),u["\u0275\u0275pipe"](3,"translate"),u["\u0275\u0275elementEnd"]()}2&e&&(u["\u0275\u0275advance"](2),u["\u0275\u0275textInterpolate1"](" ",u["\u0275\u0275pipeBind1"](3,1,"item.edit.metadata.reinstate-button"),"\n      "))}function K(e,t){if(1&e){var n=u["\u0275\u0275getCurrentView"]();u["\u0275\u0275elementStart"](0,"button",16),u["\u0275\u0275listener"]("click",(function(){return u["\u0275\u0275restoreView"](n),u["\u0275\u0275nextContext"]().discard()})),u["\u0275\u0275pipe"](1,"async"),u["\u0275\u0275element"](2,"i",17),u["\u0275\u0275text"](3),u["\u0275\u0275pipe"](4,"translate"),u["\u0275\u0275elementEnd"]()}if(2&e){var i=u["\u0275\u0275nextContext"]();u["\u0275\u0275property"]("disabled",!u["\u0275\u0275pipeBind1"](1,2,i.hasChanges())),u["\u0275\u0275advance"](3),u["\u0275\u0275textInterpolate1"](" ",u["\u0275\u0275pipeBind1"](4,4,"item.edit.metadata.discard-button"),"\n      ")}}var X,Q=((X=function(e){l(n,e);var t=p(n);function n(e,i,a,r,c,s){var l;return o(this,n),(l=t.call(this,e,i,a,r,c,s)).itemService=e,l.objectUpdatesService=i,l.router=a,l.notificationsService=r,l.translateService=c,l.route=s,l.AlertTypeEnum=j.a,l}return s(n,[{key:"ngOnInit",value:function(){a(m(n.prototype),"ngOnInit",this).call(this),Object(y.a)(this.updateService)&&(this.updateService=this.itemService)}},{key:"initializeUpdates",value:function(){this.updates$=this.objectUpdatesService.getFieldUpdates(this.url,this.item.metadataAsList)}},{key:"initializeNotificationsPrefix",value:function(){this.notificationsPrefix="item.edit.metadata.notifications."}},{key:"add",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new g.d;this.objectUpdatesService.saveAddFieldUpdate(this.url,e)}},{key:"initializeOriginalFields",value:function(){this.objectUpdatesService.initialize(this.url,this.item.metadataAsList,this.item.lastModified,k)}},{key:"submit",value:function(){var e=this;this.isValid().pipe(Object(b.a)()).subscribe((function(t){t?e.objectUpdatesService.createPatch(e.url).pipe(Object(b.a)(),Object(v.a)((function(t){return e.updateService.patch(e.item,t).pipe(Object(h.g)())}))).subscribe((function(t){t.hasFailed?e.notificationsService.error(e.getNotificationTitle("error"),t.errorMessage):(e.item=t.payload,e.checkAndFixMetadataUUIDs(),e.initializeOriginalFields(),e.updates$=e.objectUpdatesService.getFieldUpdates(e.url,e.item.metadataAsList),e.notificationsService.success(e.getNotificationTitle("saved"),e.getNotificationContent("saved")))})):e.notificationsService.error(e.getNotificationTitle("invalid"),e.getNotificationContent("invalid"))}))}},{key:"checkAndFixMetadataUUIDs",value:function(){var e=this,t=Object(f.cloneDeep)(this.item.metadata);Object.keys(this.item.metadata).forEach((function(n){t[n]=e.item.metadata[n].map((function(e){return Object(y.b)(e.uuid)?e:Object.assign(new g.c,e)}))})),this.item.metadata=t}}]),n}(x.a)).\u0275fac=function(e){return new(e||X)(u["\u0275\u0275directiveInject"](E.a),u["\u0275\u0275directiveInject"](M.a),u["\u0275\u0275directiveInject"](B.h),u["\u0275\u0275directiveInject"](V.a),u["\u0275\u0275directiveInject"](R.e),u["\u0275\u0275directiveInject"](B.a))},X.\u0275cmp=u["\u0275\u0275defineComponent"]({type:X,selectors:[["ds-item-metadata"]],inputs:{updateService:"updateService"},features:[u["\u0275\u0275InheritDefinitionFeature"]],decls:56,vars:39,consts:[[1,"item-metadata"],[1,"button-row","top","d-flex","mb-2"],[1,"mr-auto","btn","btn-success",3,"click"],[1,"fas","fa-plus"],[1,"d-none","d-sm-inline"],["class","btn btn-warning",3,"click",4,"ngIf"],[1,"btn","btn-primary",3,"disabled","click"],[1,"fas","fa-save"],["class","btn btn-danger",3,"disabled","click",4,"ngIf"],["class","table table-responsive table-striped table-bordered",4,"ngIf"],[4,"ngIf"],[1,"button-row","bottom"],[1,"mt-2","float-right"],[1,"btn","btn-primary","mr-0",3,"disabled","click"],[1,"btn","btn-warning",3,"click"],[1,"fas","fa-undo-alt"],[1,"btn","btn-danger",3,"disabled","click"],[1,"fas","fa-times"],[1,"table","table-responsive","table-striped","table-bordered"],["id","fieldName"],["id","fieldValue"],[1,"text-center"],["id","fieldLang"],["ds-edit-in-place-field","",3,"fieldUpdate","url","ngClass",4,"ngFor","ngForOf","ngForTrackBy"],["ds-edit-in-place-field","",3,"fieldUpdate","url","ngClass"],[3,"content","type"]],template:function(e,t){1&e&&(u["\u0275\u0275elementStart"](0,"div",0),u["\u0275\u0275text"](1,"\n  "),u["\u0275\u0275elementStart"](2,"div",1),u["\u0275\u0275text"](3,"\n    "),u["\u0275\u0275elementStart"](4,"button",2),u["\u0275\u0275listener"]("click",(function(){return t.add()})),u["\u0275\u0275element"](5,"i",3),u["\u0275\u0275text"](6,"\n      "),u["\u0275\u0275elementStart"](7,"span",4),u["\u0275\u0275text"](8),u["\u0275\u0275pipe"](9,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](10,"\n    "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](11,"\n    "),u["\u0275\u0275template"](12,D,7,3,"button",5),u["\u0275\u0275pipe"](13,"async"),u["\u0275\u0275text"](14,"\n    "),u["\u0275\u0275elementStart"](15,"button",6),u["\u0275\u0275listener"]("click",(function(){return t.submit()})),u["\u0275\u0275pipe"](16,"async"),u["\u0275\u0275pipe"](17,"async"),u["\u0275\u0275element"](18,"i",7),u["\u0275\u0275text"](19,"\n      "),u["\u0275\u0275elementStart"](20,"span",4),u["\u0275\u0275text"](21),u["\u0275\u0275pipe"](22,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](23,"\n    "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](24,"\n    "),u["\u0275\u0275template"](25,U,8,6,"button",8),u["\u0275\u0275pipe"](26,"async"),u["\u0275\u0275text"](27,"\n  "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](28,"\n  "),u["\u0275\u0275template"](29,A,34,18,"table",9),u["\u0275\u0275pipe"](30,"dsObjectValues"),u["\u0275\u0275pipe"](31,"async"),u["\u0275\u0275text"](32,"\n  "),u["\u0275\u0275template"](33,N,4,2,"div",10),u["\u0275\u0275pipe"](34,"dsObjectValues"),u["\u0275\u0275pipe"](35,"async"),u["\u0275\u0275text"](36,"\n  "),u["\u0275\u0275elementStart"](37,"div",11),u["\u0275\u0275text"](38,"\n    "),u["\u0275\u0275elementStart"](39,"div",12),u["\u0275\u0275text"](40,"\n      "),u["\u0275\u0275template"](41,q,4,3,"button",5),u["\u0275\u0275pipe"](42,"async"),u["\u0275\u0275text"](43,"\n      "),u["\u0275\u0275elementStart"](44,"button",13),u["\u0275\u0275listener"]("click",(function(){return t.submit()})),u["\u0275\u0275pipe"](45,"async"),u["\u0275\u0275element"](46,"i",7),u["\u0275\u0275text"](47),u["\u0275\u0275pipe"](48,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](49,"\n      "),u["\u0275\u0275template"](50,K,5,6,"button",8),u["\u0275\u0275pipe"](51,"async"),u["\u0275\u0275text"](52,"\n    "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](53,"\n  "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](54,"\n"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](55,"\n")),2&e&&(u["\u0275\u0275advance"](8),u["\u0275\u0275textInterpolate1"]("\xa0",u["\u0275\u0275pipeBind1"](9,11,"item.edit.metadata.add-button"),""),u["\u0275\u0275advance"](4),u["\u0275\u0275property"]("ngIf",u["\u0275\u0275pipeBind1"](13,13,t.isReinstatable())),u["\u0275\u0275advance"](3),u["\u0275\u0275property"]("disabled",!u["\u0275\u0275pipeBind1"](16,15,t.hasChanges())||!u["\u0275\u0275pipeBind1"](17,17,t.isValid())),u["\u0275\u0275advance"](6),u["\u0275\u0275textInterpolate1"]("\xa0",u["\u0275\u0275pipeBind1"](22,19,"item.edit.metadata.save-button"),""),u["\u0275\u0275advance"](4),u["\u0275\u0275property"]("ngIf",!u["\u0275\u0275pipeBind1"](26,21,t.isReinstatable())),u["\u0275\u0275advance"](4),u["\u0275\u0275property"]("ngIf",u["\u0275\u0275pipeBind1"](30,23,u["\u0275\u0275pipeBind1"](31,25,t.updates$)).length>0),u["\u0275\u0275advance"](4),u["\u0275\u0275property"]("ngIf",0==u["\u0275\u0275pipeBind1"](34,27,u["\u0275\u0275pipeBind1"](35,29,t.updates$)).length),u["\u0275\u0275advance"](8),u["\u0275\u0275property"]("ngIf",u["\u0275\u0275pipeBind1"](42,31,t.isReinstatable())),u["\u0275\u0275advance"](3),u["\u0275\u0275property"]("disabled",!u["\u0275\u0275pipeBind1"](45,33,t.hasChanges())),u["\u0275\u0275advance"](3),u["\u0275\u0275textInterpolate1"](" ",u["\u0275\u0275pipeBind1"](48,35,"item.edit.metadata.save-button"),"\n      "),u["\u0275\u0275advance"](3),u["\u0275\u0275property"]("ngIf",!u["\u0275\u0275pipeBind1"](51,37,t.isReinstatable())))},directives:[P.p,P.o,T.a,P.m,F.a],pipes:[R.d,P.b,$.a],styles:[".button-row[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{margin-right:calc(.5 * var(--bs-spacer))}.button-row[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:last-child{margin-right:0}@media screen and (min-width:576px){.button-row[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{min-width:var(--ds-edit-item-button-min-width)}}.button-row.top[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{margin-top:calc(var(--bs-spacer) / 2);margin-bottom:calc(var(--bs-spacer) / 2)}"]}),X)},"8jtY":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("WL0R"),a={RESOLVED:Object(i.a)("dspace/resolver/RESOLVED")},r=function e(t,n){o(this,e),this.type=a.RESOLVED,this.payload={url:t,dso:n}}},"920W":function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var i=n("fXoL"),a=n("0TMo"),r=n("LRne"),c=n("FU+A"),d=n("z3/6"),u=n("1mcE"),m=n("tyNb"),f=n("Vurf"),b=function(){var e=function(e){l(n,e);var t=p(n);function n(e,i,a,r){var c;return o(this,n),(c=t.call(this,e,i,a,r)).resolver=e,c.authorizationService=i,c.router=a,c.authService=r,c}return s(n,[{key:"getFeatureID",value:function(e,t){return Object(r.a)(c.a.AdministratorOf)}}]),n}(a.a);return e.\u0275fac=function(t){return new(t||e)(i["\u0275\u0275inject"](d.a),i["\u0275\u0275inject"](u.a),i["\u0275\u0275inject"](m.h),i["\u0275\u0275inject"](f.a))},e.\u0275prov=i["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()},A0IO:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("fXoL"),a=n("J3qs"),r=n("q5u1"),c=n("tv3Y"),l=function(){var e=function(){function e(t){o(this,e),this.breadcrumbService=t}return s(e,[{key:"resolve",value:function(e,t){var n=e.data.breadcrumbKey;if(Object(a.a)(n))throw new Error('You provided an i18nBreadcrumbResolver for url "'+e.url+"\" but no breadcrumbKey in the route's data");var i=Object(r.b)(e);return{provider:this.breadcrumbService,key:n,url:i}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(i["\u0275\u0275inject"](c.a))},e.\u0275prov=i["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()},BZkK:function(i,r,c){"use strict";c.r(r),c.d(r,"EditItemPageModule",(function(){return aa}));var d=c("fXoL"),u=c("ofXK"),f=c("1kSV"),b=c("PCNd"),v=c("tyNb"),h=c("mEo1"),g=c("LRne"),x=c("itXk"),y=c("lJxs"),j=c("J3qs"),O=c("Xioo"),S=c("sYmb"),I=function(e){return{active:e}},C=function(e){return[e]};function w(e,t){if(1&e&&(d["\u0275\u0275elementStart"](0,"a",17),d["\u0275\u0275text"](1),d["\u0275\u0275pipe"](2,"translate"),d["\u0275\u0275elementEnd"]()),2&e){var n=d["\u0275\u0275nextContext"]().$implicit,i=d["\u0275\u0275nextContext"]();d["\u0275\u0275property"]("ngClass",d["\u0275\u0275pureFunction1"](5,I,n.page===i.currentPage))("routerLink",d["\u0275\u0275pureFunction1"](7,C,"./"+n.page)),d["\u0275\u0275advance"](1),d["\u0275\u0275textInterpolate1"]("\n                            ",d["\u0275\u0275pipeBind1"](2,3,"item.edit.tabs."+n.page+".head"),"\n                        ")}}function k(e,t){if(1&e&&(d["\u0275\u0275elementStart"](0,"button",18),d["\u0275\u0275text"](1),d["\u0275\u0275pipe"](2,"translate"),d["\u0275\u0275elementEnd"]()),2&e){var n=d["\u0275\u0275nextContext"]().$implicit;d["\u0275\u0275advance"](1),d["\u0275\u0275textInterpolate1"]("\n                                ",d["\u0275\u0275pipeBind1"](2,1,"item.edit.tabs."+n.page+".head"),"\n                            ")}}function E(e,t){if(1&e&&(d["\u0275\u0275elementStart"](0,"li",13),d["\u0275\u0275text"](1,"\n                        "),d["\u0275\u0275template"](2,w,3,9,"a",14),d["\u0275\u0275pipe"](3,"async"),d["\u0275\u0275text"](4,"\n                        "),d["\u0275\u0275elementStart"](5,"span",15),d["\u0275\u0275pipe"](6,"translate"),d["\u0275\u0275text"](7,"\n                            "),d["\u0275\u0275template"](8,k,3,3,"button",16),d["\u0275\u0275pipe"](9,"async"),d["\u0275\u0275text"](10,"\n                        "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](11,"\n                    "),d["\u0275\u0275elementEnd"]()),2&e){var n=t.$implicit;d["\u0275\u0275advance"](2),d["\u0275\u0275property"]("ngIf",d["\u0275\u0275pipeBind1"](3,3,n.enabled)),d["\u0275\u0275advance"](3),d["\u0275\u0275property"]("ngbTooltip",d["\u0275\u0275pipeBind1"](6,5,"item.edit.tabs.disabled.tooltip")),d["\u0275\u0275advance"](3),d["\u0275\u0275property"]("ngIf",!d["\u0275\u0275pipeBind1"](9,7,n.enabled))}}var M,B,V,R,P,T,F=((M=function(){function e(t,n,i){var a=this;o(this,e),this.route=t,this.router=n,this.injector=i,this.router.events.subscribe((function(){return a.initPageParamsByRoute()}))}return s(e,[{key:"ngOnInit",value:function(){var e=this;this.initPageParamsByRoute(),this.pages=this.route.routeConfig.children.filter((function(e){return Object(j.e)(e.path)})).map((function(t){var n=Object(g.a)(!0);return Object(j.e)(t.canActivate)&&(n=Object(x.a)(t.canActivate.map((function(t){return e.injector.get(t).canActivate(e.route.snapshot,e.router.routerState.snapshot)}))).pipe(Object(y.a)((function(e){return e.every((function(e){return!0===e}))})))),{page:t.path,enabled:n}})),this.itemRD$=this.route.data.pipe(Object(y.a)((function(e){return e.dso})))}},{key:"getItemPage",value:function(e){return Object(O.h)(e)}},{key:"initPageParamsByRoute",value:function(){this.currentPage=this.route.snapshot.firstChild.routeConfig.path}}]),e}()).\u0275fac=function(e){return new(e||M)(d["\u0275\u0275directiveInject"](v.a),d["\u0275\u0275directiveInject"](v.h),d["\u0275\u0275directiveInject"](d.Injector))},M.\u0275cmp=d["\u0275\u0275defineComponent"]({type:M,selectors:[["ds-edit-item-page"]],decls:41,vars:10,consts:[[1,"container"],[1,"row"],[1,"col-12"],[1,"border-bottom"],[1,"pt-2"],[1,"nav","nav-tabs","justify-content-start"],["class","nav-item",4,"ngFor","ngForOf"],[1,"tab-pane","active"],[1,"mb-4"],[1,"button-row","bottom"],[1,"text-right"],["role","button",1,"btn","btn-outline-secondary","mr-1",3,"routerLink"],[1,"fas","fa-arrow-left"],[1,"nav-item"],["class","nav-link",3,"ngClass","routerLink",4,"ngIf"],[3,"ngbTooltip"],["class","nav-link disabled",4,"ngIf"],[1,"nav-link",3,"ngClass","routerLink"],[1,"nav-link","disabled"]],template:function(e,t){var n;(1&e&&(d["\u0275\u0275elementStart"](0,"div",0),d["\u0275\u0275text"](1,"\n    "),d["\u0275\u0275elementStart"](2,"div",1),d["\u0275\u0275text"](3,"\n        "),d["\u0275\u0275elementStart"](4,"div",2),d["\u0275\u0275text"](5,"\n            "),d["\u0275\u0275elementStart"](6,"h2",3),d["\u0275\u0275text"](7),d["\u0275\u0275pipe"](8,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](9,"\n            "),d["\u0275\u0275elementStart"](10,"div",4),d["\u0275\u0275text"](11,"\n                "),d["\u0275\u0275elementStart"](12,"ul",5),d["\u0275\u0275text"](13,"\n                    "),d["\u0275\u0275template"](14,E,12,9,"li",6),d["\u0275\u0275text"](15,"\n                "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](16,"\n                "),d["\u0275\u0275elementStart"](17,"div",7),d["\u0275\u0275text"](18,"\n                    "),d["\u0275\u0275elementStart"](19,"div",8),d["\u0275\u0275text"](20,"\n                        "),d["\u0275\u0275element"](21,"router-outlet"),d["\u0275\u0275text"](22,"\n                    "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](23,"\n                    "),d["\u0275\u0275elementStart"](24,"div",9),d["\u0275\u0275text"](25,"\n                      "),d["\u0275\u0275elementStart"](26,"div",10),d["\u0275\u0275text"](27,"\n                        "),d["\u0275\u0275elementStart"](28,"a",11),d["\u0275\u0275pipe"](29,"async"),d["\u0275\u0275element"](30,"i",12),d["\u0275\u0275text"](31),d["\u0275\u0275pipe"](32,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](33,"\n                      "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](34,"\n                    "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](35,"\n                "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](36,"\n            "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](37,"\n        "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](38,"\n    "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](39,"\n"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](40,"\n")),2&e)&&(d["\u0275\u0275advance"](7),d["\u0275\u0275textInterpolate"](d["\u0275\u0275pipeBind1"](8,4,"item.edit.head")),d["\u0275\u0275advance"](7),d["\u0275\u0275property"]("ngForOf",t.pages),d["\u0275\u0275advance"](14),d["\u0275\u0275property"]("routerLink",t.getItemPage(null==(n=d["\u0275\u0275pipeBind1"](29,6,t.itemRD$))?null:n.payload)),d["\u0275\u0275advance"](3),d["\u0275\u0275textInterpolate1"](" ",d["\u0275\u0275pipeBind1"](32,8,"item.edit.return"),""))},directives:[u.o,v.m,v.k,u.p,f.O,u.m],pipes:[S.d,u.b],encapsulation:2,data:{animation:[h.a,h.c]},changeDetection:0}),M),$=c("1QIV"),D=c("SxV6"),U=c("lI3o"),z=c("iqTE"),L=c("aCx6"),_=function(e){return{id:e}},A=function(e){return[e,"edit"]},N=((B=function(){function e(t,n,i,a,r){o(this,e),this.route=t,this.router=n,this.notificationsService=i,this.itemDataService=a,this.translateService=r}return s(e,[{key:"ngOnInit",value:function(){var e=this;this.itemRD$=this.route.data.pipe(Object(y.a)((function(e){return e.dso})),Object($.i)()),this.itemRD$.pipe(Object(D.a)()).subscribe((function(t){e.item=t.payload,e.itemPageRoute=Object(O.h)(e.item)})),this.confirmMessage="item.edit."+this.messageKey+".confirm",this.cancelMessage="item.edit."+this.messageKey+".cancel",this.headerMessage="item.edit."+this.messageKey+".header",this.descriptionMessage="item.edit."+this.messageKey+".description"}},{key:"performAction",value:function(){}},{key:"processRestResponse",value:function(e){var t,n=this;e.hasSucceeded?this.itemDataService.findById(this.item.id).pipe((t=this.predicate,function(e){return e.pipe(Object($.c)(),Object(D.a)(t))})).subscribe((function(){n.notificationsService.success(n.translateService.get("item.edit."+n.messageKey+".success")),n.router.navigate([Object(O.e)(n.item)])})):(this.notificationsService.error(this.translateService.get("item.edit."+this.messageKey+".error")),this.router.navigate([Object(O.e)(this.item)]))}}]),e}()).\u0275fac=function(e){return new(e||B)(d["\u0275\u0275directiveInject"](v.a),d["\u0275\u0275directiveInject"](v.h),d["\u0275\u0275directiveInject"](U.a),d["\u0275\u0275directiveInject"](z.a),d["\u0275\u0275directiveInject"](S.e))},B.\u0275cmp=d["\u0275\u0275defineComponent"]({type:B,selectors:[["ds-simple-action"]],decls:27,vars:19,consts:[[1,"container"],[1,"row"],[1,"col-12"],[3,"item"],[1,"btn","btn-outline-secondary","perform-action",3,"click"],[1,"btn","btn-outline-secondary","cancel",3,"routerLink"]],template:function(e,t){1&e&&(d["\u0275\u0275elementStart"](0,"div",0),d["\u0275\u0275text"](1,"\n    "),d["\u0275\u0275elementStart"](2,"div",1),d["\u0275\u0275text"](3,"\n        "),d["\u0275\u0275elementStart"](4,"div",2),d["\u0275\u0275text"](5,"\n            "),d["\u0275\u0275elementStart"](6,"h2"),d["\u0275\u0275text"](7),d["\u0275\u0275pipe"](8,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](9,"\n            "),d["\u0275\u0275elementStart"](10,"p"),d["\u0275\u0275text"](11),d["\u0275\u0275pipe"](12,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](13,"\n            "),d["\u0275\u0275element"](14,"ds-modify-item-overview",3),d["\u0275\u0275text"](15,"\n            "),d["\u0275\u0275elementStart"](16,"button",4),d["\u0275\u0275listener"]("click",(function(){return t.performAction()})),d["\u0275\u0275text"](17),d["\u0275\u0275pipe"](18,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](19,"\n            "),d["\u0275\u0275elementStart"](20,"button",5),d["\u0275\u0275text"](21),d["\u0275\u0275pipe"](22,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](23,"\n\n        "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](24,"\n    "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](25,"\n\n"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](26,"\n")),2&e&&(d["\u0275\u0275advance"](7),d["\u0275\u0275textInterpolate"](d["\u0275\u0275pipeBind2"](8,6,t.headerMessage,d["\u0275\u0275pureFunction1"](15,_,t.item.handle))),d["\u0275\u0275advance"](4),d["\u0275\u0275textInterpolate"](d["\u0275\u0275pipeBind1"](12,9,t.descriptionMessage)),d["\u0275\u0275advance"](3),d["\u0275\u0275property"]("item",t.item),d["\u0275\u0275advance"](3),d["\u0275\u0275textInterpolate1"]("",d["\u0275\u0275pipeBind1"](18,11,t.confirmMessage),"\n            "),d["\u0275\u0275advance"](3),d["\u0275\u0275property"]("routerLink",d["\u0275\u0275pureFunction1"](17,A,t.itemPageRoute)),d["\u0275\u0275advance"](1),d["\u0275\u0275textInterpolate1"]("\n                ",d["\u0275\u0275pipeBind1"](22,13,t.cancelMessage),"\n            "))},directives:[L.a,v.i],pipes:[S.d],encapsulation:2}),B),q=function(e){return{id:e}},K=function(e){return[e,"edit"]},X=((V=function(e){l(n,e);var t=p(n);function n(e,i,a,r,c){var s;return o(this,n),(s=t.call(this,e,i,a,r,c)).route=e,s.router=i,s.notificationsService=a,s.itemDataService=r,s.translateService=c,s.messageKey="withdraw",s.predicate=function(e){return e.payload.isWithdrawn},s}return s(n,[{key:"performAction",value:function(){var e=this;this.itemDataService.setWithDrawn(this.item,!0).pipe(Object($.g)()).subscribe((function(t){e.processRestResponse(t)}))}}]),n}(N)).\u0275fac=function(e){return new(e||V)(d["\u0275\u0275directiveInject"](v.a),d["\u0275\u0275directiveInject"](v.h),d["\u0275\u0275directiveInject"](U.a),d["\u0275\u0275directiveInject"](z.a),d["\u0275\u0275directiveInject"](S.e))},V.\u0275cmp=d["\u0275\u0275defineComponent"]({type:V,selectors:[["ds-item-withdraw"]],features:[d["\u0275\u0275InheritDefinitionFeature"]],decls:27,vars:19,consts:[[1,"container"],[1,"row"],[1,"col-12"],[3,"item"],[1,"btn","btn-outline-secondary","perform-action",3,"click"],[1,"btn","btn-outline-secondary","cancel",3,"routerLink"]],template:function(e,t){1&e&&(d["\u0275\u0275elementStart"](0,"div",0),d["\u0275\u0275text"](1,"\n    "),d["\u0275\u0275elementStart"](2,"div",1),d["\u0275\u0275text"](3,"\n        "),d["\u0275\u0275elementStart"](4,"div",2),d["\u0275\u0275text"](5,"\n            "),d["\u0275\u0275elementStart"](6,"h2"),d["\u0275\u0275text"](7),d["\u0275\u0275pipe"](8,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](9,"\n            "),d["\u0275\u0275elementStart"](10,"p"),d["\u0275\u0275text"](11),d["\u0275\u0275pipe"](12,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](13,"\n            "),d["\u0275\u0275element"](14,"ds-modify-item-overview",3),d["\u0275\u0275text"](15,"\n            "),d["\u0275\u0275elementStart"](16,"button",4),d["\u0275\u0275listener"]("click",(function(){return t.performAction()})),d["\u0275\u0275text"](17),d["\u0275\u0275pipe"](18,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](19,"\n            "),d["\u0275\u0275elementStart"](20,"button",5),d["\u0275\u0275text"](21),d["\u0275\u0275pipe"](22,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](23,"\n\n        "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](24,"\n    "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](25,"\n\n"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](26,"\n")),2&e&&(d["\u0275\u0275advance"](7),d["\u0275\u0275textInterpolate"](d["\u0275\u0275pipeBind2"](8,6,t.headerMessage,d["\u0275\u0275pureFunction1"](15,q,t.item.handle))),d["\u0275\u0275advance"](4),d["\u0275\u0275textInterpolate"](d["\u0275\u0275pipeBind1"](12,9,t.descriptionMessage)),d["\u0275\u0275advance"](3),d["\u0275\u0275property"]("item",t.item),d["\u0275\u0275advance"](3),d["\u0275\u0275textInterpolate1"]("",d["\u0275\u0275pipeBind1"](18,11,t.confirmMessage),"\n            "),d["\u0275\u0275advance"](3),d["\u0275\u0275property"]("routerLink",d["\u0275\u0275pureFunction1"](17,K,t.itemPageRoute)),d["\u0275\u0275advance"](1),d["\u0275\u0275textInterpolate1"]("\n                ",d["\u0275\u0275pipeBind1"](22,13,t.cancelMessage),"\n            "))},directives:[L.a,v.i],pipes:[S.d],encapsulation:2}),V),Q=function(e){return{id:e}},W=function(e){return[e,"edit"]},J=((R=function(e){l(n,e);var t=p(n);function n(e,i,a,r,c){var s;return o(this,n),(s=t.call(this,e,i,a,r,c)).route=e,s.router=i,s.notificationsService=a,s.itemDataService=r,s.translateService=c,s.messageKey="reinstate",s.predicate=function(e){return!e.payload.isWithdrawn},s}return s(n,[{key:"performAction",value:function(){var e=this;this.itemDataService.setWithDrawn(this.item,!1).pipe(Object($.g)()).subscribe((function(t){e.processRestResponse(t)}))}}]),n}(N)).\u0275fac=function(e){return new(e||R)(d["\u0275\u0275directiveInject"](v.a),d["\u0275\u0275directiveInject"](v.h),d["\u0275\u0275directiveInject"](U.a),d["\u0275\u0275directiveInject"](z.a),d["\u0275\u0275directiveInject"](S.e))},R.\u0275cmp=d["\u0275\u0275defineComponent"]({type:R,selectors:[["ds-item-reinstate"]],features:[d["\u0275\u0275InheritDefinitionFeature"]],decls:27,vars:19,consts:[[1,"container"],[1,"row"],[1,"col-12"],[3,"item"],[1,"btn","btn-outline-secondary","perform-action",3,"click"],[1,"btn","btn-outline-secondary","cancel",3,"routerLink"]],template:function(e,t){1&e&&(d["\u0275\u0275elementStart"](0,"div",0),d["\u0275\u0275text"](1,"\n    "),d["\u0275\u0275elementStart"](2,"div",1),d["\u0275\u0275text"](3,"\n        "),d["\u0275\u0275elementStart"](4,"div",2),d["\u0275\u0275text"](5,"\n            "),d["\u0275\u0275elementStart"](6,"h2"),d["\u0275\u0275text"](7),d["\u0275\u0275pipe"](8,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](9,"\n            "),d["\u0275\u0275elementStart"](10,"p"),d["\u0275\u0275text"](11),d["\u0275\u0275pipe"](12,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](13,"\n            "),d["\u0275\u0275element"](14,"ds-modify-item-overview",3),d["\u0275\u0275text"](15,"\n            "),d["\u0275\u0275elementStart"](16,"button",4),d["\u0275\u0275listener"]("click",(function(){return t.performAction()})),d["\u0275\u0275text"](17),d["\u0275\u0275pipe"](18,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](19,"\n            "),d["\u0275\u0275elementStart"](20,"button",5),d["\u0275\u0275text"](21),d["\u0275\u0275pipe"](22,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](23,"\n\n        "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](24,"\n    "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](25,"\n\n"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](26,"\n")),2&e&&(d["\u0275\u0275advance"](7),d["\u0275\u0275textInterpolate"](d["\u0275\u0275pipeBind2"](8,6,t.headerMessage,d["\u0275\u0275pureFunction1"](15,Q,t.item.handle))),d["\u0275\u0275advance"](4),d["\u0275\u0275textInterpolate"](d["\u0275\u0275pipeBind1"](12,9,t.descriptionMessage)),d["\u0275\u0275advance"](3),d["\u0275\u0275property"]("item",t.item),d["\u0275\u0275advance"](3),d["\u0275\u0275textInterpolate1"]("",d["\u0275\u0275pipeBind1"](18,11,t.confirmMessage),"\n            "),d["\u0275\u0275advance"](3),d["\u0275\u0275property"]("routerLink",d["\u0275\u0275pureFunction1"](17,W,t.itemPageRoute)),d["\u0275\u0275advance"](1),d["\u0275\u0275textInterpolate1"]("\n                ",d["\u0275\u0275pipeBind1"](22,13,t.cancelMessage),"\n            "))},directives:[L.a,v.i],pipes:[S.d],encapsulation:2}),R),H=function(e){return{id:e}},G=function(e){return[e,"edit"]},Y=((P=function(e){l(n,e);var t=p(n);function n(e,i,a,r,c){var s;return o(this,n),(s=t.call(this,e,i,a,r,c)).route=e,s.router=i,s.notificationsService=a,s.itemDataService=r,s.translateService=c,s.messageKey="private",s.predicate=function(e){return!e.payload.isDiscoverable},s}return s(n,[{key:"performAction",value:function(){var e=this;this.itemDataService.setDiscoverable(this.item,!1).pipe(Object($.g)()).subscribe((function(t){e.processRestResponse(t)}))}}]),n}(N)).\u0275fac=function(e){return new(e||P)(d["\u0275\u0275directiveInject"](v.a),d["\u0275\u0275directiveInject"](v.h),d["\u0275\u0275directiveInject"](U.a),d["\u0275\u0275directiveInject"](z.a),d["\u0275\u0275directiveInject"](S.e))},P.\u0275cmp=d["\u0275\u0275defineComponent"]({type:P,selectors:[["ds-item-private"]],features:[d["\u0275\u0275InheritDefinitionFeature"]],decls:27,vars:19,consts:[[1,"container"],[1,"row"],[1,"col-12"],[3,"item"],[1,"btn","btn-outline-secondary","perform-action",3,"click"],[1,"btn","btn-outline-secondary","cancel",3,"routerLink"]],template:function(e,t){1&e&&(d["\u0275\u0275elementStart"](0,"div",0),d["\u0275\u0275text"](1,"\n    "),d["\u0275\u0275elementStart"](2,"div",1),d["\u0275\u0275text"](3,"\n        "),d["\u0275\u0275elementStart"](4,"div",2),d["\u0275\u0275text"](5,"\n            "),d["\u0275\u0275elementStart"](6,"h2"),d["\u0275\u0275text"](7),d["\u0275\u0275pipe"](8,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](9,"\n            "),d["\u0275\u0275elementStart"](10,"p"),d["\u0275\u0275text"](11),d["\u0275\u0275pipe"](12,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](13,"\n            "),d["\u0275\u0275element"](14,"ds-modify-item-overview",3),d["\u0275\u0275text"](15,"\n            "),d["\u0275\u0275elementStart"](16,"button",4),d["\u0275\u0275listener"]("click",(function(){return t.performAction()})),d["\u0275\u0275text"](17),d["\u0275\u0275pipe"](18,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](19,"\n            "),d["\u0275\u0275elementStart"](20,"button",5),d["\u0275\u0275text"](21),d["\u0275\u0275pipe"](22,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](23,"\n\n        "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](24,"\n    "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](25,"\n\n"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](26,"\n")),2&e&&(d["\u0275\u0275advance"](7),d["\u0275\u0275textInterpolate"](d["\u0275\u0275pipeBind2"](8,6,t.headerMessage,d["\u0275\u0275pureFunction1"](15,H,t.item.handle))),d["\u0275\u0275advance"](4),d["\u0275\u0275textInterpolate"](d["\u0275\u0275pipeBind1"](12,9,t.descriptionMessage)),d["\u0275\u0275advance"](3),d["\u0275\u0275property"]("item",t.item),d["\u0275\u0275advance"](3),d["\u0275\u0275textInterpolate1"]("",d["\u0275\u0275pipeBind1"](18,11,t.confirmMessage),"\n            "),d["\u0275\u0275advance"](3),d["\u0275\u0275property"]("routerLink",d["\u0275\u0275pureFunction1"](17,G,t.itemPageRoute)),d["\u0275\u0275advance"](1),d["\u0275\u0275textInterpolate1"]("\n                ",d["\u0275\u0275pipeBind1"](22,13,t.cancelMessage),"\n            "))},directives:[L.a,v.i],pipes:[S.d],encapsulation:2}),P),Z=function(e){return{id:e}},ee=function(e){return[e,"edit"]},te=((T=function(e){l(n,e);var t=p(n);function n(e,i,a,r,c){var s;return o(this,n),(s=t.call(this,e,i,a,r,c)).route=e,s.router=i,s.notificationsService=a,s.itemDataService=r,s.translateService=c,s.messageKey="public",s.predicate=function(e){return e.payload.isDiscoverable},s}return s(n,[{key:"performAction",value:function(){var e=this;this.itemDataService.setDiscoverable(this.item,!0).pipe(Object($.g)()).subscribe((function(t){e.processRestResponse(t)}))}}]),n}(N)).\u0275fac=function(e){return new(e||T)(d["\u0275\u0275directiveInject"](v.a),d["\u0275\u0275directiveInject"](v.h),d["\u0275\u0275directiveInject"](U.a),d["\u0275\u0275directiveInject"](z.a),d["\u0275\u0275directiveInject"](S.e))},T.\u0275cmp=d["\u0275\u0275defineComponent"]({type:T,selectors:[["ds-item-public"]],features:[d["\u0275\u0275InheritDefinitionFeature"]],decls:27,vars:19,consts:[[1,"container"],[1,"row"],[1,"col-12"],[3,"item"],[1,"btn","btn-outline-secondary","perform-action",3,"click"],[1,"btn","btn-outline-secondary","cancel",3,"routerLink"]],template:function(e,t){1&e&&(d["\u0275\u0275elementStart"](0,"div",0),d["\u0275\u0275text"](1,"\n    "),d["\u0275\u0275elementStart"](2,"div",1),d["\u0275\u0275text"](3,"\n        "),d["\u0275\u0275elementStart"](4,"div",2),d["\u0275\u0275text"](5,"\n            "),d["\u0275\u0275elementStart"](6,"h2"),d["\u0275\u0275text"](7),d["\u0275\u0275pipe"](8,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](9,"\n            "),d["\u0275\u0275elementStart"](10,"p"),d["\u0275\u0275text"](11),d["\u0275\u0275pipe"](12,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](13,"\n            "),d["\u0275\u0275element"](14,"ds-modify-item-overview",3),d["\u0275\u0275text"](15,"\n            "),d["\u0275\u0275elementStart"](16,"button",4),d["\u0275\u0275listener"]("click",(function(){return t.performAction()})),d["\u0275\u0275text"](17),d["\u0275\u0275pipe"](18,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](19,"\n            "),d["\u0275\u0275elementStart"](20,"button",5),d["\u0275\u0275text"](21),d["\u0275\u0275pipe"](22,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](23,"\n\n        "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](24,"\n    "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](25,"\n\n"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](26,"\n")),2&e&&(d["\u0275\u0275advance"](7),d["\u0275\u0275textInterpolate"](d["\u0275\u0275pipeBind2"](8,6,t.headerMessage,d["\u0275\u0275pureFunction1"](15,Z,t.item.handle))),d["\u0275\u0275advance"](4),d["\u0275\u0275textInterpolate"](d["\u0275\u0275pipeBind1"](12,9,t.descriptionMessage)),d["\u0275\u0275advance"](3),d["\u0275\u0275property"]("item",t.item),d["\u0275\u0275advance"](3),d["\u0275\u0275textInterpolate1"]("",d["\u0275\u0275pipeBind1"](18,11,t.confirmMessage),"\n            "),d["\u0275\u0275advance"](3),d["\u0275\u0275property"]("routerLink",d["\u0275\u0275pureFunction1"](17,ee,t.itemPageRoute)),d["\u0275\u0275advance"](1),d["\u0275\u0275textInterpolate1"]("\n                ",d["\u0275\u0275pipeBind1"](22,13,t.cancelMessage),"\n            "))},directives:[L.a,v.i],pipes:[S.d],encapsulation:2}),T),ne=c("eIep"),ie=c("IzEk"),ae=c("xbPD"),re=c("pLZG"),oe=c("3jCq"),ce=c("84Zn"),se=c("7RJT"),le=c("loKC"),de=c("kN8A"),pe=c("bxbP"),ue=c("sfEo"),me=c("O/5o"),fe=c("1aCu");function be(e,t){if(1&e&&(d["\u0275\u0275elementStart"](0,"ds-listable-object-component-loader",23),d["\u0275\u0275text"](1,"\n                                        "),d["\u0275\u0275elementEnd"]()),2&e){var n=d["\u0275\u0275nextContext"]().ngVar,i=d["\u0275\u0275nextContext"](6);d["\u0275\u0275property"]("object",n)("viewMode",i.viewMode)}}function ve(e,t){if(1&e&&(d["\u0275\u0275elementStart"](0,"ds-listable-object-component-loader",23),d["\u0275\u0275text"](1,"\n                                                    "),d["\u0275\u0275elementEnd"]()),2&e){var n=d["\u0275\u0275nextContext"](2).ngVar,i=d["\u0275\u0275nextContext"](6);d["\u0275\u0275property"]("object",n)("viewMode",i.viewMode)}}function he(e,t){if(1&e&&(d["\u0275\u0275elementStart"](0,"div"),d["\u0275\u0275text"](1,"\n                                                        "),d["\u0275\u0275elementStart"](2,"div"),d["\u0275\u0275text"](3,"\n                                                            "),d["\u0275\u0275elementStart"](4,"div",29),d["\u0275\u0275text"](5),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](6,"\n                                                            "),d["\u0275\u0275elementStart"](7,"div"),d["\u0275\u0275text"](8),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](9,"\n                                                        "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](10,"\n                                                    "),d["\u0275\u0275elementEnd"]()),2&e){var n=t.$implicit;d["\u0275\u0275advance"](5),d["\u0275\u0275textInterpolate1"]("\n                                                                ",n.metadataField,"\n                                                            "),d["\u0275\u0275advance"](3),d["\u0275\u0275textInterpolate1"]("\n                                                                ",n.metadataValue.value,"\n                                                            ")}}function ge(e,t){if(1&e){var n=d["\u0275\u0275getCurrentView"]();d["\u0275\u0275text"](0,"\n                                            "),d["\u0275\u0275elementStart"](1,"div"),d["\u0275\u0275text"](2,"\n                                                "),d["\u0275\u0275elementStart"](3,"div",24),d["\u0275\u0275text"](4),d["\u0275\u0275pipe"](5,"translate"),d["\u0275\u0275elementStart"](6,"button",25),d["\u0275\u0275listener"]("click",(function(){return d["\u0275\u0275restoreView"](n),d["\u0275\u0275nextContext"](7).closeVirtualMetadataModal()})),d["\u0275\u0275text"](7,"\n                                                        "),d["\u0275\u0275elementStart"](8,"span",26),d["\u0275\u0275text"](9,"\xd7"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](10,"\n                                                    "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](11,"\n                                                "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](12,"\n                                                "),d["\u0275\u0275elementStart"](13,"div",27),d["\u0275\u0275text"](14,"\n                                                    "),d["\u0275\u0275template"](15,ve,2,2,"ds-listable-object-component-loader",17),d["\u0275\u0275text"](16,"\n                                                    "),d["\u0275\u0275template"](17,he,11,2,"div",28),d["\u0275\u0275pipe"](18,"async"),d["\u0275\u0275text"](19,"\n                                                "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](20,"\n                                            "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](21,"\n                                        ")}if(2&e){var i=d["\u0275\u0275nextContext"]().ngVar,a=d["\u0275\u0275nextContext"]().$implicit,r=d["\u0275\u0275nextContext"](5);d["\u0275\u0275advance"](4),d["\u0275\u0275textInterpolate1"]("\n                                                    ",d["\u0275\u0275pipeBind1"](5,3,"virtual-metadata.delete-item.modal-head"),"\n                                                    "),d["\u0275\u0275advance"](11),d["\u0275\u0275property"]("ngIf",i),d["\u0275\u0275advance"](2),d["\u0275\u0275property"]("ngForOf",d["\u0275\u0275pipeBind1"](18,5,r.getVirtualMetadata(a)))}}function xe(e,t){if(1&e){var n=d["\u0275\u0275getCurrentView"]();d["\u0275\u0275elementContainerStart"](0),d["\u0275\u0275text"](1,"\n\n                                        "),d["\u0275\u0275template"](2,be,2,2,"ds-listable-object-component-loader",17),d["\u0275\u0275text"](3,"\n                                        "),d["\u0275\u0275elementStart"](4,"div",18),d["\u0275\u0275text"](5,"\n                                            "),d["\u0275\u0275elementStart"](6,"div",19),d["\u0275\u0275text"](7,"\n                                                "),d["\u0275\u0275elementStart"](8,"button",20),d["\u0275\u0275listener"]("click",(function(){d["\u0275\u0275restoreView"](n);var e=d["\u0275\u0275reference"](16);return d["\u0275\u0275nextContext"](6).openVirtualMetadataModal(e)})),d["\u0275\u0275text"](9,"\n                                                    "),d["\u0275\u0275element"](10,"i",21),d["\u0275\u0275text"](11,"\n                                                "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](12,"\n                                            "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](13,"\n                                        "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](14,"\n\n                                        "),d["\u0275\u0275template"](15,ge,22,7,"ng-template",null,22,d["\u0275\u0275templateRefExtractor"]),d["\u0275\u0275text"](17,"\n\n                                    "),d["\u0275\u0275elementContainerEnd"]()}if(2&e){var i=t.ngVar;d["\u0275\u0275advance"](2),d["\u0275\u0275property"]("ngIf",i)}}function ye(e,t){if(1&e&&(d["\u0275\u0275elementStart"](0,"div",11),d["\u0275\u0275text"](1,"\n                                    "),d["\u0275\u0275template"](2,xe,18,1,"ng-container",4),d["\u0275\u0275pipe"](3,"async"),d["\u0275\u0275text"](4,"\n                                "),d["\u0275\u0275elementEnd"]()),2&e){var n=t.$implicit,i=d["\u0275\u0275nextContext"](5);d["\u0275\u0275advance"](2),d["\u0275\u0275property"]("ngVar",d["\u0275\u0275pipeBind1"](3,1,i.getRelatedItem(n)))}}function je(e,t){if(1&e){var n=d["\u0275\u0275getCurrentView"]();d["\u0275\u0275elementStart"](0,"div",11),d["\u0275\u0275text"](1,"\n\n                            "),d["\u0275\u0275elementStart"](2,"div",12),d["\u0275\u0275listener"]("click",(function(){d["\u0275\u0275restoreView"](n);var e=t.ngVar,i=d["\u0275\u0275nextContext"]().$implicit;return d["\u0275\u0275nextContext"](3).setSelected(i,!e)})),d["\u0275\u0275text"](3,"\n                                "),d["\u0275\u0275elementStart"](4,"label"),d["\u0275\u0275text"](5,"\n                                    "),d["\u0275\u0275element"](6,"input",13),d["\u0275\u0275text"](7,"\n                                "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](8,"\n                            "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](9,"\n\n                            "),d["\u0275\u0275elementStart"](10,"div",14),d["\u0275\u0275text"](11,"\n                                "),d["\u0275\u0275elementStart"](12,"h5",15),d["\u0275\u0275listener"]("click",(function(){d["\u0275\u0275restoreView"](n);var e=t.ngVar,i=d["\u0275\u0275nextContext"]().$implicit;return d["\u0275\u0275nextContext"](3).setSelected(i,!e)})),d["\u0275\u0275text"](13),d["\u0275\u0275pipe"](14,"translate"),d["\u0275\u0275pipe"](15,"async"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](16,"\n                                "),d["\u0275\u0275template"](17,ye,5,3,"div",16),d["\u0275\u0275pipe"](18,"async"),d["\u0275\u0275text"](19,"\n                            "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](20,"\n\n                        "),d["\u0275\u0275elementEnd"]()}if(2&e){var i=t.ngVar,a=d["\u0275\u0275nextContext"]().$implicit,r=d["\u0275\u0275nextContext"](3);d["\u0275\u0275advance"](6),d["\u0275\u0275property"]("checked",i),d["\u0275\u0275advance"](7),d["\u0275\u0275textInterpolate1"]("\n                                    ",d["\u0275\u0275pipeBind1"](14,3,r.getRelationshipMessageKey(d["\u0275\u0275pipeBind1"](15,5,r.getLabel(a)))),"\n                                "),d["\u0275\u0275advance"](4),d["\u0275\u0275property"]("ngForOf",d["\u0275\u0275pipeBind1"](18,7,r.getRelationships(a)))}}function Oe(e,t){if(1&e&&(d["\u0275\u0275elementStart"](0,"div",8),d["\u0275\u0275text"](1,"\n\n                        "),d["\u0275\u0275template"](2,je,21,9,"div",10),d["\u0275\u0275pipe"](3,"async"),d["\u0275\u0275text"](4,"\n\n                    "),d["\u0275\u0275elementEnd"]()),2&e){var n=t.$implicit,i=d["\u0275\u0275nextContext"](3);d["\u0275\u0275advance"](2),d["\u0275\u0275property"]("ngVar",d["\u0275\u0275pipeBind1"](3,1,i.isSelected(n)))}}function Se(e,t){if(1&e&&(d["\u0275\u0275elementStart"](0,"div",8),d["\u0275\u0275text"](1),d["\u0275\u0275pipe"](2,"translate"),d["\u0275\u0275template"](3,Oe,5,3,"div",9),d["\u0275\u0275text"](4,"\n\n                "),d["\u0275\u0275elementEnd"]()),2&e){var n=d["\u0275\u0275nextContext"]().ngVar;d["\u0275\u0275advance"](1),d["\u0275\u0275textInterpolate1"]("\n\n                    ",d["\u0275\u0275pipeBind1"](2,2,"virtual-metadata.delete-item.info"),"\n\n                    "),d["\u0275\u0275advance"](2),d["\u0275\u0275property"]("ngForOf",n)}}function Ie(e,t){if(1&e&&(d["\u0275\u0275elementContainerStart"](0),d["\u0275\u0275text"](1,"\n\n                "),d["\u0275\u0275template"](2,Se,5,4,"div",7),d["\u0275\u0275text"](3,"\n\n            "),d["\u0275\u0275elementContainerEnd"]()),2&e){var n=t.ngVar;d["\u0275\u0275advance"](2),d["\u0275\u0275property"]("ngIf",n&&n.length>0)}}var Ce,we=function(e){return{id:e}},ke=function(e){return[e,"edit"]},Ee=((Ce=function(n){l(r,n);var i=p(r);function r(e,t,n,a,c,s,l,d,p,u){var m;return o(this,r),(m=i.call(this,e,t,n,a,c)).route=e,m.router=t,m.notificationsService=n,m.itemDataService=a,m.translateService=c,m.modalService=s,m.objectUpdatesService=l,m.relationshipService=d,m.entityTypeService=p,m.linkService=u,m.messageKey="delete",m.viewMode=oe.a.ListElement,m.types$=new se.BehaviorSubject([]),m.relationships$=new Map,m.relatedItems$=new Map,m.virtualMetadata$=new Map,m.subs=[],m}return s(r,[{key:"ngOnInit",value:function(){var e=this;a(m(r.prototype),"ngOnInit",this).call(this),this.url=this.router.url;var n=this.item.firstMetadataValue("dspace.entity.type");Object(j.e)(n)&&this.subs.push(this.entityTypeService.getEntityTypeByLabel(n).pipe(Object($.i)(),Object($.o)(),Object(ne.a)((function(t){return e.entityTypeService.getEntityTypeRelationships(t.id)})),Object($.i)(),Object($.o)(),Object(y.a)((function(e){return e.page})),Object(ne.a)((function(n){return 0===n.length?Object(g.a)(n):Object(x.a)(n.map((function(t){return e.getRelationships(t)}))).pipe(Object(y.a)((function(e){return n.reduce((function(n,i,a){return n.some((function(e){return e.id===i.id}))||0===e[a].length?n:[].concat(t(n),[i])}),[])})))}))).subscribe((function(t){return e.types$.next(t)}))),this.subs.push(this.types$.pipe(Object(ie.a)(1)).subscribe((function(t){return e.objectUpdatesService.initialize(e.url,t,e.item.lastModified)})))}},{key:"openVirtualMetadataModal",value:function(e){this.modalRef=this.modalService.open(e)}},{key:"closeVirtualMetadataModal",value:function(){this.modalRef.close()}},{key:"getRelationshipMessageKey",value:function(e){return Object(j.b)(e)&&e.indexOf("Of")>-1?"relationships.".concat(e.substring(0,e.indexOf("Of")+2)):e}},{key:"getLabel",value:function(e){var t=this;return this.getRelationships(e).pipe(Object(ne.a)((function(n){return t.isLeftItem(n[0]).pipe(Object(y.a)((function(t){return t?e.leftwardType:e.rightwardType})))})))}},{key:"getRelationships",value:function(e){var t=this;return this.relationships$.has(e)||this.relationships$.set(e,this.relationshipService.getItemRelationshipsArray(this.item).pipe(Object(ne.a)((function(n){return Object(x.a)(n.map((function(e){return t.getRelationshipType(e)}))).pipe(Object(ae.a)([]),Object(y.a)((function(t){return n.filter((function(n,i){return e.id===t[i].id}))})))})))),this.relationships$.get(e)}},{key:"getRelationshipType",value:function(e){return this.linkService.resolveLinks(e,Object(ce.a)("relationshipType"),Object(ce.a)("leftItem"),Object(ce.a)("rightItem")),e.relationshipType.pipe(Object($.i)(),Object($.o)(),Object(re.a)((function(e){return Object(j.b)(e)&&Object(j.e)(e.uuid)})))}},{key:"getRelatedItem",value:function(e){return this.relatedItems$.has(e)||this.relatedItems$.set(e,this.isLeftItem(e).pipe(Object(ne.a)((function(t){return t?e.rightItem:e.leftItem})),Object($.i)(),Object($.o)())),this.relatedItems$.get(e)}},{key:"getVirtualMetadata",value:function(t){return this.virtualMetadata$.has(t)||this.virtualMetadata$.set(t,this.getRelatedItem(t).pipe(Object(y.a)((function(n){return Object.entries(n.metadata).map((function(n){var i=e(n,2),a=i[0];return i[1].filter((function(e){return e.authority&&e.authority.endsWith(t.id)})).map((function(e){return{metadataField:a,metadataValue:e}}))})).reduce((function(e,t){return e.concat(t)}))})))),this.virtualMetadata$.get(t)}},{key:"isLeftItem",value:function(e){var t=this;return e.leftItem.pipe(Object($.i)(),Object($.o)(),Object(re.a)((function(e){return Object(j.b)(e)&&Object(j.e)(e.uuid)})),Object(y.a)((function(e){return e.uuid===t.item.uuid})))}},{key:"isSelected",value:function(e){return this.objectUpdatesService.isSelectedVirtualMetadata(this.url,this.item.uuid,e.uuid)}},{key:"setSelected",value:function(e,t){this.objectUpdatesService.setSelectedVirtualMetadata(this.url,this.item.uuid,e.uuid,t)}},{key:"performAction",value:function(){var e=this;this.subs.push(this.types$.pipe(Object(ne.a)((function(t){return Object(x.a)(t.map((function(t){return e.isSelected(t)}))).pipe(Object(ae.a)([]),Object(y.a)((function(e){return t.filter((function(t,n){return e[n]}))})),Object(y.a)((function(e){return e.map((function(e){return e.id}))})))})),Object(ne.a)((function(t){return e.itemDataService.delete(e.item.id,t).pipe(Object($.g)())}))).subscribe((function(t){e.notify(t.hasSucceeded)})))}},{key:"notify",value:function(e){e?(this.notificationsService.success(this.translateService.get("item.edit."+this.messageKey+".success")),this.router.navigate([""])):(this.notificationsService.error(this.translateService.get("item.edit."+this.messageKey+".error")),this.router.navigate([Object(O.e)(this.item)]))}},{key:"ngOnDestroy",value:function(){this.subs.filter((function(e){return Object(j.b)(e)})).forEach((function(e){return e.unsubscribe()}))}}]),r}(N)).\u0275fac=function(e){return new(e||Ce)(d["\u0275\u0275directiveInject"](v.a),d["\u0275\u0275directiveInject"](v.h),d["\u0275\u0275directiveInject"](U.a),d["\u0275\u0275directiveInject"](z.a),d["\u0275\u0275directiveInject"](S.e),d["\u0275\u0275directiveInject"](f.q),d["\u0275\u0275directiveInject"](le.a),d["\u0275\u0275directiveInject"](de.a),d["\u0275\u0275directiveInject"](pe.a),d["\u0275\u0275directiveInject"](ue.a))},Ce.\u0275cmp=d["\u0275\u0275defineComponent"]({type:Ce,selectors:[["ds-item-delete"]],inputs:{url:"url"},features:[d["\u0275\u0275InheritDefinitionFeature"]],decls:30,vars:22,consts:[[1,"container"],[1,"row"],[1,"col-12"],[3,"item"],[4,"ngVar"],[1,"btn","btn-outline-secondary","perform-action",3,"click"],[1,"btn","btn-outline-secondary","cancel",3,"routerLink"],["class","mb-4",4,"ngIf"],[1,"mb-4"],["class","mb-4",4,"ngFor","ngForOf"],["class","d-flex flex-row",4,"ngVar"],[1,"d-flex","flex-row"],[1,"m-2",3,"click"],["type","checkbox",3,"checked"],[1,"flex-column","flex-grow-1"],[3,"click"],["class","d-flex flex-row",4,"ngFor","ngForOf"],[3,"object","viewMode",4,"ngIf"],[1,"ml-auto"],[1,"btn-group"],[1,"btn","btn-outline-info","btn-sm",3,"click"],[1,"fas","fa-info","fa-fw"],["virtualMetadataModal",""],[3,"object","viewMode"],[1,"modal-header"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[4,"ngFor","ngForOf"],[1,"font-weight-bold"]],template:function(e,t){1&e&&(d["\u0275\u0275elementStart"](0,"div",0),d["\u0275\u0275text"](1,"\n    "),d["\u0275\u0275elementStart"](2,"div",1),d["\u0275\u0275text"](3,"\n        "),d["\u0275\u0275elementStart"](4,"div",2),d["\u0275\u0275text"](5,"\n\n            "),d["\u0275\u0275elementStart"](6,"h2"),d["\u0275\u0275text"](7),d["\u0275\u0275pipe"](8,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](9,"\n            "),d["\u0275\u0275elementStart"](10,"p"),d["\u0275\u0275text"](11),d["\u0275\u0275pipe"](12,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](13,"\n            "),d["\u0275\u0275element"](14,"ds-modify-item-overview",3),d["\u0275\u0275text"](15,"\n\n            "),d["\u0275\u0275template"](16,Ie,4,1,"ng-container",4),d["\u0275\u0275pipe"](17,"async"),d["\u0275\u0275text"](18,"\n\n            "),d["\u0275\u0275elementStart"](19,"button",5),d["\u0275\u0275listener"]("click",(function(){return t.performAction()})),d["\u0275\u0275text"](20),d["\u0275\u0275pipe"](21,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](22,"\n            "),d["\u0275\u0275elementStart"](23,"button",6),d["\u0275\u0275text"](24),d["\u0275\u0275pipe"](25,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](26,"\n\n        "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](27,"\n    "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](28,"\n"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](29,"\n")),2&e&&(d["\u0275\u0275advance"](7),d["\u0275\u0275textInterpolate"](d["\u0275\u0275pipeBind2"](8,7,t.headerMessage,d["\u0275\u0275pureFunction1"](18,we,t.item.handle))),d["\u0275\u0275advance"](4),d["\u0275\u0275textInterpolate"](d["\u0275\u0275pipeBind1"](12,10,t.descriptionMessage)),d["\u0275\u0275advance"](3),d["\u0275\u0275property"]("item",t.item),d["\u0275\u0275advance"](2),d["\u0275\u0275property"]("ngVar",d["\u0275\u0275pipeBind1"](17,12,t.types$)),d["\u0275\u0275advance"](4),d["\u0275\u0275textInterpolate1"]("",d["\u0275\u0275pipeBind1"](21,14,t.confirmMessage),"\n            "),d["\u0275\u0275advance"](3),d["\u0275\u0275property"]("routerLink",d["\u0275\u0275pureFunction1"](20,ke,t.itemPageRoute)),d["\u0275\u0275advance"](1),d["\u0275\u0275textInterpolate1"]("\n                ",d["\u0275\u0275pipeBind1"](25,16,t.cancelMessage),"\n            "))},directives:[L.a,me.a,v.i,u.p,u.o,fe.a],pipes:[S.d,u.b],encapsulation:2}),Ce),Me=function(){function e(t,n,i){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];o(this,e),this.operationKey=t,this.operationUrl=n,this.featureID=i,this.authorized=r,this.setDisabled(a)}return s(e,[{key:"setDisabled",value:function(e){this.disabled=e}}]),e}(),Be=c("5+tZ"),Ve=c("/uUt"),Re=c("IAdc"),Pe=c("2Vo4"),Te=c("Cfvw"),Fe=c("FU+A"),$e=c("1mcE");function De(e,t){if(1&e&&(d["\u0275\u0275elementStart"](0,"span"),d["\u0275\u0275text"](1,"\n    "),d["\u0275\u0275elementStart"](2,"button",5),d["\u0275\u0275text"](3),d["\u0275\u0275pipe"](4,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](5,"\n  "),d["\u0275\u0275elementEnd"]()),2&e){var n=d["\u0275\u0275nextContext"]();d["\u0275\u0275advance"](2),d["\u0275\u0275property"]("disabled",n.operation.disabled)("routerLink",n.operation.operationUrl),d["\u0275\u0275advance"](1),d["\u0275\u0275textInterpolate1"]("\n      ",d["\u0275\u0275pipeBind1"](4,3,"item.edit.tabs.status.buttons."+n.operation.operationKey+".button"),"\n    ")}}function Ue(e,t){if(1&e&&(d["\u0275\u0275elementStart"](0,"span",6),d["\u0275\u0275pipe"](1,"translate"),d["\u0275\u0275text"](2,"\n    "),d["\u0275\u0275elementStart"](3,"button",7),d["\u0275\u0275text"](4),d["\u0275\u0275pipe"](5,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](6,"\n  "),d["\u0275\u0275elementEnd"]()),2&e){var n=d["\u0275\u0275nextContext"]();d["\u0275\u0275property"]("ngbTooltip",d["\u0275\u0275pipeBind1"](1,3,"item.edit.tabs.status.buttons.unauthorized")),d["\u0275\u0275advance"](3),d["\u0275\u0275property"]("disabled",!0),d["\u0275\u0275advance"](1),d["\u0275\u0275textInterpolate1"]("\n      ",d["\u0275\u0275pipeBind1"](5,5,"item.edit.tabs.status.buttons."+n.operation.operationKey+".button"),"\n    ")}}var ze,Le=((ze=function e(){o(this,e)}).\u0275fac=function(e){return new(e||ze)},ze.\u0275cmp=d["\u0275\u0275defineComponent"]({type:ze,selectors:[["ds-item-operation"]],inputs:{operation:"operation"},decls:14,vars:5,consts:[[1,"col-3","float-left","d-flex","h-100","action-label"],[1,"justify-content-center","align-self-center"],[1,"col-9","float-left","action-button"],[4,"ngIf"],[3,"ngbTooltip",4,"ngIf"],[1,"btn","btn-outline-primary",3,"disabled","routerLink"],[3,"ngbTooltip"],[1,"btn","btn-outline-primary",3,"disabled"]],template:function(e,t){1&e&&(d["\u0275\u0275elementStart"](0,"div",0),d["\u0275\u0275text"](1,"\n      "),d["\u0275\u0275elementStart"](2,"span",1),d["\u0275\u0275text"](3),d["\u0275\u0275pipe"](4,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](5,"\n"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](6,"\n"),d["\u0275\u0275elementStart"](7,"div",2),d["\u0275\u0275text"](8,"\n  "),d["\u0275\u0275template"](9,De,6,5,"span",3),d["\u0275\u0275text"](10,"\n  "),d["\u0275\u0275template"](11,Ue,7,7,"span",4),d["\u0275\u0275text"](12,"\n"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](13,"\n")),2&e&&(d["\u0275\u0275advance"](3),d["\u0275\u0275textInterpolate1"]("\n        ",d["\u0275\u0275pipeBind1"](4,3,"item.edit.tabs.status.buttons."+t.operation.operationKey+".label"),"\n      "),d["\u0275\u0275advance"](6),d["\u0275\u0275property"]("ngIf",t.operation.authorized),d["\u0275\u0275advance"](2),d["\u0275\u0275property"]("ngIf",!t.operation.authorized))},directives:[u.p,v.i,f.O],pipes:[S.d],encapsulation:2}),ze);function _e(e,t){if(1&e&&(d["\u0275\u0275elementStart"](0,"div",7),d["\u0275\u0275text"](1,"\n    "),d["\u0275\u0275elementStart"](2,"div",3),d["\u0275\u0275text"](3),d["\u0275\u0275pipe"](4,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](5,"\n    "),d["\u0275\u0275elementStart"](6,"div",8),d["\u0275\u0275text"](7),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](8,"\n  "),d["\u0275\u0275elementEnd"]()),2&e){var n=t.$implicit,i=d["\u0275\u0275nextContext"]();d["\u0275\u0275advance"](3),d["\u0275\u0275textInterpolate1"]("\n      ",d["\u0275\u0275pipeBind1"](4,3,"item.edit.tabs.status.labels."+n),":\n    "),d["\u0275\u0275advance"](3),d["\u0275\u0275propertyInterpolate1"]("id","status-",n,""),d["\u0275\u0275advance"](1),d["\u0275\u0275textInterpolate1"]("\n      ",i.statusData[n],"\n    ")}}function Ae(e,t){if(1&e&&d["\u0275\u0275element"](0,"ds-item-operation",11),2&e){var n=d["\u0275\u0275nextContext"]().$implicit;d["\u0275\u0275property"]("operation",n)}}var Ne=function(e){return{"pt-3":e}};function qe(e,t){if(1&e&&(d["\u0275\u0275elementStart"](0,"div",9),d["\u0275\u0275text"](1,"\n    "),d["\u0275\u0275template"](2,Ae,1,1,"ds-item-operation",10),d["\u0275\u0275text"](3,"\n  "),d["\u0275\u0275elementEnd"]()),2&e){var n=t.$implicit;d["\u0275\u0275property"]("ngClass",d["\u0275\u0275pureFunction1"](2,Ne,n)),d["\u0275\u0275advance"](2),d["\u0275\u0275property"]("ngIf",n)}}var Ke,Xe=((Ke=function(){function e(t,n){o(this,e),this.route=t,this.authorizationService=n,this.operations$=new Pe.a([])}return s(e,[{key:"ngOnInit",value:function(){var e=this;this.itemRD$=this.route.parent.data.pipe(Object(y.a)((function(e){return e.dso}))),this.itemRD$.pipe(Object(D.a)(),Object(y.a)((function(e){return e.payload}))).subscribe((function(t){e.statusData=Object.assign({id:t.id,handle:t.handle,lastModified:t.lastModified}),e.statusDataKeys=Object.keys(e.statusData);var n=[];n.push(new Me("authorizations",e.getCurrentUrl(t)+"/authorizations",Fe.a.CanManagePolicies,!0)),n.push(new Me("mappedCollections",e.getCurrentUrl(t)+"/mapper",Fe.a.CanManageMappings,!0)),n.push(t.isWithdrawn?new Me("reinstate",e.getCurrentUrl(t)+"/reinstate",Fe.a.ReinstateItem,!0):new Me("withdraw",e.getCurrentUrl(t)+"/withdraw",Fe.a.WithdrawItem,!0)),n.push(t.isDiscoverable?new Me("private",e.getCurrentUrl(t)+"/private",Fe.a.CanMakePrivate,!0):new Me("public",e.getCurrentUrl(t)+"/public",Fe.a.CanMakePrivate,!0)),n.push(new Me("delete",e.getCurrentUrl(t)+"/delete",Fe.a.CanDelete,!0)),n.push(new Me("move",e.getCurrentUrl(t)+"/move",Fe.a.CanMove,!0)),e.operations$.next(n),Object(Te.a)(n).pipe(Object(Be.a)((function(n){return Object(j.b)(n.featureID)?e.authorizationService.isAuthorized(n.featureID,t.self).pipe(Object(Ve.a)(),Object(y.a)((function(e){return new Me(n.operationKey,n.operationUrl,n.featureID,!e,e)}))):[n]})),Object(Re.a)()).subscribe((function(t){return e.operations$.next(t)}))})),this.itemPageRoute$=this.itemRD$.pipe(Object($.d)(),Object(y.a)((function(e){return Object(O.h)(e)})))}},{key:"getCurrentUrl",value:function(e){return Object(O.e)(e)}},{key:"trackOperation",value:function(e,t){return Object(j.b)(t)?t.operationKey:void 0}}]),e}()).\u0275fac=function(e){return new(e||Ke)(d["\u0275\u0275directiveInject"](v.a),d["\u0275\u0275directiveInject"]($e.a))},Ke.\u0275cmp=d["\u0275\u0275defineComponent"]({type:Ke,selectors:[["ds-item-status"]],decls:24,vars:16,consts:[[1,"mt-2"],[1,"row"],["class","w-100",4,"ngFor","ngForOf"],[1,"col-3","float-left","status-label"],["id","status-itemPage",1,"col-9","float-left","status-data"],[3,"routerLink"],["class","w-100",3,"ngClass",4,"ngFor","ngForOf"],[1,"w-100"],[1,"col-9","float-left","status-data",3,"id"],[1,"w-100",3,"ngClass"],[3,"operation",4,"ngIf"],[3,"operation"]],template:function(e,t){1&e&&(d["\u0275\u0275elementStart"](0,"p",0),d["\u0275\u0275text"](1),d["\u0275\u0275pipe"](2,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](3,"\n"),d["\u0275\u0275elementStart"](4,"div",1),d["\u0275\u0275text"](5,"\n  "),d["\u0275\u0275template"](6,_e,9,5,"div",2),d["\u0275\u0275text"](7,"\n  "),d["\u0275\u0275elementStart"](8,"div",3),d["\u0275\u0275text"](9),d["\u0275\u0275pipe"](10,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](11,"\n  "),d["\u0275\u0275elementStart"](12,"div",4),d["\u0275\u0275text"](13,"\n    "),d["\u0275\u0275elementStart"](14,"a",5),d["\u0275\u0275pipe"](15,"async"),d["\u0275\u0275text"](16),d["\u0275\u0275pipe"](17,"async"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](18,"\n  "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](19,"\n\n  "),d["\u0275\u0275template"](20,qe,4,4,"div",6),d["\u0275\u0275pipe"](21,"async"),d["\u0275\u0275text"](22,"\n"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](23,"\n")),2&e&&(d["\u0275\u0275advance"](1),d["\u0275\u0275textInterpolate"](d["\u0275\u0275pipeBind1"](2,6,"item.edit.tabs.status.description")),d["\u0275\u0275advance"](5),d["\u0275\u0275property"]("ngForOf",t.statusDataKeys),d["\u0275\u0275advance"](3),d["\u0275\u0275textInterpolate1"]("\n    ",d["\u0275\u0275pipeBind1"](10,8,"item.edit.tabs.status.labels.itemPage"),":\n  "),d["\u0275\u0275advance"](5),d["\u0275\u0275property"]("routerLink",d["\u0275\u0275pipeBind1"](15,10,t.itemPageRoute$)),d["\u0275\u0275advance"](2),d["\u0275\u0275textInterpolate"](d["\u0275\u0275pipeBind1"](17,12,t.itemPageRoute$)),d["\u0275\u0275advance"](4),d["\u0275\u0275property"]("ngForOf",d["\u0275\u0275pipeBind1"](21,14,t.operations$)))},directives:[u.o,v.k,u.m,u.p,Le],pipes:[S.d,u.b],encapsulation:2,data:{animation:[h.a,h.c]}}),Ke),Qe=c("4vdZ"),We=c("GsQf"),Je=c("1uah"),He=c("X8f1"),Ge=c("R7cy"),Ye=function(){function e(t,n,i,a,r){o(this,e),this.xs=t,this.sm=n,this.md=i,this.lg=a,this.xl=r}return s(e,[{key:"buildClasses",value:function(){return"col-".concat(this.xs," col-sm-").concat(this.sm," col-md-").concat(this.md," col-lg-").concat(this.lg," col-xl-").concat(this.xl)}}]),e}(),Ze=function(){function e(t){o(this,e),this.columns=t}return s(e,[{key:"combineColumns",value:function(e,t){if(e<t&&Object(j.b)(this.columns[e])&&Object(j.b)(this.columns[t])){for(var n=this.columns[e].xs,i=this.columns[e].sm,a=this.columns[e].md,r=this.columns[e].lg,o=this.columns[e].xl,c=e+1;c<t+1;c++)n+=this.columns[c].xs,i+=this.columns[c].sm,a+=this.columns[c].md,r+=this.columns[c].lg,o+=this.columns[c].xl;return new Ye(n,i,a,r,o)}}}]),e}(),et=c("PCBh"),tt=c("mycY"),nt=c("X/78"),it=c("yhw/"),at=["handleView"];function rt(e,t){1&e&&(d["\u0275\u0275text"](0,"\n  "),d["\u0275\u0275elementStart"](1,"div",1),d["\u0275\u0275text"](2,"\n    "),d["\u0275\u0275element"](3,"i",2),d["\u0275\u0275pipe"](4,"translate"),d["\u0275\u0275text"](5,"\n  "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](6,"\n")),2&e&&(d["\u0275\u0275advance"](3),d["\u0275\u0275property"]("title",d["\u0275\u0275pipeBind1"](4,1,"item.edit.bitstreams.edit.buttons.drag")))}var ot,ct,st=((ot=function(){function e(t){o(this,e),this.viewContainerRef=t}return s(e,[{key:"ngOnInit",value:function(){this.viewContainerRef.createEmbeddedView(this.handleView)}}]),e}()).\u0275fac=function(e){return new(e||ot)(d["\u0275\u0275directiveInject"](d.ViewContainerRef))},ot.\u0275cmp=d["\u0275\u0275defineComponent"]({type:ot,selectors:[["ds-item-edit-bitstream-drag-handle"]],viewQuery:function(e,t){var n;1&e&&d["\u0275\u0275viewQuery"](at,3),2&e&&d["\u0275\u0275queryRefresh"](n=d["\u0275\u0275loadQuery"]())&&(t.handleView=n.first)},decls:3,vars:0,consts:[["handleView",""],["tabindex","0",1,"drag-handle","text-muted","float-left","p-1","mr-2"],[1,"fas","fa-grip-vertical","fa-fw",3,"title"]],template:function(e,t){1&e&&(d["\u0275\u0275template"](0,rt,7,3,"ng-template",null,0,d["\u0275\u0275templateRefExtractor"]),d["\u0275\u0275text"](2,"\n"))},pipes:[S.d],styles:[".header-row[_ngcontent-%COMP%]{color:var(--bs-table-dark-color);background-color:var(--bs-table-dark-bg);border-color:var(--bs-table-dark-border-color)}.bundle-row[_ngcontent-%COMP%]{color:var(--bs-table-head-color);background-color:var(--bs-table-head-bg);border-color:var(--bs-table-border-color)}.row-element[_ngcontent-%COMP%]{padding:.75em;border-bottom:var(--bs-table-border-width) solid var(--bs-table-border-color)}.drag-handle[_ngcontent-%COMP%]{visibility:hidden}.bitstream-row-drag-handle[_ngcontent-%COMP%]:hover, .drag-handle[_ngcontent-%COMP%]:hover{cursor:move}[_nghost-%COMP%]     .bitstream-row-drag-handle:focus .drag-handle, [_nghost-%COMP%]     .bitstream-row:hover .drag-handle{visibility:visible!important}.cdk-drag-preview[_ngcontent-%COMP%]{margin-left:0;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12);box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12)}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%]{-webkit-transition:-webkit-transform .25s cubic-bezier(0,0,.2,1);transition:-webkit-transform .25s cubic-bezier(0,0,.2,1);transition:transform .25s cubic-bezier(0,0,.2,1);transition:transform .25s cubic-bezier(0,0,.2,1),-webkit-transform .25s cubic-bezier(0,0,.2,1)}.cdk-drop-list-dragging[_ngcontent-%COMP%]   .bitstream-row-drag-handle[_ngcontent-%COMP%], .cdk-drop-list-dragging[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%]{cursor:-webkit-grabbing;cursor:grabbing}"]}),ot),lt=c("7DXY"),dt=c("5+WD"),pt=c("Exvd"),ut=c("ysan"),mt=c("snSO"),ft=c("MFUF"),bt=((ct=function(){function e(t,n,i,a){o(this,e),this.objectUpdatesService=t,this.elRef=n,this.objectValuesPipe=i,this.paginationService=a,this.dropObject=new d.EventEmitter,this.pageSize=10,this.options=Object.assign(new lt.a,{id:"dad",currentPage:1,pageSize:this.pageSize}),this.currentPage$=new Pe.a(this.options),this.loading$=new Pe.a(!1),this.subs=[]}return s(e,[{key:"ngOnInit",value:function(){this.initializeObjectsRD(),this.initializeURL(),this.initializeUpdates(),this.initializePagination()}},{key:"initializePagination",value:function(){var e=this;this.paginationService.getCurrentPagination(this.options.id,this.options).subscribe((function(t){e.currentPage$.next(t)}))}},{key:"initializeUpdates",value:function(){var e=this;this.objectsRD$.pipe(Object($.i)(),Object($.s)()).subscribe((function(t){e.objectUpdatesService.initialize(e.url,t,new Date)})),this.updates$=this.objectsRD$.pipe(Object($.c)(),Object($.s)(),Object(ne.a)((function(t){return e.objectUpdatesService.getFieldUpdatesExclusive(e.url,t)}))),this.subs.push(this.updates$.pipe(Object(y.a)((function(t){return e.objectValuesPipe.transform(t)})),Object(Ve.a)(Object(ut.b)((function(e){return Object(j.b)(e)&&Object(j.b)(e.field)?e.field.uuid:void 0})))).subscribe((function(t){e.customOrder=t.map((function(e){return e.field.uuid})),e.loading$.next(!1)})),this.loading$.subscribe((function(t){return e.options.disabled=t})))}},{key:"drop",value:function(e){var t=this,n=e.previousIndex,i=e.currentIndex,a=this.currentPage$.value.currentPage-1,r=this.currentPage$.value.currentPage-1,o=this.elRef.nativeElement.querySelector(".page-item:hover");if(Object(j.b)(o)&&Object(j.b)(o.textContent)){var c=Number(o.textContent);Object(j.b)(c)&&!Number.isNaN(c)&&(r=c-1,i=0)}var s=a!==r;s||n===i||Object(dt.e)(this.customOrder,n,i);var l=r+1,d=a*this.pageSize+n,p=r*this.pageSize+i;d!==p&&(s&&this.loading$.next(!0),this.dropObject.emit(Object.assign({fromIndex:d,toIndex:p,finish:function(){s&&t.paginationComponent.doPageChange(l)}})))}},{key:"ngOnDestroy",value:function(){this.subs.filter((function(e){return Object(j.b)(e)})).forEach((function(e){return e.unsubscribe()})),this.paginationService.clearPagination(this.options.id)}}]),e}()).\u0275fac=function(e){return new(e||ct)(d["\u0275\u0275directiveInject"](le.a),d["\u0275\u0275directiveInject"](d.ElementRef),d["\u0275\u0275directiveInject"](mt.a),d["\u0275\u0275directiveInject"](ft.a))},ct.\u0275cmp=d["\u0275\u0275defineComponent"]({type:ct,selectors:[["ds-paginated-drag-drop-abstract"]],viewQuery:function(e,t){var n;1&e&&d["\u0275\u0275viewQuery"](pt.a,1),2&e&&d["\u0275\u0275queryRefresh"](n=d["\u0275\u0275loadQuery"]())&&(t.paginationComponent=n.first)},outputs:{dropObject:"dropObject"},decls:0,vars:0,template:function(e,t){},encapsulation:2}),ct),vt=c("LvDl"),ht=c("C765"),gt=["bitstreamView"],xt=function(e){return["/bitstreams/",e,"edit"]};function yt(e,t){if(1&e){var n=d["\u0275\u0275getCurrentView"]();d["\u0275\u0275text"](0,"\n  "),d["\u0275\u0275elementStart"](1,"div"),d["\u0275\u0275text"](2,"\n    "),d["\u0275\u0275projection"](3),d["\u0275\u0275text"](4,"\n    "),d["\u0275\u0275elementStart"](5,"div",1),d["\u0275\u0275text"](6,"\n      "),d["\u0275\u0275elementStart"](7,"span",2),d["\u0275\u0275text"](8),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](9,"\n    "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](10,"\n  "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](11,"\n  "),d["\u0275\u0275elementStart"](12,"div"),d["\u0275\u0275text"](13,"\n    "),d["\u0275\u0275elementStart"](14,"div",3),d["\u0275\u0275text"](15,"\n      "),d["\u0275\u0275elementStart"](16,"span",2),d["\u0275\u0275text"](17),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](18,"\n    "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](19,"\n  "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](20,"\n  "),d["\u0275\u0275elementStart"](21,"div"),d["\u0275\u0275text"](22,"\n    "),d["\u0275\u0275elementStart"](23,"div",4),d["\u0275\u0275text"](24,"\n        "),d["\u0275\u0275elementStart"](25,"span",2),d["\u0275\u0275text"](26),d["\u0275\u0275pipe"](27,"async"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](28,"\n    "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](29,"\n  "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](30,"\n  "),d["\u0275\u0275elementStart"](31,"div"),d["\u0275\u0275text"](32,"\n    "),d["\u0275\u0275elementStart"](33,"div",4),d["\u0275\u0275text"](34,"\n      "),d["\u0275\u0275elementStart"](35,"div",5),d["\u0275\u0275text"](36,"\n        "),d["\u0275\u0275elementStart"](37,"a",6),d["\u0275\u0275pipe"](38,"translate"),d["\u0275\u0275text"](39,"\n          "),d["\u0275\u0275element"](40,"i",7),d["\u0275\u0275text"](41,"\n        "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](42,"\n        "),d["\u0275\u0275elementStart"](43,"button",8),d["\u0275\u0275pipe"](44,"translate"),d["\u0275\u0275text"](45,"\n          "),d["\u0275\u0275element"](46,"i",9),d["\u0275\u0275text"](47,"\n        "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](48,"\n        "),d["\u0275\u0275elementStart"](49,"button",10),d["\u0275\u0275listener"]("click",(function(){return d["\u0275\u0275restoreView"](n),d["\u0275\u0275nextContext"]().remove()})),d["\u0275\u0275pipe"](50,"translate"),d["\u0275\u0275text"](51,"\n          "),d["\u0275\u0275element"](52,"i",11),d["\u0275\u0275text"](53,"\n        "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](54,"\n        "),d["\u0275\u0275elementStart"](55,"button",12),d["\u0275\u0275listener"]("click",(function(){return d["\u0275\u0275restoreView"](n),d["\u0275\u0275nextContext"]().undo()})),d["\u0275\u0275pipe"](56,"translate"),d["\u0275\u0275text"](57,"\n          "),d["\u0275\u0275element"](58,"i",13),d["\u0275\u0275text"](59,"\n        "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](60,"\n      "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](61,"\n    "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](62,"\n  "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](63,"\n")}if(2&e){var i,a=d["\u0275\u0275nextContext"]();d["\u0275\u0275advance"](1),d["\u0275\u0275classMapInterpolate1"]("",a.columnSizes.columns[0].buildClasses()," row-element d-flex"),d["\u0275\u0275advance"](7),d["\u0275\u0275textInterpolate1"]("\n        ",a.bitstreamName,"\n      "),d["\u0275\u0275advance"](4),d["\u0275\u0275classMapInterpolate1"]("",a.columnSizes.columns[1].buildClasses()," row-element d-flex align-items-center"),d["\u0275\u0275advance"](5),d["\u0275\u0275textInterpolate1"]("\n      ",null==a.bitstream?null:a.bitstream.firstMetadataValue("dc.description"),"\n      "),d["\u0275\u0275advance"](4),d["\u0275\u0275classMapInterpolate1"]("",a.columnSizes.columns[2].buildClasses()," row-element d-flex align-items-center"),d["\u0275\u0275advance"](5),d["\u0275\u0275textInterpolate1"]("\n            ",null==(i=d["\u0275\u0275pipeBind1"](27,23,a.format$))?null:i.shortDescription,"\n        "),d["\u0275\u0275advance"](5),d["\u0275\u0275classMapInterpolate1"]("",a.columnSizes.columns[3].buildClasses()," row-element d-flex align-items-center"),d["\u0275\u0275advance"](6),d["\u0275\u0275propertyInterpolate"]("title",d["\u0275\u0275pipeBind1"](38,25,"item.edit.bitstreams.edit.buttons.download")),d["\u0275\u0275property"]("href",null==a.bitstream||null==a.bitstream._links||null==a.bitstream._links.content?null:a.bitstream._links.content.href,d["\u0275\u0275sanitizeUrl"]),d["\u0275\u0275advance"](6),d["\u0275\u0275propertyInterpolate"]("title",d["\u0275\u0275pipeBind1"](44,27,"item.edit.bitstreams.edit.buttons.edit")),d["\u0275\u0275property"]("routerLink",d["\u0275\u0275pureFunction1"](33,xt,a.bitstream.id)),d["\u0275\u0275advance"](6),d["\u0275\u0275propertyInterpolate"]("title",d["\u0275\u0275pipeBind1"](50,29,"item.edit.bitstreams.edit.buttons.remove")),d["\u0275\u0275property"]("disabled",!a.canRemove()),d["\u0275\u0275advance"](6),d["\u0275\u0275propertyInterpolate"]("title",d["\u0275\u0275pipeBind1"](56,31,"item.edit.bitstreams.edit.buttons.undo")),d["\u0275\u0275property"]("disabled",!a.canUndo())}}var jt,Ot=[[["","slot","drag-handle"]]],St=["[slot=drag-handle]"],It=((jt=function(){function e(t,n,i){o(this,e),this.objectUpdatesService=t,this.dsoNameService=n,this.viewContainerRef=i}return s(e,[{key:"ngOnInit",value:function(){this.viewContainerRef.createEmbeddedView(this.bitstreamView)}},{key:"ngOnChanges",value:function(e){this.bitstream=Object(vt.cloneDeep)(this.fieldUpdate.field),this.bitstreamName=this.dsoNameService.getName(this.bitstream),this.format$=this.bitstream.format.pipe(Object($.i)(),Object($.o)())}},{key:"remove",value:function(){this.objectUpdatesService.saveRemoveFieldUpdate(this.bundleUrl,this.bitstream)}},{key:"undo",value:function(){this.objectUpdatesService.removeSingleFieldUpdate(this.bundleUrl,this.bitstream.uuid)}},{key:"canRemove",value:function(){return this.fieldUpdate.changeType!==He.c.REMOVE}},{key:"canUndo",value:function(){return this.fieldUpdate.changeType>=0}}]),e}()).\u0275fac=function(e){return new(e||jt)(d["\u0275\u0275directiveInject"](le.a),d["\u0275\u0275directiveInject"](ht.a),d["\u0275\u0275directiveInject"](d.ViewContainerRef))},jt.\u0275cmp=d["\u0275\u0275defineComponent"]({type:jt,selectors:[["ds-item-edit-bitstream"]],viewQuery:function(e,t){var n;1&e&&d["\u0275\u0275viewQuery"](gt,3),2&e&&d["\u0275\u0275queryRefresh"](n=d["\u0275\u0275loadQuery"]())&&(t.bitstreamView=n.first)},inputs:{fieldUpdate:"fieldUpdate",bundleUrl:"bundleUrl",columnSizes:"columnSizes"},features:[d["\u0275\u0275NgOnChangesFeature"]],ngContentSelectors:St,decls:3,vars:0,consts:[["bitstreamView",""],[1,"float-left","d-flex","align-items-center","overflow-hidden"],[1,"text-truncate"],[1,"w-100"],[1,"text-center","w-100"],[1,"btn-group","relationship-action-buttons"],[1,"btn","btn-outline-primary","btn-sm",3,"href","title"],[1,"fas","fa-download","fa-fw"],[1,"btn","btn-outline-primary","btn-sm",3,"routerLink","title"],[1,"fas","fa-edit","fa-fw"],[1,"btn","btn-outline-danger","btn-sm",3,"disabled","title","click"],[1,"fas","fa-trash-alt","fa-fw"],[1,"btn","btn-outline-warning","btn-sm",3,"disabled","title","click"],[1,"fas","fa-undo-alt","fa-fw"]],template:function(e,t){1&e&&(d["\u0275\u0275projectionDef"](Ot),d["\u0275\u0275template"](0,yt,64,35,"ng-template",null,0,d["\u0275\u0275templateRefExtractor"]),d["\u0275\u0275text"](2,"\n"))},directives:[v.i],pipes:[u.b,S.d],styles:[".header-row[_ngcontent-%COMP%]{color:var(--bs-table-dark-color);background-color:var(--bs-table-dark-bg);border-color:var(--bs-table-dark-border-color)}.bundle-row[_ngcontent-%COMP%]{color:var(--bs-table-head-color);background-color:var(--bs-table-head-bg);border-color:var(--bs-table-border-color)}.row-element[_ngcontent-%COMP%]{padding:.75em;border-bottom:var(--bs-table-border-width) solid var(--bs-table-border-color)}.drag-handle[_ngcontent-%COMP%]{visibility:hidden}.bitstream-row-drag-handle[_ngcontent-%COMP%]:hover, .drag-handle[_ngcontent-%COMP%]:hover{cursor:move}[_nghost-%COMP%]     .bitstream-row-drag-handle:focus .drag-handle, [_nghost-%COMP%]     .bitstream-row:hover .drag-handle{visibility:visible!important}.cdk-drag-preview[_ngcontent-%COMP%]{margin-left:0;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12);box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12)}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%]{-webkit-transition:-webkit-transform .25s cubic-bezier(0,0,.2,1);transition:-webkit-transform .25s cubic-bezier(0,0,.2,1);transition:transform .25s cubic-bezier(0,0,.2,1);transition:transform .25s cubic-bezier(0,0,.2,1),-webkit-transform .25s cubic-bezier(0,0,.2,1)}.cdk-drop-list-dragging[_ngcontent-%COMP%]   .bitstream-row-drag-handle[_ngcontent-%COMP%], .cdk-drop-list-dragging[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%]{cursor:-webkit-grabbing;cursor:grabbing}"]}),jt),Ct=c("Frqi"),wt=function(e,t,n,i){return{"table-warning":e,"table-danger":t,"table-success":n,"bg-white":i}};function kt(e,t){if(1&e&&(d["\u0275\u0275elementStart"](0,"div",7),d["\u0275\u0275text"](1,"\n          "),d["\u0275\u0275elementStart"](2,"ds-item-edit-bitstream",8),d["\u0275\u0275text"](3,"\n            "),d["\u0275\u0275elementStart"](4,"div",9),d["\u0275\u0275text"](5,"\n              "),d["\u0275\u0275element"](6,"ds-item-edit-bitstream-drag-handle"),d["\u0275\u0275text"](7,"\n            "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](8,"\n          "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](9,"\n        "),d["\u0275\u0275elementEnd"]()),2&e){var n=t.$implicit,i=d["\u0275\u0275nextContext"](2).ngVar,a=d["\u0275\u0275nextContext"](3);d["\u0275\u0275property"]("id",n)("ngClass",d["\u0275\u0275pureFunction4"](5,wt,0===i[n].changeType,2===i[n].changeType,1===i[n].changeType,void 0===i[n].changeType)),d["\u0275\u0275advance"](2),d["\u0275\u0275property"]("fieldUpdate",i[n])("bundleUrl",a.bundle.self)("columnSizes",a.columnSizes)}}function Et(e,t){if(1&e&&(d["\u0275\u0275elementContainerStart"](0),d["\u0275\u0275text"](1,"\n        "),d["\u0275\u0275template"](2,kt,10,10,"div",6),d["\u0275\u0275text"](3,"\n      "),d["\u0275\u0275elementContainerEnd"]()),2&e){var n=d["\u0275\u0275nextContext"](4);d["\u0275\u0275advance"](2),d["\u0275\u0275property"]("ngForOf",n.customOrder)}}var Mt=function(e){return{"mb-3":e}};function Bt(e,t){if(1&e){var n=d["\u0275\u0275getCurrentView"]();d["\u0275\u0275elementStart"](0,"div",5),d["\u0275\u0275listener"]("cdkDropListDropped",(function(e){return d["\u0275\u0275restoreView"](n),d["\u0275\u0275nextContext"](3).drop(e)})),d["\u0275\u0275pipe"](1,"async"),d["\u0275\u0275text"](2,"\n      "),d["\u0275\u0275template"](3,Et,4,1,"ng-container",2),d["\u0275\u0275text"](4,"\n    "),d["\u0275\u0275elementEnd"]()}if(2&e){var i,a=t.ngVar,r=d["\u0275\u0275nextContext"](3);d["\u0275\u0275property"]("id",r.bundle.id)("ngClass",d["\u0275\u0275pureFunction1"](5,Mt,(null==(i=d["\u0275\u0275pipeBind1"](1,3,r.objectsRD$))||null==i.payload?null:i.payload.totalElements)>r.pageSize)),d["\u0275\u0275advance"](3),d["\u0275\u0275property"]("ngIf",a)}}function Vt(e,t){if(1&e&&(d["\u0275\u0275elementContainerStart"](0),d["\u0275\u0275text"](1,"\n    "),d["\u0275\u0275template"](2,Bt,5,7,"div",4),d["\u0275\u0275pipe"](3,"async"),d["\u0275\u0275text"](4,"\n  "),d["\u0275\u0275elementContainerEnd"]()),2&e){var n=d["\u0275\u0275nextContext"](2);d["\u0275\u0275advance"](2),d["\u0275\u0275property"]("ngVar",d["\u0275\u0275pipeBind1"](3,1,n.updates$))}}function Rt(e,t){1&e&&(d["\u0275\u0275element"](0,"ds-loading",10),d["\u0275\u0275pipe"](1,"translate")),2&e&&d["\u0275\u0275property"]("message",d["\u0275\u0275pipeBind1"](1,1,"loading.bitstreams"))}function Pt(e,t){if(1&e&&(d["\u0275\u0275elementStart"](0,"ds-pagination",1),d["\u0275\u0275pipe"](1,"async"),d["\u0275\u0275pipe"](2,"async"),d["\u0275\u0275text"](3,"\n  "),d["\u0275\u0275template"](4,Vt,5,3,"ng-container",2),d["\u0275\u0275pipe"](5,"async"),d["\u0275\u0275text"](6,"\n  "),d["\u0275\u0275template"](7,Rt,2,3,"ds-loading",3),d["\u0275\u0275pipe"](8,"async"),d["\u0275\u0275text"](9,"\n"),d["\u0275\u0275elementEnd"]()),2&e){var n,i,a=d["\u0275\u0275nextContext"]();d["\u0275\u0275property"]("hideGear",!0)("hidePagerWhenSinglePage",!0)("hidePaginationDetail",!0)("paginationOptions",a.options)("pageInfoState",null==(n=d["\u0275\u0275pipeBind1"](1,8,a.objectsRD$))?null:n.payload)("collectionSize",null==(i=d["\u0275\u0275pipeBind1"](2,10,a.objectsRD$))||null==i.payload?null:i.payload.totalElements),d["\u0275\u0275advance"](4),d["\u0275\u0275property"]("ngIf",!d["\u0275\u0275pipeBind1"](5,12,a.loading$)),d["\u0275\u0275advance"](3),d["\u0275\u0275property"]("ngIf",d["\u0275\u0275pipeBind1"](8,14,a.loading$))}}var Tt,Ft=((Tt=function(e){l(n,e);var t=p(n);function n(e,i,a,r,c,s){var l;return o(this,n),(l=t.call(this,e,i,a,c)).objectUpdatesService=e,l.elRef=i,l.objectValuesPipe=a,l.bundleService=r,l.paginationService=c,l.requestService=s,l}return s(n,[{key:"ngOnInit",value:function(){a(m(n.prototype),"ngOnInit",this).call(this)}},{key:"initializeObjectsRD",value:function(){var e=this;this.objectsRD$=this.currentPage$.pipe(Object(ne.a)((function(t){var n=new Ge.a({pagination:Object.assign({},t)});return e.bundleService.getBitstreamsEndpoint(e.bundle.id,n).pipe(Object(ne.a)((function(t){return e.requestService.hasByHref$(t)})),Object(ne.a)((function(){return e.bundleService.getBitstreams(e.bundle.id,n,Object(ce.a)("format"))})))})))}},{key:"initializeURL",value:function(){this.url=this.bundle.self}}]),n}(bt)).\u0275fac=function(e){return new(e||Tt)(d["\u0275\u0275directiveInject"](le.a),d["\u0275\u0275directiveInject"](d.ElementRef),d["\u0275\u0275directiveInject"](mt.a),d["\u0275\u0275directiveInject"](it.a),d["\u0275\u0275directiveInject"](ft.a),d["\u0275\u0275directiveInject"](nt.a))},Tt.\u0275cmp=d["\u0275\u0275defineComponent"]({type:Tt,selectors:[["ds-paginated-drag-and-drop-bitstream-list"]],inputs:{bundle:"bundle",columnSizes:"columnSizes"},features:[d["\u0275\u0275InheritDefinitionFeature"]],decls:3,vars:3,consts:[[3,"hideGear","hidePagerWhenSinglePage","hidePaginationDetail","paginationOptions","pageInfoState","collectionSize",4,"ngIf"],[3,"hideGear","hidePagerWhenSinglePage","hidePaginationDetail","paginationOptions","pageInfoState","collectionSize"],[4,"ngIf"],[3,"message",4,"ngIf"],["class","bundle-bitstreams-list","cdkDropList","",3,"id","ngClass","cdkDropListDropped",4,"ngVar"],["cdkDropList","",1,"bundle-bitstreams-list",3,"id","ngClass","cdkDropListDropped"],["class","row bitstream-row","cdkDrag","",3,"id","ngClass",4,"ngFor","ngForOf"],["cdkDrag","",1,"row","bitstream-row",3,"id","ngClass"],[3,"fieldUpdate","bundleUrl","columnSizes"],["slot","drag-handle","cdkDragHandle","","tabindex","0",1,"d-flex","align-items-center","bitstream-row-drag-handle"],[3,"message"]],template:function(e,t){var n;(1&e&&(d["\u0275\u0275template"](0,Pt,10,16,"ds-pagination",0),d["\u0275\u0275pipe"](1,"async"),d["\u0275\u0275text"](2,"\n")),2&e)&&d["\u0275\u0275property"]("ngIf",null==(n=d["\u0275\u0275pipeBind1"](1,1,t.objectsRD$))?null:n.payload)},directives:[u.p,pt.a,me.a,dt.c,u.m,u.o,dt.a,It,dt.b,st,Ct.a],pipes:[u.b,S.d],styles:[".header-row[_ngcontent-%COMP%]{color:var(--bs-table-dark-color);background-color:var(--bs-table-dark-bg);border-color:var(--bs-table-dark-border-color)}.bundle-row[_ngcontent-%COMP%]{color:var(--bs-table-head-color);background-color:var(--bs-table-head-bg);border-color:var(--bs-table-border-color)}.row-element[_ngcontent-%COMP%]{padding:.75em;border-bottom:var(--bs-table-border-width) solid var(--bs-table-border-color)}.drag-handle[_ngcontent-%COMP%]{visibility:hidden}.bitstream-row-drag-handle[_ngcontent-%COMP%]:hover, .drag-handle[_ngcontent-%COMP%]:hover{cursor:move}[_nghost-%COMP%]     .bitstream-row-drag-handle:focus .drag-handle, [_nghost-%COMP%]     .bitstream-row:hover .drag-handle{visibility:visible!important}.cdk-drag-preview[_ngcontent-%COMP%]{margin-left:0;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12);box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12)}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%]{-webkit-transition:-webkit-transform .25s cubic-bezier(0,0,.2,1);transition:-webkit-transform .25s cubic-bezier(0,0,.2,1);transition:transform .25s cubic-bezier(0,0,.2,1);transition:transform .25s cubic-bezier(0,0,.2,1),-webkit-transform .25s cubic-bezier(0,0,.2,1)}.cdk-drop-list-dragging[_ngcontent-%COMP%]   .bitstream-row-drag-handle[_ngcontent-%COMP%], .cdk-drop-list-dragging[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%]{cursor:-webkit-grabbing;cursor:grabbing}"]}),Tt),$t=["bundleView"],Dt=function(e){return{name:e}},Ut=function(e){return[e,"bitstreams","new"]},zt=function(e){return{bundle:e}};function Lt(e,t){if(1&e){var n=d["\u0275\u0275getCurrentView"]();d["\u0275\u0275text"](0,"\n  "),d["\u0275\u0275elementStart"](1,"div",1),d["\u0275\u0275text"](2,"\n    "),d["\u0275\u0275elementStart"](3,"div"),d["\u0275\u0275text"](4,"\n      "),d["\u0275\u0275element"](5,"ds-item-edit-bitstream-drag-handle"),d["\u0275\u0275text"](6,"\n      "),d["\u0275\u0275elementStart"](7,"div",2),d["\u0275\u0275text"](8),d["\u0275\u0275pipe"](9,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](10,"\n    "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](11,"\n    "),d["\u0275\u0275elementStart"](12,"div"),d["\u0275\u0275text"](13,"\n      "),d["\u0275\u0275elementStart"](14,"div",3),d["\u0275\u0275text"](15,"\n        "),d["\u0275\u0275elementStart"](16,"button",4),d["\u0275\u0275pipe"](17,"translate"),d["\u0275\u0275text"](18,"\n          "),d["\u0275\u0275element"](19,"i",5),d["\u0275\u0275text"](20,"\n        "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](21,"\n      "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](22,"\n    "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](23,"\n  "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](24,"\n  "),d["\u0275\u0275elementStart"](25,"ds-paginated-drag-and-drop-bitstream-list",6),d["\u0275\u0275listener"]("dropObject",(function(e){return d["\u0275\u0275restoreView"](n),d["\u0275\u0275nextContext"]().dropObject.emit(e)})),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](26,"\n")}if(2&e){var i=d["\u0275\u0275nextContext"]();d["\u0275\u0275advance"](3),d["\u0275\u0275classMapInterpolate1"]("",i.bundleNameColumn.buildClasses()," font-weight-bold row-element d-flex"),d["\u0275\u0275advance"](5),d["\u0275\u0275textInterpolate1"]("\n        ",d["\u0275\u0275pipeBind2"](9,12,"item.edit.bitstreams.bundle.name",d["\u0275\u0275pureFunction1"](17,Dt,i.bundle.name)),"\n      "),d["\u0275\u0275advance"](4),d["\u0275\u0275classMapInterpolate1"]("",i.columnSizes.columns[3].buildClasses()," text-center row-element"),d["\u0275\u0275advance"](4),d["\u0275\u0275propertyInterpolate"]("title",d["\u0275\u0275pipeBind1"](17,15,"item.edit.bitstreams.bundle.edit.buttons.upload")),d["\u0275\u0275property"]("routerLink",d["\u0275\u0275pureFunction1"](19,Ut,i.itemPageRoute))("queryParams",d["\u0275\u0275pureFunction1"](21,zt,i.bundle.id)),d["\u0275\u0275advance"](9),d["\u0275\u0275property"]("bundle",i.bundle)("columnSizes",i.columnSizes)}}var _t,At=((_t=function(){function e(t){o(this,e),this.viewContainerRef=t,this.dropObject=new d.EventEmitter}return s(e,[{key:"ngOnInit",value:function(){this.bundleNameColumn=this.columnSizes.combineColumns(0,2),this.viewContainerRef.createEmbeddedView(this.bundleView),this.itemPageRoute=Object(O.h)(this.item)}}]),e}()).\u0275fac=function(e){return new(e||_t)(d["\u0275\u0275directiveInject"](d.ViewContainerRef))},_t.\u0275cmp=d["\u0275\u0275defineComponent"]({type:_t,selectors:[["ds-item-edit-bitstream-bundle"]],viewQuery:function(e,t){var n;1&e&&d["\u0275\u0275viewQuery"]($t,3),2&e&&d["\u0275\u0275queryRefresh"](n=d["\u0275\u0275loadQuery"]())&&(t.bundleView=n.first)},inputs:{bundle:"bundle",item:"item",columnSizes:"columnSizes"},outputs:{dropObject:"dropObject"},decls:3,vars:0,consts:[["bundleView",""],[1,"row","bundle-row"],[1,"float-left","d-flex","align-items-center"],[1,"btn-group","bundle-action-buttons"],[1,"btn","btn-outline-success","btn-sm",3,"routerLink","queryParams","title"],[1,"fas","fa-upload","fa-fw"],[3,"bundle","columnSizes","dropObject"]],template:function(e,t){1&e&&(d["\u0275\u0275template"](0,Lt,27,23,"ng-template",null,0,d["\u0275\u0275templateRefExtractor"]),d["\u0275\u0275text"](2,"\n"))},directives:[st,v.i,Ft],pipes:[S.d],styles:[".header-row[_ngcontent-%COMP%]{color:var(--bs-table-dark-color);background-color:var(--bs-table-dark-bg);border-color:var(--bs-table-dark-border-color)}.bundle-row[_ngcontent-%COMP%]{color:var(--bs-table-head-color);background-color:var(--bs-table-head-bg);border-color:var(--bs-table-border-color)}.row-element[_ngcontent-%COMP%]{padding:.75em;border-bottom:var(--bs-table-border-width) solid var(--bs-table-border-color)}.drag-handle[_ngcontent-%COMP%]{visibility:hidden}.bitstream-row-drag-handle[_ngcontent-%COMP%]:hover, .drag-handle[_ngcontent-%COMP%]:hover{cursor:move}[_nghost-%COMP%]     .bitstream-row-drag-handle:focus .drag-handle, [_nghost-%COMP%]     .bitstream-row:hover .drag-handle{visibility:visible!important}.cdk-drag-preview[_ngcontent-%COMP%]{margin-left:0;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12);box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12)}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%]{-webkit-transition:-webkit-transform .25s cubic-bezier(0,0,.2,1);transition:-webkit-transform .25s cubic-bezier(0,0,.2,1);transition:transform .25s cubic-bezier(0,0,.2,1);transition:transform .25s cubic-bezier(0,0,.2,1),-webkit-transform .25s cubic-bezier(0,0,.2,1)}.cdk-drop-list-dragging[_ngcontent-%COMP%]   .bitstream-row-drag-handle[_ngcontent-%COMP%], .cdk-drop-list-dragging[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%]{cursor:-webkit-grabbing;cursor:grabbing}"]}),_t);function Nt(e,t){if(1&e){var n=d["\u0275\u0275getCurrentView"]();d["\u0275\u0275elementStart"](0,"button",17),d["\u0275\u0275listener"]("click",(function(){return d["\u0275\u0275restoreView"](n),d["\u0275\u0275nextContext"](2).reinstate()})),d["\u0275\u0275element"](1,"i",18),d["\u0275\u0275text"](2,"\n      "),d["\u0275\u0275elementStart"](3,"span",5),d["\u0275\u0275text"](4),d["\u0275\u0275pipe"](5,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](6,"\n    "),d["\u0275\u0275elementEnd"]()}2&e&&(d["\u0275\u0275advance"](4),d["\u0275\u0275textInterpolate1"]("\xa0",d["\u0275\u0275pipeBind1"](5,1,"item.edit.bitstreams.reinstate-button"),""))}function qt(e,t){if(1&e){var n=d["\u0275\u0275getCurrentView"]();d["\u0275\u0275elementStart"](0,"button",19),d["\u0275\u0275listener"]("click",(function(){return d["\u0275\u0275restoreView"](n),d["\u0275\u0275nextContext"](2).discard()})),d["\u0275\u0275pipe"](1,"async"),d["\u0275\u0275element"](2,"i",20),d["\u0275\u0275text"](3,"\n      "),d["\u0275\u0275elementStart"](4,"span",5),d["\u0275\u0275text"](5),d["\u0275\u0275pipe"](6,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](7,"\n    "),d["\u0275\u0275elementEnd"]()}if(2&e){var i=d["\u0275\u0275nextContext"](2);d["\u0275\u0275property"]("disabled",!d["\u0275\u0275pipeBind1"](1,2,i.hasChanges())||i.submitting),d["\u0275\u0275advance"](5),d["\u0275\u0275textInterpolate1"]("\xa0",d["\u0275\u0275pipeBind1"](6,4,"item.edit.bitstreams.discard-button"),"")}}function Kt(e,t){if(1&e){var n=d["\u0275\u0275getCurrentView"]();d["\u0275\u0275elementStart"](0,"ds-item-edit-bitstream-bundle",24),d["\u0275\u0275listener"]("dropObject",(function(e){d["\u0275\u0275restoreView"](n);var i=t.$implicit;return d["\u0275\u0275nextContext"](3).dropBitstream(i,e)})),d["\u0275\u0275text"](1,"\n    "),d["\u0275\u0275elementEnd"]()}if(2&e){var i=t.$implicit,a=d["\u0275\u0275nextContext"](3);d["\u0275\u0275property"]("bundle",i)("item",a.item)("columnSizes",a.columnSizes)}}function Xt(e,t){if(1&e&&(d["\u0275\u0275elementStart"](0,"div",21),d["\u0275\u0275text"](1,"\n    "),d["\u0275\u0275elementStart"](2,"div",22),d["\u0275\u0275text"](3,"\n      "),d["\u0275\u0275elementStart"](4,"div"),d["\u0275\u0275text"](5,"\n        "),d["\u0275\u0275element"](6,"ds-item-edit-bitstream-drag-handle"),d["\u0275\u0275text"](7),d["\u0275\u0275pipe"](8,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](9,"\n      "),d["\u0275\u0275elementStart"](10,"div"),d["\u0275\u0275text"](11),d["\u0275\u0275pipe"](12,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](13,"\n      "),d["\u0275\u0275elementStart"](14,"div"),d["\u0275\u0275text"](15),d["\u0275\u0275pipe"](16,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](17,"\n      "),d["\u0275\u0275elementStart"](18,"div"),d["\u0275\u0275text"](19),d["\u0275\u0275pipe"](20,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](21,"\n    "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](22,"\n    "),d["\u0275\u0275template"](23,Kt,2,3,"ds-item-edit-bitstream-bundle",23),d["\u0275\u0275text"](24,"\n  "),d["\u0275\u0275elementEnd"]()),2&e){var n=d["\u0275\u0275nextContext"]().ngVar,i=d["\u0275\u0275nextContext"]();d["\u0275\u0275advance"](4),d["\u0275\u0275classMapInterpolate1"]("",i.columnSizes.columns[0].buildClasses()," row-element"),d["\u0275\u0275advance"](3),d["\u0275\u0275textInterpolate1"]("\n        ",d["\u0275\u0275pipeBind1"](8,17,"item.edit.bitstreams.headers.name"),"\n      "),d["\u0275\u0275advance"](3),d["\u0275\u0275classMapInterpolate1"]("",i.columnSizes.columns[1].buildClasses()," row-element"),d["\u0275\u0275advance"](1),d["\u0275\u0275textInterpolate"](d["\u0275\u0275pipeBind1"](12,19,"item.edit.bitstreams.headers.description")),d["\u0275\u0275advance"](3),d["\u0275\u0275classMapInterpolate1"]("",i.columnSizes.columns[2].buildClasses()," text-center row-element"),d["\u0275\u0275advance"](1),d["\u0275\u0275textInterpolate"](d["\u0275\u0275pipeBind1"](16,21,"item.edit.bitstreams.headers.format")),d["\u0275\u0275advance"](3),d["\u0275\u0275classMapInterpolate1"]("",i.columnSizes.columns[3].buildClasses()," text-center row-element"),d["\u0275\u0275advance"](1),d["\u0275\u0275textInterpolate"](d["\u0275\u0275pipeBind1"](20,23,"item.edit.bitstreams.headers.actions")),d["\u0275\u0275advance"](4),d["\u0275\u0275property"]("ngForOf",n)}}function Qt(e,t){1&e&&(d["\u0275\u0275elementStart"](0,"div",25),d["\u0275\u0275text"](1),d["\u0275\u0275pipe"](2,"translate"),d["\u0275\u0275elementEnd"]()),2&e&&(d["\u0275\u0275advance"](1),d["\u0275\u0275textInterpolate1"]("\n    ",d["\u0275\u0275pipeBind1"](2,1,"item.edit.bitstreams.empty"),"\n  "))}function Wt(e,t){1&e&&(d["\u0275\u0275element"](0,"ds-loading",26),d["\u0275\u0275pipe"](1,"translate")),2&e&&d["\u0275\u0275propertyInterpolate"]("message",d["\u0275\u0275pipeBind1"](1,1,"loading.bitstreams"))}function Jt(e,t){if(1&e){var n=d["\u0275\u0275getCurrentView"]();d["\u0275\u0275elementStart"](0,"button",27),d["\u0275\u0275listener"]("click",(function(){return d["\u0275\u0275restoreView"](n),d["\u0275\u0275nextContext"](2).reinstate()})),d["\u0275\u0275element"](1,"i",18),d["\u0275\u0275text"](2,"\n        "),d["\u0275\u0275elementStart"](3,"span",5),d["\u0275\u0275text"](4),d["\u0275\u0275pipe"](5,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](6,"\n      "),d["\u0275\u0275elementEnd"]()}2&e&&(d["\u0275\u0275advance"](4),d["\u0275\u0275textInterpolate1"]("\xa0",d["\u0275\u0275pipeBind1"](5,1,"item.edit.bitstreams.reinstate-button"),""))}function Ht(e,t){if(1&e){var n=d["\u0275\u0275getCurrentView"]();d["\u0275\u0275elementStart"](0,"button",19),d["\u0275\u0275listener"]("click",(function(){return d["\u0275\u0275restoreView"](n),d["\u0275\u0275nextContext"](2).discard()})),d["\u0275\u0275pipe"](1,"async"),d["\u0275\u0275element"](2,"i",20),d["\u0275\u0275text"](3,"\n        "),d["\u0275\u0275elementStart"](4,"span",5),d["\u0275\u0275text"](5),d["\u0275\u0275pipe"](6,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](7,"\n      "),d["\u0275\u0275elementEnd"]()}if(2&e){var i=d["\u0275\u0275nextContext"](2);d["\u0275\u0275property"]("disabled",!d["\u0275\u0275pipeBind1"](1,2,i.hasChanges())||i.submitting),d["\u0275\u0275advance"](5),d["\u0275\u0275textInterpolate1"]("\xa0",d["\u0275\u0275pipeBind1"](6,4,"item.edit.bitstreams.discard-button"),"")}}var Gt=function(e){return[e,"bitstreams","new"]};function Yt(e,t){if(1&e){var n=d["\u0275\u0275getCurrentView"]();d["\u0275\u0275elementStart"](0,"div",1),d["\u0275\u0275text"](1,"\n  "),d["\u0275\u0275elementStart"](2,"div",2),d["\u0275\u0275text"](3,"\n    "),d["\u0275\u0275elementStart"](4,"button",3),d["\u0275\u0275element"](5,"i",4),d["\u0275\u0275text"](6,"\n      "),d["\u0275\u0275elementStart"](7,"span",5),d["\u0275\u0275text"](8),d["\u0275\u0275pipe"](9,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](10,"\n    "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](11,"\n    "),d["\u0275\u0275template"](12,Nt,7,3,"button",6),d["\u0275\u0275pipe"](13,"async"),d["\u0275\u0275text"](14,"\n    "),d["\u0275\u0275elementStart"](15,"button",7),d["\u0275\u0275listener"]("click",(function(){return d["\u0275\u0275restoreView"](n),d["\u0275\u0275nextContext"]().submit()})),d["\u0275\u0275pipe"](16,"async"),d["\u0275\u0275element"](17,"i",8),d["\u0275\u0275text"](18,"\n      "),d["\u0275\u0275elementStart"](19,"span",5),d["\u0275\u0275text"](20),d["\u0275\u0275pipe"](21,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](22,"\n    "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](23,"\n    "),d["\u0275\u0275template"](24,qt,8,6,"button",9),d["\u0275\u0275pipe"](25,"async"),d["\u0275\u0275text"](26,"\n  "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](27,"\n\n  "),d["\u0275\u0275template"](28,Xt,25,25,"div",10),d["\u0275\u0275text"](29,"\n  "),d["\u0275\u0275template"](30,Qt,3,3,"div",11),d["\u0275\u0275text"](31,"\n  "),d["\u0275\u0275template"](32,Wt,2,3,"ds-loading",12),d["\u0275\u0275text"](33,"\n\n  "),d["\u0275\u0275elementStart"](34,"div",13),d["\u0275\u0275text"](35,"\n    "),d["\u0275\u0275elementStart"](36,"div",14),d["\u0275\u0275text"](37,"\n      "),d["\u0275\u0275template"](38,Jt,7,3,"button",15),d["\u0275\u0275pipe"](39,"async"),d["\u0275\u0275text"](40,"\n      "),d["\u0275\u0275elementStart"](41,"button",16),d["\u0275\u0275listener"]("click",(function(){return d["\u0275\u0275restoreView"](n),d["\u0275\u0275nextContext"]().submit()})),d["\u0275\u0275pipe"](42,"async"),d["\u0275\u0275element"](43,"i",8),d["\u0275\u0275text"](44,"\n        "),d["\u0275\u0275elementStart"](45,"span",5),d["\u0275\u0275text"](46),d["\u0275\u0275pipe"](47,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](48,"\n      "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](49,"\n      "),d["\u0275\u0275template"](50,Ht,8,6,"button",9),d["\u0275\u0275pipe"](51,"async"),d["\u0275\u0275text"](52,"\n    "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](53,"\n  "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](54,"\n"),d["\u0275\u0275elementEnd"]()}if(2&e){var i=t.ngVar,a=d["\u0275\u0275nextContext"]();d["\u0275\u0275advance"](4),d["\u0275\u0275property"]("routerLink",d["\u0275\u0275pureFunction1"](31,Gt,a.itemPageRoute)),d["\u0275\u0275advance"](4),d["\u0275\u0275textInterpolate1"]("\xa0",d["\u0275\u0275pipeBind1"](9,13,"item.edit.bitstreams.upload-button"),""),d["\u0275\u0275advance"](4),d["\u0275\u0275property"]("ngIf",d["\u0275\u0275pipeBind1"](13,15,a.isReinstatable())),d["\u0275\u0275advance"](3),d["\u0275\u0275property"]("disabled",!d["\u0275\u0275pipeBind1"](16,17,a.hasChanges())||a.submitting),d["\u0275\u0275advance"](5),d["\u0275\u0275textInterpolate1"]("\xa0",d["\u0275\u0275pipeBind1"](21,19,"item.edit.bitstreams.save-button"),""),d["\u0275\u0275advance"](4),d["\u0275\u0275property"]("ngIf",!d["\u0275\u0275pipeBind1"](25,21,a.isReinstatable())),d["\u0275\u0275advance"](4),d["\u0275\u0275property"]("ngIf",a.item&&(null==i?null:i.length)>0),d["\u0275\u0275advance"](2),d["\u0275\u0275property"]("ngIf",0===(null==i?null:i.length)),d["\u0275\u0275advance"](2),d["\u0275\u0275property"]("ngIf",!i),d["\u0275\u0275advance"](6),d["\u0275\u0275property"]("ngIf",d["\u0275\u0275pipeBind1"](39,23,a.isReinstatable())),d["\u0275\u0275advance"](3),d["\u0275\u0275property"]("disabled",!d["\u0275\u0275pipeBind1"](42,25,a.hasChanges())||a.submitting),d["\u0275\u0275advance"](5),d["\u0275\u0275textInterpolate1"]("\xa0",d["\u0275\u0275pipeBind1"](47,27,"item.edit.bitstreams.save-button"),""),d["\u0275\u0275advance"](4),d["\u0275\u0275property"]("ngIf",!d["\u0275\u0275pipeBind1"](51,29,a.isReinstatable()))}}var Zt,en=((Zt=function(e){l(i,e);var n=p(i);function i(e,t,a,r,c,s,l,d,p,u,m,f){var b;return o(this,i),(b=n.call(this,e,t,a,r,c,s)).itemService=e,b.objectUpdatesService=t,b.router=a,b.notificationsService=r,b.translateService=c,b.route=s,b.bitstreamService=l,b.objectCache=d,b.requestService=p,b.cdRef=u,b.bundleService=m,b.zone=f,b.bundlesOptions={id:"bundles-pagination-options",currentPage:1,pageSize:9999},b.columnSizes=new Ze([new Ye(2,2,3,4,4),new Ye(2,3,3,3,3),new Ye(2,2,2,2,2),new Ye(6,5,4,3,3)]),b.submitting=!1,b}return s(i,[{key:"postItemInit",value:function(){this.bundles$=this.itemService.getBundles(this.item.id,new Ge.a({pagination:this.bundlesOptions})).pipe(Object($.i)(),Object($.o)(),Object(y.a)((function(e){return e.page})))}},{key:"initializeNotificationsPrefix",value:function(){this.notificationsPrefix="item.edit.bitstreams.notifications."}},{key:"submit",value:function(){var e=this;this.submitting=!0,this.bundles$.pipe(Object(ie.a)(1)).pipe(Object(ne.a)((function(n){return Object(Je.a).apply(void 0,t(n.map((function(t){return e.objectUpdatesService.getFieldUpdates(t.self,[],!0)}))))})),Object(y.a)((function(e){var n;return(n=[]).concat.apply(n,t(e.map((function(e){return Object.values(e).filter((function(e){return e.changeType===He.c.REMOVE}))}))))})),Object(y.a)((function(e){return e.map((function(e){return e.field}))}))).pipe(Object(ie.a)(1),Object(ne.a)((function(n){return Object(j.e)(n)?Object(Je.a).apply(void 0,t(n.map((function(t){return e.bitstreamService.delete(t.id)})))):Object(g.a)(void 0)}))).pipe(Object(ie.a)(1)).subscribe((function(t){e.displayNotifications("item.edit.bitstreams.notifications.remove",t),e.reset(),e.submitting=!1}))}},{key:"dropBitstream",value:function(e,t){var n=this;this.zone.runOutsideAngular((function(){Object(j.b)(t)&&Object(j.b)(t.fromIndex)&&Object(j.b)(t.toIndex)&&Object(j.b)(t.finish)&&n.bundleService.patch(e,[{op:"move",from:"/_links/bitstreams/".concat(t.fromIndex,"/href"),path:"/_links/bitstreams/".concat(t.toIndex,"/href")}]).pipe(Object(ie.a)(1)).subscribe((function(i){n.zone.run((function(){n.displayNotifications("item.edit.bitstreams.notifications.move",[i]),n.requestService.removeByHrefSubstring(e.self).pipe(Object(re.a)((function(e){return e})),Object(ie.a)(1)).subscribe((function(){return t.finish()}))}))}))}))}},{key:"displayNotifications",value:function(e,t){var n=this;if(Object(j.e)(t)){var i=t.filter((function(e){return Object(j.b)(e)&&e.hasFailed})),a=t.filter((function(e){return Object(j.b)(e)&&e.hasSucceeded}));i.forEach((function(t){n.notificationsService.error(n.translateService.instant("".concat(e,".failed.title")),t.errorMessage)})),a.length>0&&this.notificationsService.success(this.translateService.instant("".concat(e,".saved.title")),this.translateService.instant("".concat(e,".saved.content")))}}},{key:"discard",value:function(){var e=this.notificationsService.info(this.getNotificationTitle("discarded"),this.getNotificationContent("discarded"),{timeOut:this.discardTimeOut});this.objectUpdatesService.discardAllFieldUpdates(this.url,e)}},{key:"reinstate",value:function(){var e=this;this.bundles$.pipe(Object(ie.a)(1)).subscribe((function(t){t.forEach((function(t){e.objectUpdatesService.reinstateFieldUpdates(t.self)}))}))}},{key:"isReinstatable",value:function(){var e=this;return this.bundles$.pipe(Object(ne.a)((function(n){return Object(Je.a).apply(void 0,t(n.map((function(t){return e.objectUpdatesService.isReinstatable(t.self)}))))})),Object(y.a)((function(e){return e.includes(!0)})))}},{key:"hasChanges",value:function(){var e=this;return this.bundles$.pipe(Object(ne.a)((function(n){return Object(Je.a).apply(void 0,t(n.map((function(t){return e.objectUpdatesService.hasUpdates(t.self)}))))})),Object(y.a)((function(e){return e.includes(!0)})))}},{key:"reset",value:function(){this.refreshItemCache()}},{key:"refreshItemCache",value:function(){var e=this;this.bundles$.pipe(Object(ie.a)(1)).subscribe((function(t){t.forEach((function(t){e.objectCache.remove(t.self),e.requestService.removeByHrefSubstring(t.self)})),e.objectCache.remove(e.item.self),e.requestService.removeByHrefSubstring(e.item.self)}))}},{key:"ngOnDestroy",value:function(){this.itemUpdateSubscription&&this.itemUpdateSubscription.unsubscribe()}}]),i}(We.a)).\u0275fac=function(e){return new(e||Zt)(d["\u0275\u0275directiveInject"](z.a),d["\u0275\u0275directiveInject"](le.a),d["\u0275\u0275directiveInject"](v.h),d["\u0275\u0275directiveInject"](U.a),d["\u0275\u0275directiveInject"](S.e),d["\u0275\u0275directiveInject"](v.a),d["\u0275\u0275directiveInject"](et.a),d["\u0275\u0275directiveInject"](tt.a),d["\u0275\u0275directiveInject"](nt.a),d["\u0275\u0275directiveInject"](d.ChangeDetectorRef),d["\u0275\u0275directiveInject"](it.a),d["\u0275\u0275directiveInject"](d.NgZone))},Zt.\u0275cmp=d["\u0275\u0275defineComponent"]({type:Zt,selectors:[["ds-item-bitstreams"]],features:[d["\u0275\u0275InheritDefinitionFeature"]],decls:3,vars:3,consts:[["class","item-bitstreams",4,"ngVar"],[1,"item-bitstreams"],[1,"button-row","top","d-flex","mt-2"],[1,"mr-auto","btn","btn-success",3,"routerLink"],[1,"fas","fa-upload"],[1,"d-none","d-sm-inline"],["class","btn btn-warning mr-1",3,"click",4,"ngIf"],[1,"btn","btn-primary","mr-1",3,"disabled","click"],[1,"fas","fa-save"],["class","btn btn-danger",3,"disabled","click",4,"ngIf"],["class","container table-bordered mt-4",4,"ngIf"],["class","alert alert-info w-100 d-inline-block mt-4","role","alert",4,"ngIf"],[3,"message",4,"ngIf"],[1,"button-row","bottom"],[1,"mt-4","float-right"],["class","btn btn-warning",3,"click",4,"ngIf"],[1,"btn","btn-primary",3,"disabled","click"],[1,"btn","btn-warning","mr-1",3,"click"],[1,"fas","fa-undo-alt"],[1,"btn","btn-danger",3,"disabled","click"],[1,"fas","fa-times"],[1,"container","table-bordered","mt-4"],[1,"row","header-row","font-weight-bold"],[3,"bundle","item","columnSizes","dropObject",4,"ngFor","ngForOf"],[3,"bundle","item","columnSizes","dropObject"],["role","alert",1,"alert","alert-info","w-100","d-inline-block","mt-4"],[3,"message"],[1,"btn","btn-warning",3,"click"]],template:function(e,t){1&e&&(d["\u0275\u0275template"](0,Yt,55,33,"div",0),d["\u0275\u0275pipe"](1,"async"),d["\u0275\u0275text"](2,"\n")),2&e&&d["\u0275\u0275property"]("ngVar",d["\u0275\u0275pipeBind1"](1,1,t.bundles$))},directives:[me.a,v.i,u.p,st,u.o,At,Ct.a],pipes:[u.b,S.d],styles:[".header-row[_ngcontent-%COMP%]{color:var(--bs-table-dark-color);background-color:var(--bs-table-dark-bg);border-color:var(--bs-table-dark-border-color)}.bundle-row[_ngcontent-%COMP%]{color:var(--bs-table-head-color);background-color:var(--bs-table-head-bg);border-color:var(--bs-table-border-color)}.row-element[_ngcontent-%COMP%]{padding:.75em;border-bottom:var(--bs-table-border-width) solid var(--bs-table-border-color)}.drag-handle[_ngcontent-%COMP%]{visibility:hidden}.bitstream-row-drag-handle[_ngcontent-%COMP%]:hover, .drag-handle[_ngcontent-%COMP%]:hover{cursor:move}[_nghost-%COMP%]     .bitstream-row-drag-handle:focus .drag-handle, [_nghost-%COMP%]     .bitstream-row:hover .drag-handle{visibility:visible!important}.cdk-drag-preview[_ngcontent-%COMP%]{margin-left:0;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12);box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12)}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%]{-webkit-transition:-webkit-transform .25s cubic-bezier(0,0,.2,1);transition:-webkit-transform .25s cubic-bezier(0,0,.2,1);transition:transform .25s cubic-bezier(0,0,.2,1);transition:transform .25s cubic-bezier(0,0,.2,1),-webkit-transform .25s cubic-bezier(0,0,.2,1)}.cdk-drop-list-dragging[_ngcontent-%COMP%]   .bitstream-row-drag-handle[_ngcontent-%COMP%], .cdk-drop-list-dragging[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%]{cursor:-webkit-grabbing;cursor:grabbing}"]}),Zt),tn=c("JX91"),nn=c("QhmN"),an=c("joI/"),rn=c("gWc+"),on=c("DNva"),cn=c("f7iX"),sn=c("DdXh"),ln=["tabs"];function dn(e,t){if(1&e){var n=d["\u0275\u0275getCurrentView"]();d["\u0275\u0275text"](0,"\n            "),d["\u0275\u0275elementStart"](1,"div",10),d["\u0275\u0275text"](2,"\n              "),d["\u0275\u0275elementStart"](3,"ds-collection-select",11),d["\u0275\u0275listener"]("confirm",(function(e){return d["\u0275\u0275restoreView"](n),d["\u0275\u0275nextContext"]().removeMappings(e)}))("cancel",(function(){return d["\u0275\u0275restoreView"](n),d["\u0275\u0275nextContext"]().onCancel()})),d["\u0275\u0275pipe"](4,"async"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](5,"\n            "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](6,"\n          ")}if(2&e){var i,a=d["\u0275\u0275nextContext"]();d["\u0275\u0275advance"](3),d["\u0275\u0275property"]("key","browse")("dsoRD$",a.itemCollectionsRD$)("paginationOptions",null==(i=d["\u0275\u0275pipeBind1"](4,6,a.searchOptions$))?null:i.pagination)("confirmButton","item.edit.item-mapper.buttons.remove")("cancelButton","item.edit.item-mapper.cancel")("dangerConfirm",!0)}}function pn(e,t){if(1&e){var n=d["\u0275\u0275getCurrentView"]();d["\u0275\u0275elementStart"](0,"div"),d["\u0275\u0275text"](1,"\n              "),d["\u0275\u0275elementStart"](2,"ds-collection-select",17),d["\u0275\u0275listener"]("confirm",(function(e){return d["\u0275\u0275restoreView"](n),d["\u0275\u0275nextContext"](2).mapCollections(e)}))("cancel",(function(){return d["\u0275\u0275restoreView"](n),d["\u0275\u0275nextContext"](2).onCancel()})),d["\u0275\u0275pipe"](3,"async"),d["\u0275\u0275pipe"](4,"async"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](5,"\n            "),d["\u0275\u0275elementEnd"]()}if(2&e){var i,a,r=d["\u0275\u0275nextContext"](2);d["\u0275\u0275advance"](2),d["\u0275\u0275property"]("key","map")("dsoRD$",r.mappedCollectionsRD$)("paginationOptions",null==(i=d["\u0275\u0275pipeBind1"](3,6,r.searchOptions$))?null:i.pagination)("sortOptions",null==(a=d["\u0275\u0275pipeBind1"](4,8,r.searchOptions$))?null:a.sort)("confirmButton","item.edit.item-mapper.buttons.add")("cancelButton","item.edit.item-mapper.cancel")}}function un(e,t){1&e&&(d["\u0275\u0275elementStart"](0,"div",18),d["\u0275\u0275text"](1),d["\u0275\u0275pipe"](2,"translate"),d["\u0275\u0275elementEnd"]()),2&e&&(d["\u0275\u0275advance"](1),d["\u0275\u0275textInterpolate1"]("\n              ",d["\u0275\u0275pipeBind1"](2,1,"item.edit.item-mapper.no-search"),"\n            "))}function mn(e,t){if(1&e){var n=d["\u0275\u0275getCurrentView"]();d["\u0275\u0275text"](0,"\n            "),d["\u0275\u0275elementStart"](1,"div",12),d["\u0275\u0275text"](2,"\n              "),d["\u0275\u0275elementStart"](3,"div",13),d["\u0275\u0275text"](4,"\n                "),d["\u0275\u0275elementStart"](5,"ds-search-form",14),d["\u0275\u0275listener"]("submitSearch",(function(){return d["\u0275\u0275restoreView"](n),d["\u0275\u0275nextContext"]().performedSearch=!0})),d["\u0275\u0275pipe"](6,"async"),d["\u0275\u0275pipe"](7,"translate"),d["\u0275\u0275text"](8,"\n                "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](9,"\n              "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](10,"\n            "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](11,"\n\n            "),d["\u0275\u0275template"](12,pn,6,10,"div",15),d["\u0275\u0275text"](13,"\n            "),d["\u0275\u0275template"](14,un,3,3,"div",16),d["\u0275\u0275text"](15,"\n          ")}if(2&e){var i,a=d["\u0275\u0275nextContext"]();d["\u0275\u0275advance"](5),d["\u0275\u0275property"]("query",null==(i=d["\u0275\u0275pipeBind1"](6,6,a.searchOptions$))?null:i.query)("currentUrl","./")("inPlaceSearch",!0)("searchPlaceholder",d["\u0275\u0275pipeBind1"](7,8,"item.edit.item-mapper.search-form.placeholder")),d["\u0275\u0275advance"](7),d["\u0275\u0275property"]("ngIf",a.performedSearch),d["\u0275\u0275advance"](2),d["\u0275\u0275property"]("ngIf",!a.performedSearch)}}var fn,bn=function(e){return{name:e}},vn=((fn=function(){function i(e,t,n,a,r,c,s,l,d){o(this,i),this.route=e,this.router=t,this.searchConfigService=n,this.searchService=a,this.notificationsService=r,this.itemDataService=c,this.collectionDataService=s,this.translateService=l,this.dsoNameService=d,this.performedSearch=!1}return s(i,[{key:"ngOnInit",value:function(){var e=this;this.itemRD$=this.route.parent.data.pipe(Object(ie.a)(1),Object(y.a)((function(e){return e.dso}))),this.itemName$=this.itemRD$.pipe(Object(re.a)((function(e){return Object(j.b)(e)})),Object(y.a)((function(t){return e.dsoNameService.getName(t.payload)}))),this.searchOptions$=this.searchConfigService.paginatedSearchOptions,this.loadCollectionLists()}},{key:"loadCollectionLists",value:function(){var n=this;console.log("loadCollectionLists"),this.shouldUpdate$=new Pe.a(!0),this.itemCollectionsRD$=Object(x.a)(this.itemRD$.pipe(Object($.j)()),this.shouldUpdate$).pipe(Object(ne.a)((function(t){var i=e(t,2),a=i[0],r=i[1];return!0===r&&n.shouldUpdate$.next(!1),n.collectionDataService.findAllByHref(n.itemDataService.getMappedCollectionsEndpoint(a.id),void 0,!r,!1).pipe(Object($.c)())})));var i=this.itemRD$.pipe(Object($.j)(),Object(ne.a)((function(e){return n.collectionDataService.findOwningCollectionFor(e)})),Object($.c)()),a=Object(x.a)(this.itemCollectionsRD$,i,this.searchOptions$);this.mappedCollectionsRD$=a.pipe(Object(ne.a)((function(i){var a=e(i,3),r=a[0],o=a[1],c=a[2];return n.searchService.search(Object.assign(new Ge.a(c),{query:n.buildQuery([].concat(t(r.payload.page),[o.payload]),c.query),dsoTypes:[nn.a.COLLECTION]}),1e4).pipe(Object($.y)(),Object(tn.a)(void 0))})))}},{key:"mapCollections",value:function(t){var n=this,i=Object(x.a)([this.itemRD$.pipe(Object($.i)(),Object(y.a)((function(e){return e.payload})),Object(y.a)((function(e){return e.id}))),this.itemCollectionsRD$.pipe(Object($.i)(),Object(y.a)((function(e){return e.payload.page})),Object(y.a)((function(e){return e.map((function(e){return e.id}))})))]).pipe(Object(ne.a)((function(i){var a=e(i,2),r=a[0],o=a[1];return Object(x.a)(n.filterIds(t,o).map((function(e){return n.itemDataService.mapToCollection(r,e).pipe(Object($.g)())})))})));this.showNotifications(i,"item.edit.item-mapper.notifications.add")}},{key:"removeMappings",value:function(e){var t=this,n=this.itemRD$.pipe(Object($.i)(),Object(y.a)((function(e){return e.payload.id})),Object(ne.a)((function(n){return Object(x.a)(e.map((function(e){return t.itemDataService.removeMappingFromCollection(n,e).pipe(Object($.g)())})))})));this.showNotifications(n,"item.edit.item-mapper.notifications.remove")}},{key:"filterIds",value:function(e,t){return e.filter((function(e){return t.indexOf(e)<0}))}},{key:"showNotifications",value:function(t,n){var i=this;t.subscribe((function(t){var a=t.filter((function(e){return e.hasSucceeded})),r=t.filter((function(e){return e.hasFailed}));a.length>0&&(Object(x.a)([i.translateService.get("".concat(n,".success.head")),i.translateService.get("".concat(n,".success.content"),{amount:a.length})]).subscribe((function(t){var n=e(t,2),a=n[0],r=n[1];i.notificationsService.success(a,r)})),i.shouldUpdate$.next(!0)),r.length>0&&Object(x.a)([i.translateService.get("".concat(n,".error.head")),i.translateService.get("".concat(n,".error.content"),{amount:r.length})]).subscribe((function(t){var n=e(t,2),a=n[0],r=n[1];i.notificationsService.error(a,r)})),i.switchToFirstTab()}))}},{key:"tabChange",value:function(e){this.performedSearch=!1,this.router.navigateByUrl(this.getCurrentUrl())}},{key:"getCurrentUrl",value:function(){return this.router.url.indexOf("?")>-1?this.router.url.substring(0,this.router.url.indexOf("?")):this.router.url}},{key:"buildQuery",value:function(e,t){var i,a=t,r=function(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=n(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,c=!0,s=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return c=e.done,e},e:function(e){s=!0,o=e},f:function(){try{c||null==i.return||i.return()}finally{if(s)throw o}}}}(e);try{for(r.s();!(i=r.n()).done;){var o=i.value;a=this.addExcludeCollection(o.id,a)}}catch(c){r.e(c)}finally{r.f()}return a}},{key:"addExcludeCollection",value:function(e,t){var n="-search.resourceid:".concat(e);return Object(j.e)(t)?"".concat(t," AND ").concat(n):n}},{key:"switchToFirstTab",value:function(){this.tabs.select("browseTab")}},{key:"onCancel",value:function(){var e=this;this.itemRD$.pipe(Object($.i)(),Object($.o)(),Object(ie.a)(1)).subscribe((function(t){e.router.navigate([Object(O.h)(t)])}))}}]),i}()).\u0275fac=function(e){return new(e||fn)(d["\u0275\u0275directiveInject"](v.a),d["\u0275\u0275directiveInject"](v.h),d["\u0275\u0275directiveInject"](an.a),d["\u0275\u0275directiveInject"](rn.a),d["\u0275\u0275directiveInject"](U.a),d["\u0275\u0275directiveInject"](z.a),d["\u0275\u0275directiveInject"](on.a),d["\u0275\u0275directiveInject"](S.e),d["\u0275\u0275directiveInject"](ht.a))},fn.\u0275cmp=d["\u0275\u0275defineComponent"]({type:fn,selectors:[["ds-item-collection-mapper"]],viewQuery:function(e,t){var n;1&e&&d["\u0275\u0275viewQuery"](ln,1),2&e&&d["\u0275\u0275queryRefresh"](n=d["\u0275\u0275loadQuery"]())&&(t.tabs=n.first)},decls:45,vars:24,consts:[[1,"container"],[1,"row"],[1,"col-12"],["id","item-name",3,"innerHTML"],["ngbNav","",1,"nav-tabs",3,"destroyOnHide","navChange"],["tabs","ngbNav"],[3,"ngbNavItem"],["ngbNavLink",""],["ngbNavContent",""],[3,"ngbNavOutlet"],[1,"mt-2"],[1,"mt-2",3,"key","dsoRD$","paginationOptions","confirmButton","cancelButton","dangerConfirm","confirm","cancel"],[1,"row","mt-2"],[1,"col-12","col-lg-6"],["id","search-form",3,"query","currentUrl","inPlaceSearch","searchPlaceholder","submitSearch"],[4,"ngIf"],["class","alert alert-info w-100","role","alert",4,"ngIf"],[1,"mt-2",3,"key","dsoRD$","paginationOptions","sortOptions","confirmButton","cancelButton","confirm","cancel"],["role","alert",1,"alert","alert-info","w-100"]],template:function(e,t){if(1&e&&(d["\u0275\u0275elementStart"](0,"div",0),d["\u0275\u0275text"](1,"\n  "),d["\u0275\u0275elementStart"](2,"div",1),d["\u0275\u0275text"](3,"\n    "),d["\u0275\u0275elementStart"](4,"div",2),d["\u0275\u0275text"](5,"\n      "),d["\u0275\u0275elementStart"](6,"h2"),d["\u0275\u0275text"](7),d["\u0275\u0275pipe"](8,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](9,"\n      "),d["\u0275\u0275element"](10,"p",3),d["\u0275\u0275pipe"](11,"translate"),d["\u0275\u0275pipe"](12,"async"),d["\u0275\u0275text"](13,"\n      "),d["\u0275\u0275elementStart"](14,"p"),d["\u0275\u0275text"](15),d["\u0275\u0275pipe"](16,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](17,"\n\n      "),d["\u0275\u0275elementStart"](18,"ul",4,5),d["\u0275\u0275listener"]("navChange",(function(e){return t.tabChange(e)})),d["\u0275\u0275text"](20,"\n        "),d["\u0275\u0275elementStart"](21,"li",6),d["\u0275\u0275text"](22,"\n          "),d["\u0275\u0275elementStart"](23,"a",7),d["\u0275\u0275text"](24),d["\u0275\u0275pipe"](25,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](26,"\n          "),d["\u0275\u0275template"](27,dn,7,8,"ng-template",8),d["\u0275\u0275text"](28,"\n        "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](29,"\n        "),d["\u0275\u0275elementStart"](30,"li",6),d["\u0275\u0275text"](31,"\n          "),d["\u0275\u0275elementStart"](32,"a",7),d["\u0275\u0275text"](33),d["\u0275\u0275pipe"](34,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](35,"\n          "),d["\u0275\u0275template"](36,mn,16,10,"ng-template",8),d["\u0275\u0275text"](37,"\n        "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](38,"\n      "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](39,"\n      "),d["\u0275\u0275element"](40,"div",9),d["\u0275\u0275text"](41,"\n    "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](42,"\n  "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](43,"\n"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](44,"\n")),2&e){var n=d["\u0275\u0275reference"](19);d["\u0275\u0275advance"](7),d["\u0275\u0275textInterpolate"](d["\u0275\u0275pipeBind1"](8,9,"item.edit.item-mapper.head")),d["\u0275\u0275advance"](3),d["\u0275\u0275property"]("innerHTML",d["\u0275\u0275pipeBind2"](11,11,"item.edit.item-mapper.item",d["\u0275\u0275pureFunction1"](22,bn,d["\u0275\u0275pipeBind1"](12,14,t.itemName$))),d["\u0275\u0275sanitizeHtml"]),d["\u0275\u0275advance"](5),d["\u0275\u0275textInterpolate"](d["\u0275\u0275pipeBind1"](16,16,"item.edit.item-mapper.description")),d["\u0275\u0275advance"](3),d["\u0275\u0275property"]("destroyOnHide",!0),d["\u0275\u0275advance"](3),d["\u0275\u0275property"]("ngbNavItem","browseTab"),d["\u0275\u0275advance"](3),d["\u0275\u0275textInterpolate"](d["\u0275\u0275pipeBind1"](25,18,"item.edit.item-mapper.tabs.browse")),d["\u0275\u0275advance"](6),d["\u0275\u0275property"]("ngbNavItem","mapTab"),d["\u0275\u0275advance"](3),d["\u0275\u0275textInterpolate"](d["\u0275\u0275pipeBind1"](34,20,"item.edit.item-mapper.tabs.map")),d["\u0275\u0275advance"](7),d["\u0275\u0275property"]("ngbNavOutlet",n)}},directives:[f.t,f.v,f.w,f.u,f.y,cn.a,sn.a,u.p],pipes:[S.d,u.b],styles:[""],data:{animation:[h.a,h.c]},changeDetection:0}),fn),hn=c("zdyR"),gn=c("3Pt+");function xn(e,t){1&e&&(d["\u0275\u0275elementStart"](0,"span"),d["\u0275\u0275text"](1,"\n                "),d["\u0275\u0275element"](2,"i",17),d["\u0275\u0275text"](3),d["\u0275\u0275pipe"](4,"translate"),d["\u0275\u0275elementEnd"]()),2&e&&(d["\u0275\u0275advance"](3),d["\u0275\u0275textInterpolate1"](" ",d["\u0275\u0275pipeBind1"](4,1,"item.edit.move.save-button"),"\n              "))}function yn(e,t){1&e&&(d["\u0275\u0275elementStart"](0,"span"),d["\u0275\u0275text"](1,"\n                "),d["\u0275\u0275element"](2,"i",18),d["\u0275\u0275text"](3),d["\u0275\u0275pipe"](4,"translate"),d["\u0275\u0275elementEnd"]()),2&e&&(d["\u0275\u0275advance"](3),d["\u0275\u0275textInterpolate1"](" ",d["\u0275\u0275pipeBind1"](4,1,"item.edit.move.processing"),"\n              "))}var jn,On=function(e){return{id:e}},Sn=function(){return{type:"collection"}},In=function(e){return[e,"edit"]},Cn=((jn=function(){function e(t,n,i,a,r,c,s){o(this,e),this.route=t,this.router=n,this.notificationsService=i,this.itemDataService=a,this.searchService=r,this.translateService=c,this.requestService=s,this.selectorType=nn.a.COLLECTION,this.inheritPolicies=!1,this.canSubmit=!1,this.processing=!1,this.COLLECTIONS=[nn.a.COLLECTION]}return s(e,[{key:"ngOnInit",value:function(){var e=this;this.itemRD$=this.route.data.pipe(Object(y.a)((function(e){return e.dso})),Object($.i)()),this.itemPageRoute$=this.itemRD$.pipe(Object($.d)(),Object(y.a)((function(e){return Object(O.h)(e)}))),this.itemRD$.subscribe((function(t){e.item=t.payload})),this.itemRD$.pipe(Object($.i)(),Object($.o)(),Object(ne.a)((function(e){return e.owningCollection})),Object($.i)(),Object($.o)()).subscribe((function(t){e.originalCollection=t}))}},{key:"selectDso",value:function(e){this.selectedCollection=e,this.selectedCollectionName=e.name,this.canSubmit=!0}},{key:"getCurrentUrl",value:function(){return this.router.url}},{key:"moveToCollection",value:function(){var e=this;this.processing=!0;var t=this.itemDataService.moveToCollection(this.item.id,this.selectedCollection).pipe(Object($.g)());t.subscribe((function(t){t.hasSucceeded?e.notificationsService.success(e.translateService.get("item.edit.move.success")):e.notificationsService.error(e.translateService.get("item.edit.move.error"))})),t.pipe(Object(ne.a)((function(){return e.requestService.setStaleByHrefSubstring(e.item.id)})),Object(ne.a)((function(){return e.itemDataService.findById(e.item.id,!1,!0,Object(ce.a)("owningCollection"))})),Object($.g)()).subscribe((function(){e.processing=!1,e.router.navigate([Object(O.e)(e.item)])}))}},{key:"discard",value:function(){this.selectedCollection=null,this.canSubmit=!1}},{key:"canMove",get:function(){var e;return this.canSubmit&&(null===(e=this.selectedCollection)||void 0===e?void 0:e.id)!==this.originalCollection.id}}]),e}()).\u0275fac=function(e){return new(e||jn)(d["\u0275\u0275directiveInject"](v.a),d["\u0275\u0275directiveInject"](v.h),d["\u0275\u0275directiveInject"](U.a),d["\u0275\u0275directiveInject"](z.a),d["\u0275\u0275directiveInject"](rn.a),d["\u0275\u0275directiveInject"](S.e),d["\u0275\u0275directiveInject"](nt.a))},jn.\u0275cmp=d["\u0275\u0275defineComponent"]({type:jn,selectors:[["ds-item-move"]],decls:84,vars:40,consts:[[1,"container"],[1,"row"],[1,"col-12"],[1,"card","mb-3"],[1,"card-header"],[1,"card-body"],[3,"types","currentDSOId","onSelect"],["type","checkbox","name","tc","id","inheritPoliciesCheckbox",3,"ngModel","ngModelChange"],["for","inheritPoliciesCheckbox"],[1,"button-row","bottom"],[1,"float-right"],[1,"btn","btn-outline-secondary",3,"routerLink"],[1,"fas","fa-arrow-left"],[1,"btn","btn-primary","mr-0",3,"disabled","click"],[4,"ngIf"],[1,"btn","btn-danger",3,"disabled","click"],[1,"fas","fa-times"],[1,"fas","fa-save"],[1,"fas","fa-circle-notch","fa-spin"]],template:function(e,t){var n;(1&e&&(d["\u0275\u0275elementStart"](0,"div",0),d["\u0275\u0275text"](1,"\n    "),d["\u0275\u0275elementStart"](2,"div",1),d["\u0275\u0275text"](3,"\n        "),d["\u0275\u0275elementStart"](4,"div",2),d["\u0275\u0275text"](5,"\n            "),d["\u0275\u0275elementStart"](6,"h2"),d["\u0275\u0275text"](7),d["\u0275\u0275pipe"](8,"translate"),d["\u0275\u0275pipe"](9,"async"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](10,"\n            "),d["\u0275\u0275elementStart"](11,"p"),d["\u0275\u0275text"](12),d["\u0275\u0275pipe"](13,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](14,"\n            "),d["\u0275\u0275elementStart"](15,"div",1),d["\u0275\u0275text"](16,"\n                "),d["\u0275\u0275elementStart"](17,"div",2),d["\u0275\u0275text"](18,"\n                  "),d["\u0275\u0275elementStart"](19,"div",3),d["\u0275\u0275text"](20,"\n                    "),d["\u0275\u0275elementStart"](21,"div",4),d["\u0275\u0275text"](22),d["\u0275\u0275pipe"](23,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](24,"\n                    "),d["\u0275\u0275elementStart"](25,"div",5),d["\u0275\u0275text"](26,"\n                      "),d["\u0275\u0275elementStart"](27,"ds-authorized-collection-selector",6),d["\u0275\u0275listener"]("onSelect",(function(e){return t.selectDso(e)})),d["\u0275\u0275text"](28,"\n                      "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](29,"\n                    "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](30,"\n                    "),d["\u0275\u0275element"](31,"div"),d["\u0275\u0275text"](32,"\n                  "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](33,"\n                "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](34,"\n            "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](35,"\n            "),d["\u0275\u0275elementStart"](36,"div",1),d["\u0275\u0275text"](37,"\n                "),d["\u0275\u0275elementStart"](38,"div",2),d["\u0275\u0275text"](39,"\n                    "),d["\u0275\u0275elementStart"](40,"p"),d["\u0275\u0275text"](41,"\n                        "),d["\u0275\u0275elementStart"](42,"input",7),d["\u0275\u0275listener"]("ngModelChange",(function(e){return t.inheritPolicies=e})),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](43,"\n                        "),d["\u0275\u0275elementStart"](44,"label",8),d["\u0275\u0275text"](45),d["\u0275\u0275pipe"](46,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](47,"\n                    "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](48,"\n                    "),d["\u0275\u0275elementStart"](49,"p"),d["\u0275\u0275text"](50),d["\u0275\u0275pipe"](51,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](52,"\n                "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](53,"\n            "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](54,"\n\n          "),d["\u0275\u0275elementStart"](55,"div",9),d["\u0275\u0275text"](56,"\n            "),d["\u0275\u0275elementStart"](57,"div",10),d["\u0275\u0275text"](58,"\n              "),d["\u0275\u0275elementStart"](59,"button",11),d["\u0275\u0275pipe"](60,"async"),d["\u0275\u0275text"](61,"\n                "),d["\u0275\u0275element"](62,"i",12),d["\u0275\u0275text"](63),d["\u0275\u0275pipe"](64,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](65,"\n              "),d["\u0275\u0275elementStart"](66,"button",13),d["\u0275\u0275listener"]("click",(function(){return t.moveToCollection()})),d["\u0275\u0275text"](67,"\n              "),d["\u0275\u0275template"](68,xn,5,3,"span",14),d["\u0275\u0275text"](69,"\n                "),d["\u0275\u0275template"](70,yn,5,3,"span",14),d["\u0275\u0275text"](71,"\n              "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](72,"\n              "),d["\u0275\u0275elementStart"](73,"button",15),d["\u0275\u0275listener"]("click",(function(){return t.discard()})),d["\u0275\u0275text"](74,"\n                "),d["\u0275\u0275element"](75,"i",16),d["\u0275\u0275text"](76),d["\u0275\u0275pipe"](77,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](78,"\n            "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](79,"\n          "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](80,"\n        "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](81,"\n    "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](82,"\n"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](83,"\n")),2&e)&&(d["\u0275\u0275advance"](7),d["\u0275\u0275textInterpolate"](d["\u0275\u0275pipeBind2"](8,15,"item.edit.move.head",d["\u0275\u0275pureFunction1"](35,On,null==(n=d["\u0275\u0275pipeBind1"](9,18,t.itemRD$))||null==n.payload?null:n.payload.handle))),d["\u0275\u0275advance"](5),d["\u0275\u0275textInterpolate"](d["\u0275\u0275pipeBind1"](13,20,"item.edit.move.description")),d["\u0275\u0275advance"](10),d["\u0275\u0275textInterpolate"](d["\u0275\u0275pipeBind2"](23,22,"dso-selector.placeholder",d["\u0275\u0275pureFunction0"](37,Sn))),d["\u0275\u0275advance"](5),d["\u0275\u0275property"]("types",t.COLLECTIONS)("currentDSOId",t.selectedCollection?t.selectedCollection.id:t.originalCollection.id),d["\u0275\u0275advance"](15),d["\u0275\u0275property"]("ngModel",t.inheritPolicies),d["\u0275\u0275advance"](3),d["\u0275\u0275textInterpolate"](d["\u0275\u0275pipeBind1"](46,25,"item.edit.move.inheritpolicies.checkbox")),d["\u0275\u0275advance"](5),d["\u0275\u0275textInterpolate1"]("\n                        ",d["\u0275\u0275pipeBind1"](51,27,"item.edit.move.inheritpolicies.description"),"\n                    "),d["\u0275\u0275advance"](9),d["\u0275\u0275property"]("routerLink",d["\u0275\u0275pureFunction1"](38,In,d["\u0275\u0275pipeBind1"](60,29,t.itemPageRoute$))),d["\u0275\u0275advance"](4),d["\u0275\u0275textInterpolate1"](" ",d["\u0275\u0275pipeBind1"](64,31,"item.edit.move.cancel"),"\n              "),d["\u0275\u0275advance"](3),d["\u0275\u0275property"]("disabled",!t.canMove),d["\u0275\u0275advance"](2),d["\u0275\u0275property"]("ngIf",!t.processing),d["\u0275\u0275advance"](2),d["\u0275\u0275property"]("ngIf",t.processing),d["\u0275\u0275advance"](3),d["\u0275\u0275property"]("disabled",!t.canSubmit),d["\u0275\u0275advance"](3),d["\u0275\u0275textInterpolate1"](" ",d["\u0275\u0275pipeBind1"](77,33,"item.edit.move.discard-button"),"\n              "))},directives:[hn.a,gn.CheckboxControlValueAccessor,gn.NgControlStatus,gn.NgModel,v.i,u.p],pipes:[S.d,u.b],encapsulation:2}),jn),wn=c("aFKe"),kn=c("BK0m"),En=c("vkgz"),Mn=c("1Pbu"),Bn=c("kcku"),Vn=c("EGek");function Rn(e,t){if(1&e&&(d["\u0275\u0275elementStart"](0,"div"),d["\u0275\u0275text"](1,"\n                        "),d["\u0275\u0275elementStart"](2,"div",15),d["\u0275\u0275text"](3),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](4,"\n                        "),d["\u0275\u0275elementStart"](5,"div"),d["\u0275\u0275text"](6),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](7,"\n                    "),d["\u0275\u0275elementEnd"]()),2&e){var n=t.$implicit;d["\u0275\u0275advance"](3),d["\u0275\u0275textInterpolate1"]("\n                            ",n.metadataField,"\n                        "),d["\u0275\u0275advance"](3),d["\u0275\u0275textInterpolate1"]("\n                            ",n.metadataValue.value,"\n                        ")}}function Pn(e,t){if(1&e){var n=d["\u0275\u0275getCurrentView"]();d["\u0275\u0275elementStart"](0,"div",9),d["\u0275\u0275listener"]("click",(function(){d["\u0275\u0275restoreView"](n);var e=t.ngVar,i=d["\u0275\u0275nextContext"]().$implicit;return d["\u0275\u0275nextContext"]().setSelectedVirtualMetadataItem(i,!e)})),d["\u0275\u0275text"](1,"\n                "),d["\u0275\u0275elementStart"](2,"div",10),d["\u0275\u0275text"](3,"\n                    "),d["\u0275\u0275elementStart"](4,"label"),d["\u0275\u0275text"](5,"\n                        "),d["\u0275\u0275element"](6,"input",11),d["\u0275\u0275text"](7,"\n                    "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](8,"\n                "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](9,"\n                "),d["\u0275\u0275elementStart"](10,"div",12),d["\u0275\u0275text"](11,"\n                    "),d["\u0275\u0275elementStart"](12,"ds-listable-object-component-loader",13),d["\u0275\u0275text"](13,"\n                    "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](14,"\n                    "),d["\u0275\u0275template"](15,Rn,8,2,"div",14),d["\u0275\u0275text"](16,"\n                "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](17,"\n            "),d["\u0275\u0275elementEnd"]()}if(2&e){var i=t.ngVar,a=d["\u0275\u0275nextContext"]().$implicit,r=d["\u0275\u0275nextContext"]();d["\u0275\u0275advance"](6),d["\u0275\u0275property"]("checked",i),d["\u0275\u0275advance"](6),d["\u0275\u0275property"]("object",a),d["\u0275\u0275advance"](3),d["\u0275\u0275property"]("ngForOf",r.virtualMetadata.get(a.uuid))}}function Tn(e,t){if(1&e&&(d["\u0275\u0275elementContainerStart"](0),d["\u0275\u0275text"](1,"\n            "),d["\u0275\u0275template"](2,Pn,18,3,"div",8),d["\u0275\u0275pipe"](3,"async"),d["\u0275\u0275text"](4,"\n        "),d["\u0275\u0275elementContainerEnd"]()),2&e){var n=t.$implicit,i=d["\u0275\u0275nextContext"]();d["\u0275\u0275advance"](2),d["\u0275\u0275property"]("ngVar",d["\u0275\u0275pipeBind1"](3,1,i.isSelectedVirtualMetadataItem(n)))}}var Fn,$n=((Fn=function(){function t(e){o(this,t),this.objectUpdatesService=e,this.close=new d.EventEmitter,this.save=new d.EventEmitter,this.virtualMetadata=new Map}return s(t,[{key:"items",get:function(){return[this.leftItem,this.rightItem]}},{key:"getVirtualMetadata",value:function(t){var n=this;return Object.entries(t.metadata).map((function(t){var i=e(t,2),a=i[0];return i[1].filter((function(e){return!a.startsWith("relation")&&e.authority&&e.authority.endsWith(n.relationshipId)})).map((function(e){return{metadataField:a,metadataValue:e}}))})).reduce((function(e,t){return e.concat(t)}),[])}},{key:"setSelectedVirtualMetadataItem",value:function(e,t){this.objectUpdatesService.setSelectedVirtualMetadata(this.url,this.relationshipId,e.uuid,t)}},{key:"isSelectedVirtualMetadataItem",value:function(e){return this.objectUpdatesService.isSelectedVirtualMetadata(this.url,this.relationshipId,e.uuid)}},{key:"trackItem",value:function(e,t){return t&&t.uuid}},{key:"ngOnInit",value:function(){var e=this;this.items.forEach((function(t){e.virtualMetadata.set(t.uuid,e.getVirtualMetadata(t))}))}}]),t}()).\u0275fac=function(e){return new(e||Fn)(d["\u0275\u0275directiveInject"](le.a))},Fn.\u0275cmp=d["\u0275\u0275defineComponent"]({type:Fn,selectors:[["ds-virtual-metadata"]],inputs:{url:"url",relationshipId:"relationshipId",leftItem:"leftItem",rightItem:"rightItem"},outputs:{close:"close",save:"save"},decls:27,vars:8,consts:[[1,"modal-header"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"d-flex","flex-row-reverse","m-2"],[1,"btn","btn-primary","save",3,"click"],[1,"fas","fa-save"],["class","item d-flex flex-row",3,"click",4,"ngVar"],[1,"item","d-flex","flex-row",3,"click"],[1,"m-2"],["type","checkbox",1,"select",3,"checked"],[1,"flex-column"],[3,"object"],[4,"ngFor","ngForOf"],[1,"font-weight-bold"]],template:function(e,t){1&e&&(d["\u0275\u0275elementStart"](0,"div"),d["\u0275\u0275text"](1,"\n    "),d["\u0275\u0275elementStart"](2,"div",0),d["\u0275\u0275text"](3),d["\u0275\u0275pipe"](4,"translate"),d["\u0275\u0275elementStart"](5,"button",1),d["\u0275\u0275listener"]("click",(function(){return t.close.emit()})),d["\u0275\u0275text"](6,"\n            "),d["\u0275\u0275elementStart"](7,"span",2),d["\u0275\u0275text"](8,"\xd7"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](9,"\n        "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](10,"\n    "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](11,"\n    "),d["\u0275\u0275elementStart"](12,"div",3),d["\u0275\u0275text"](13,"\n        "),d["\u0275\u0275template"](14,Tn,5,3,"ng-container",4),d["\u0275\u0275text"](15,"\n        "),d["\u0275\u0275elementStart"](16,"div",5),d["\u0275\u0275text"](17,"\n            "),d["\u0275\u0275elementStart"](18,"button",6),d["\u0275\u0275listener"]("click",(function(){return t.save.emit()})),d["\u0275\u0275text"](19,"\n                "),d["\u0275\u0275element"](20,"i",7),d["\u0275\u0275text"](21),d["\u0275\u0275pipe"](22,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](23,"\n        "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](24,"\n    "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](25,"\n"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](26,"\n")),2&e&&(d["\u0275\u0275advance"](3),d["\u0275\u0275textInterpolate1"]("",d["\u0275\u0275pipeBind1"](4,4,"virtual-metadata.delete-relationship.modal-head"),"\n        "),d["\u0275\u0275advance"](11),d["\u0275\u0275property"]("ngForOf",t.items)("ngForTrackBy",t.trackItem),d["\u0275\u0275advance"](7),d["\u0275\u0275textInterpolate1"](" ",d["\u0275\u0275pipeBind1"](22,6,"item.edit.metadata.save-button"),"\n            "))},directives:[u.o,me.a,fe.a],pipes:[S.d,u.b],encapsulation:2}),Fn);function Dn(e,t){if(1&e){var n=d["\u0275\u0275getCurrentView"]();d["\u0275\u0275elementStart"](0,"div",2),d["\u0275\u0275text"](1,"\n  "),d["\u0275\u0275elementStart"](2,"div",3),d["\u0275\u0275text"](3,"\n    "),d["\u0275\u0275elementStart"](4,"ds-listable-object-component-loader",4),d["\u0275\u0275pipe"](5,"async"),d["\u0275\u0275text"](6,"\n    "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](7,"\n  "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](8,"\n  "),d["\u0275\u0275elementStart"](9,"div",5),d["\u0275\u0275text"](10,"\n    "),d["\u0275\u0275elementStart"](11,"div",6),d["\u0275\u0275text"](12,"\n      "),d["\u0275\u0275elementStart"](13,"button",7),d["\u0275\u0275listener"]("click",(function(){d["\u0275\u0275restoreView"](n);var e=d["\u0275\u0275nextContext"](),t=d["\u0275\u0275reference"](4);return e.openVirtualMetadataModal(t)})),d["\u0275\u0275pipe"](14,"translate"),d["\u0275\u0275text"](15,"\n        "),d["\u0275\u0275element"](16,"i",8),d["\u0275\u0275text"](17,"\n      "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](18,"\n      "),d["\u0275\u0275elementStart"](19,"button",9),d["\u0275\u0275listener"]("click",(function(){return d["\u0275\u0275restoreView"](n),d["\u0275\u0275nextContext"]().undo()})),d["\u0275\u0275pipe"](20,"translate"),d["\u0275\u0275text"](21,"\n        "),d["\u0275\u0275element"](22,"i",10),d["\u0275\u0275text"](23,"\n      "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](24,"\n    "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](25,"\n  "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](26,"\n"),d["\u0275\u0275elementEnd"]()}if(2&e){var i=d["\u0275\u0275nextContext"]();d["\u0275\u0275advance"](4),d["\u0275\u0275property"]("object",d["\u0275\u0275pipeBind1"](5,7,i.relatedItem$))("viewMode",i.viewMode)("value",i.nameVariant),d["\u0275\u0275advance"](9),d["\u0275\u0275propertyInterpolate"]("title",d["\u0275\u0275pipeBind1"](14,9,"item.edit.metadata.edit.buttons.remove")),d["\u0275\u0275property"]("disabled",!i.canRemove()),d["\u0275\u0275advance"](6),d["\u0275\u0275propertyInterpolate"]("title",d["\u0275\u0275pipeBind1"](20,11,"item.edit.metadata.edit.buttons.undo")),d["\u0275\u0275property"]("disabled",!i.canUndo())}}function Un(e,t){if(1&e){var n=d["\u0275\u0275getCurrentView"]();d["\u0275\u0275text"](0,"\n  "),d["\u0275\u0275elementStart"](1,"ds-virtual-metadata",11),d["\u0275\u0275listener"]("close",(function(){return d["\u0275\u0275restoreView"](n),d["\u0275\u0275nextContext"]().closeVirtualMetadataModal()}))("save",(function(){return d["\u0275\u0275restoreView"](n),d["\u0275\u0275nextContext"]().remove()})),d["\u0275\u0275pipe"](2,"async"),d["\u0275\u0275pipe"](3,"async"),d["\u0275\u0275text"](4,"\n  "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](5,"\n")}if(2&e){var i=d["\u0275\u0275nextContext"]();d["\u0275\u0275advance"](1),d["\u0275\u0275property"]("relationshipId",i.relationship.id)("leftItem",d["\u0275\u0275pipeBind1"](2,4,i.leftItem$))("rightItem",d["\u0275\u0275pipeBind1"](3,6,i.rightItem$))("url",i.url)}}var zn,Ln=((zn=function(){function e(t,n){o(this,e),this.objectUpdatesService=t,this.modalService=n,this.viewMode=oe.a.ListElement}return s(e,[{key:"relationship",get:function(){return this.update.relationship}},{key:"update",get:function(){return this.fieldUpdate.field}},{key:"nameVariant",get:function(){return this.update.nameVariant}},{key:"ngOnChanges",value:function(){var e=this;this.relationship&&(this.relationship.leftItem||this.relationship.rightItem)?(this.leftItem$=this.relationship.leftItem.pipe(Object($.i)(),Object($.o)(),Object(re.a)((function(e){return Object(j.b)(e)&&Object(j.e)(e.uuid)}))),this.rightItem$=this.relationship.rightItem.pipe(Object($.i)(),Object($.o)(),Object(re.a)((function(e){return Object(j.b)(e)&&Object(j.e)(e.uuid)}))),this.relatedItem$=Object(x.a)(this.leftItem$,this.rightItem$).pipe(Object(y.a)((function(t){return t.find((function(t){return t.uuid!==e.editItem.uuid}))})))):this.relatedItem$=Object(g.a)(this.update.relatedItem)}},{key:"remove",value:function(){var e=this;this.closeVirtualMetadataModal(),Object(x.a)(this.leftItem$,this.rightItem$).pipe(Object(y.a)((function(t){return t.map((function(t){return e.objectUpdatesService.isSelectedVirtualMetadata(e.url,e.relationship.id,t.uuid)}))})),Object(ne.a)((function(e){return Object(x.a)(e)})),Object(y.a)((function(t){return Object.assign({},e.fieldUpdate.field,{keepLeftVirtualMetadata:!0===t[0],keepRightVirtualMetadata:!0===t[1]})})),Object(ie.a)(1)).subscribe((function(t){return e.objectUpdatesService.saveRemoveFieldUpdate(e.url,t)}))}},{key:"openVirtualMetadataModal",value:function(e){this.modalRef=this.modalService.open(e)}},{key:"closeVirtualMetadataModal",value:function(){this.modalRef.close()}},{key:"undo",value:function(){this.objectUpdatesService.removeSingleFieldUpdate(this.url,this.fieldUpdate.field.uuid)}},{key:"canRemove",value:function(){return this.fieldUpdate.changeType!==He.c.REMOVE&&this.fieldUpdate.changeType!==He.c.ADD}},{key:"canUndo",value:function(){return this.fieldUpdate.changeType>=0}}]),e}()).\u0275fac=function(e){return new(e||zn)(d["\u0275\u0275directiveInject"](le.a),d["\u0275\u0275directiveInject"](f.q))},zn.\u0275cmp=d["\u0275\u0275defineComponent"]({type:zn,selectors:[["ds-edit-relationship"]],inputs:{fieldUpdate:"fieldUpdate",url:"url",editItem:"editItem"},features:[d["\u0275\u0275NgOnChangesFeature"]],decls:6,vars:3,consts:[["class","row",4,"ngIf"],["virtualMetadataModal",""],[1,"row"],[1,"col-10","relationship"],[3,"object","viewMode","value"],[1,"col-2"],[1,"btn-group","relationship-action-buttons"],[1,"btn","btn-outline-danger","btn-sm",3,"disabled","title","click"],[1,"fas","fa-trash-alt","fa-fw"],[1,"btn","btn-outline-warning","btn-sm",3,"disabled","title","click"],[1,"fas","fa-undo-alt","fa-fw"],[3,"relationshipId","leftItem","rightItem","url","close","save"]],template:function(e,t){1&e&&(d["\u0275\u0275template"](0,Dn,27,13,"div",0),d["\u0275\u0275pipe"](1,"async"),d["\u0275\u0275text"](2,"\n"),d["\u0275\u0275template"](3,Un,6,8,"ng-template",null,1,d["\u0275\u0275templateRefExtractor"]),d["\u0275\u0275text"](5,"\n")),2&e&&d["\u0275\u0275property"]("ngIf",d["\u0275\u0275pipeBind1"](1,1,t.relatedItem$))},directives:[u.p,fe.a,$n],pipes:[u.b,S.d],styles:[".btn[disabled][_ngcontent-%COMP%]{color:var(--bs-gray-600);border-color:var(--bs-gray-600);z-index:0}.relationship-action-buttons[_ngcontent-%COMP%]{margin:0;position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}"]}),zn),_n=function(){return{}},An=function(e,t,n){return{"alert-success":e,"alert-warning":t,"alert-danger":n}};function Nn(e,t){if(1&e&&(d["\u0275\u0275elementStart"](0,"ds-edit-relationship",8),d["\u0275\u0275text"](1,"\n              "),d["\u0275\u0275elementEnd"]()),2&e){var n=t.$implicit,i=d["\u0275\u0275nextContext"](4);d["\u0275\u0275property"]("fieldUpdate",n||d["\u0275\u0275pureFunction0"](4,_n))("url",i.url)("editItem",i.item)("ngClass",d["\u0275\u0275pureFunction3"](5,An,1===n.changeType,0===n.changeType,2===n.changeType))}}function qn(e,t){1&e&&(d["\u0275\u0275elementStart"](0,"div"),d["\u0275\u0275text"](1),d["\u0275\u0275pipe"](2,"translate"),d["\u0275\u0275elementEnd"]()),2&e&&(d["\u0275\u0275advance"](1),d["\u0275\u0275textInterpolate"](d["\u0275\u0275pipeBind1"](2,1,"item.edit.relationships.no-relationships")))}function Kn(e,t){if(1&e&&(d["\u0275\u0275elementContainerStart"](0),d["\u0275\u0275text"](1,"\n          "),d["\u0275\u0275elementStart"](2,"ds-pagination",5),d["\u0275\u0275pipe"](3,"async"),d["\u0275\u0275pipe"](4,"async"),d["\u0275\u0275pipe"](5,"async"),d["\u0275\u0275text"](6,"\n            "),d["\u0275\u0275elementStart"](7,"div",6),d["\u0275\u0275text"](8,"\n              "),d["\u0275\u0275template"](9,Nn,2,9,"ds-edit-relationship",7),d["\u0275\u0275text"](10,"\n            "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](11,"\n          "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](12,"\n          "),d["\u0275\u0275template"](13,qn,3,3,"div",4),d["\u0275\u0275text"](14,"\n        "),d["\u0275\u0275elementContainerEnd"]()),2&e){var n,i,a=t.ngVar,r=d["\u0275\u0275nextContext"](3);d["\u0275\u0275advance"](2),d["\u0275\u0275property"]("paginationOptions",r.paginationConfig)("pageInfoState",null==(n=d["\u0275\u0275pipeBind1"](3,8,r.relationshipsRd$))||null==n.payload?null:n.payload.pageInfo)("collectionSize",(null==(i=d["\u0275\u0275pipeBind1"](4,10,r.relationshipsRd$))||null==i.payload?null:i.payload.totalElements)+d["\u0275\u0275pipeBind1"](5,12,r.nbAddedFields$))("hideGear",!0)("hidePagerWhenSinglePage",!0),d["\u0275\u0275advance"](7),d["\u0275\u0275property"]("ngForOf",a)("ngForTrackBy",r.trackUpdate),d["\u0275\u0275advance"](4),d["\u0275\u0275property"]("ngIf",0===a.length)}}function Xn(e,t){if(1&e&&(d["\u0275\u0275elementContainerStart"](0),d["\u0275\u0275text"](1,"\n        "),d["\u0275\u0275template"](2,Kn,15,14,"ng-container",3),d["\u0275\u0275pipe"](3,"dsObjectValues"),d["\u0275\u0275text"](4,"\n    "),d["\u0275\u0275elementContainerEnd"]()),2&e){var n=d["\u0275\u0275nextContext"]().ngVar;d["\u0275\u0275advance"](2),d["\u0275\u0275property"]("ngVar",d["\u0275\u0275pipeBind1"](3,1,n))}}function Qn(e,t){1&e&&d["\u0275\u0275element"](0,"ds-loading")}function Wn(e,t){if(1&e&&(d["\u0275\u0275elementContainerStart"](0),d["\u0275\u0275text"](1,"\n    "),d["\u0275\u0275template"](2,Xn,5,3,"ng-container",4),d["\u0275\u0275pipe"](3,"async"),d["\u0275\u0275text"](4,"\n    "),d["\u0275\u0275template"](5,Qn,1,0,"ds-loading",4),d["\u0275\u0275pipe"](6,"async"),d["\u0275\u0275text"](7,"\n"),d["\u0275\u0275elementContainerEnd"]()),2&e){var n=t.ngVar,i=d["\u0275\u0275nextContext"]();d["\u0275\u0275advance"](2),d["\u0275\u0275property"]("ngIf",n&&!d["\u0275\u0275pipeBind1"](3,2,i.loading$)),d["\u0275\u0275advance"](3),d["\u0275\u0275property"]("ngIf",d["\u0275\u0275pipeBind1"](6,4,i.loading$))}}var Jn,Hn=((Jn=function(){function t(e,n,i,a,r,c,s){o(this,t),this.objectUpdatesService=e,this.linkService=n,this.relationshipService=i,this.relationshipTypeService=a,this.modalService=r,this.paginationService=c,this.selectableListService=s,this.submit=new d.EventEmitter,this.updates$=new Pe.a(void 0),this.relationshipsRd$=new Pe.a(void 0),this.isLastPage$=new Pe.a(!0),this.loading$=new Pe.a(!0),this.nbAddedFields$=new Pe.a(0),this.subs=[]}return s(t,[{key:"getRelationshipMessageKey",value:function(){return Object(x.a)(this.getLabel(),this.relatedEntityType$).pipe(Object(y.a)((function(t){var n=e(t,2),i=n[0],a=n[1];if(Object(j.b)(i)&&i.indexOf("is")>-1&&i.indexOf("Of")>-1){var r="".concat(i.substring(2,i.indexOf("Of")));return r!==a.label?"relationships.is".concat(r,"Of.").concat(a.label):"relationships.is".concat(r,"Of")}return i})))}},{key:"getLabel",value:function(){var e=this;return Object(x.a)([this.relationshipType.leftType,this.relationshipType.rightType].map((function(e){return e.pipe(Object($.i)(),Object($.o)())}))).pipe(Object(y.a)((function(t){return[e.relationshipType.leftwardType,e.relationshipType.rightwardType][t.findIndex((function(t){return t.id===e.itemType.id}))]})))}},{key:"trackUpdate",value:function(e,t){return t&&t.field?t.field.uuid:void 0}},{key:"openLookup",value:function(){var e=this;this.modalRef=this.modalService.open(Mn.a,{size:"lg"});var t=this.modalRef.componentInstance;t.repeatable=!0,t.isEditRelationship=!0,t.listId=this.listId,t.item=this.item,t.relationshipType=this.relationshipType,t.currentItemIsLeftItem$=this.currentItemIsLeftItem$,t.toAdd=[],t.toRemove=[],t.isPending=!1,this.item.owningCollection.pipe(Object($.j)()).subscribe((function(e){t.collection=e})),t.select=function(){for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];i.forEach((function(n){var i=n.indexableObject,a=t.toRemove.findIndex((function(e){return e.uuid===i.uuid}));-1!==a?t.toRemove.splice(a,1):e.getRelationFromId(i).subscribe((function(a){if(a){var r=t.toRemove.findIndex((function(e){return e.indexableObject.uuid===i.uuid}));-1!==r&&t.toRemove.splice(r,1)}else t.toAdd.push(n);e.loading$.next(!0),e.relationshipsRd$.next(e.relationshipsRd$.getValue())}))}))},t.deselect=function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];n.forEach((function(e){var n=e.indexableObject,i=t.toAdd.findIndex((function(e){return e.indexableObject.uuid===n.uuid}));-1!==i?t.toAdd.splice(i,1):t.toRemove.push(e)}))},t.submitEv=function(){var n=[];t.toAdd.forEach((function(t){var i=t.indexableObject;n.push(e.relationshipService.getNameVariant(e.listId,i.uuid).pipe(Object(y.a)((function(n){var a={uuid:e.relationshipType.id+"-"+t.indexableObject.uuid,nameVariant:n,type:e.relationshipType,relatedItem:i};return e.objectUpdatesService.saveAddFieldUpdate(e.url,a),a}))))})),t.toRemove.forEach((function(t){n.push(e.relationshipService.getNameVariant(e.listId,t.indexableObjectuuid).pipe(Object(ne.a)((function(n){return e.getRelationFromId(t.indexableObject).pipe(Object(y.a)((function(t){var i={uuid:t.id,nameVariant:n,type:e.relationshipType,relationship:t};return e.objectUpdatesService.saveRemoveFieldUpdate(e.url,i),i})))}))))})),Object(x.a)(n).subscribe((function(n){setTimeout((function(){e.submit.emit()}),1e3),t.isPending=!0}))},t.discardEv=function(){t.toAdd.forEach((function(t){e.selectableListService.deselectSingle(e.listId,t)})),t.toRemove.forEach((function(t){e.selectableListService.selectSingle(e.listId,t)})),t.toAdd=[],t.toRemove=[]},this.relatedEntityType$.pipe(Object(ie.a)(1)).subscribe((function(e){t.relationshipOptions=Object.assign(new Bn.a,{relationshipType:e.label,searchConfiguration:e.label.toLowerCase(),nameVariants:"true"})})),this.selectableListService.deselectAll(this.listId)}},{key:"getRelationFromId",value:function(e){var t=this;return this.currentItemIsLeftItem$.pipe(Object(ie.a)(1),Object(ne.a)((function(n){return(n?t.relationshipService.searchByItemsAndType(t.relationshipType.id,t.item.uuid,t.relationshipType.leftwardType,[e.id]).pipe(Object($.i)(),Object($.o)()):t.relationshipService.searchByItemsAndType(t.relationshipType.id,t.item.uuid,t.relationshipType.rightwardType,[e.id]).pipe(Object($.i)(),Object($.o)())).pipe(Object(y.a)((function(e){return e.page[0]})))})))}},{key:"getFieldUpdatesForRelatedItem",value:function(e){var t=this;return this.updates$.pipe(Object(ie.a)(1),Object(y.a)((function(e){return Object.values(e).map((function(e){return e.field})).filter((function(e){return e.relationship}))})),Object(Be.a)((function(n){return Object(x.a)(n.map((function(e){return t.getRelatedItem(e.relationship)}))).pipe(Object(ae.a)([]),Object(y.a)((function(t){return n.filter((function(n,i){return t[i].uuid===e.uuid}))})))})))}},{key:"getIsRelatedItem",value:function(e){var t=this;return this.currentItemIsLeftItem$.pipe(Object(ie.a)(1),Object(y.a)((function(n){return n?!!t.item.allMetadataValues("relation."+t.relationshipType.leftwardType).find((function(t){return t===e.uuid})):!!t.item.allMetadataValues("relation."+t.relationshipType.rightwardType).find((function(t){return t===e.uuid}))})))}},{key:"getRelatedItem",value:function(e){return this.relationshipService.isLeftItem(e,this.item).pipe(Object(ne.a)((function(t){return t?e.rightItem:e.leftItem})),Object($.i)(),Object($.o)())}},{key:"ngOnInit",value:function(){var t=this;this.relationshipLeftAndRightType$=Object(x.a)([this.relationshipType.leftType,this.relationshipType.rightType].map((function(e){return e.pipe(Object($.i)(),Object($.o)())}))),this.relatedEntityType$=this.relationshipLeftAndRightType$.pipe(Object(y.a)((function(e){return e.find((function(e){return e.uuid!==t.itemType.uuid}))})),Object(j.c)()),this.relatedEntityType$.pipe(Object(ie.a)(1)).subscribe((function(e){return t.listId="edit-relationship-".concat(t.itemType.id,"-").concat(e.id)})),this.currentItemIsLeftItem$=this.relationshipLeftAndRightType$.pipe(Object(y.a)((function(n){var i=e(n,2),a=i[0],r=i[1];return a.id===t.itemType.id||r.id!==t.itemType.id&&void console.warn("The item ".concat(t.item.uuid," is not on the right or the left side of relationship type ").concat(t.relationshipType.uuid))}))),this.paginationConfig=new lt.a,this.paginationConfig.id="er".concat(this.relationshipType.id),this.paginationConfig.pageSize=5,this.paginationConfig.currentPage=1;var n=this.paginationService.getCurrentPagination(this.paginationConfig.id,this.paginationConfig).pipe(Object(En.a)((function(){return t.loading$.next(!0)})));this.subs.push(Object(x.a)([n,this.currentItemIsLeftItem$]).pipe(Object(ne.a)((function(n){var i=e(n,2),a=i[0],r=i[1];return t.relationshipService.getItemRelationshipsByLabel(t.item,r?t.relationshipType.leftwardType:t.relationshipType.rightwardType,{elementsPerPage:a.pageSize,currentPage:a.currentPage},!1,!0,Object(ce.a)("leftItem"),Object(ce.a)("rightItem"))}))).subscribe((function(e){t.relationshipsRd$.next(e)}))),this.subs.push(this.relationshipsRd$.pipe(Object(j.c)(),Object($.c)()).subscribe((function(e){t.isLastPage$.next(Object(j.a)(e.payload._links.next))}))),this.subs.push(this.relationshipsRd$.pipe(Object(j.c)(),Object($.c)(),Object(ne.a)((function(n){return Object(Te.a)(n.payload.page).pipe(Object(Be.a)((function(e){return t.relationshipService.isLeftItem(e,t.item).pipe(Object(y.a)((function(t){return[e,t]})))})),Object(y.a)((function(n){var i=e(n,2),a=i[0],r=i[1];return{uuid:a.id,type:t.relationshipType,relationship:a,nameVariant:r?a.rightwardValue:a.leftwardValue}})),Object(Re.a)(),Object(ae.a)([]))})),Object(ne.a)((function(e){return t.objectUpdatesService.getFieldUpdates(t.url,e).pipe(Object(y.a)((function(e){var n={};return t.nbAddedFields$.next(0),Object.keys(e).forEach((function(i){Object(j.b)(e[i])&&e[i].field.type.id===t.relationshipType.id&&(e[i].changeType===He.c.ADD?(t.nbAddedFields$.next(t.nbAddedFields$.getValue()+1),!0===t.isLastPage$.getValue()&&(n[i]=e[i])):n[i]=e[i])})),n})))})),Object(tn.a)({})).subscribe((function(e){t.loading$.next(!1),t.updates$.next(e)})))}},{key:"ngOnDestroy",value:function(){this.subs.filter((function(e){return Object(j.b)(e)})).forEach((function(e){return e.unsubscribe()}))}}]),t}()).\u0275fac=function(e){return new(e||Jn)(d["\u0275\u0275directiveInject"](le.a),d["\u0275\u0275directiveInject"](ue.a),d["\u0275\u0275directiveInject"](de.a),d["\u0275\u0275directiveInject"](kn.a),d["\u0275\u0275directiveInject"](f.q),d["\u0275\u0275directiveInject"](ft.a),d["\u0275\u0275directiveInject"](Vn.a))},Jn.\u0275cmp=d["\u0275\u0275defineComponent"]({type:Jn,selectors:[["ds-edit-relationship-list"]],inputs:{item:"item",itemType:"itemType",url:"url",relationshipType:"relationshipType",hasChanges:"hasChanges"},outputs:{submit:"submit"},decls:18,vars:14,consts:[[1,"ml-2","btn","btn-success",3,"disabled","click"],[1,"fas","fa-plus"],[1,"d-none","d-sm-inline"],[4,"ngVar"],[4,"ngIf"],[3,"paginationOptions","pageInfoState","collectionSize","hideGear","hidePagerWhenSinglePage"],[1,"my-2"],["class","relationship-row d-block alert",3,"fieldUpdate","url","editItem","ngClass",4,"ngFor","ngForOf","ngForTrackBy"],[1,"relationship-row","d-block","alert",3,"fieldUpdate","url","editItem","ngClass"]],template:function(e,t){1&e&&(d["\u0275\u0275elementStart"](0,"h5"),d["\u0275\u0275text"](1),d["\u0275\u0275pipe"](2,"translate"),d["\u0275\u0275pipe"](3,"async"),d["\u0275\u0275elementStart"](4,"button",0),d["\u0275\u0275listener"]("click",(function(){return t.openLookup()})),d["\u0275\u0275pipe"](5,"async"),d["\u0275\u0275text"](6,"\n        "),d["\u0275\u0275element"](7,"i",1),d["\u0275\u0275text"](8,"\n        "),d["\u0275\u0275elementStart"](9,"span",2),d["\u0275\u0275text"](10),d["\u0275\u0275pipe"](11,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](12,"\n    "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](13,"\n"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](14,"\n"),d["\u0275\u0275template"](15,Wn,8,6,"ng-container",3),d["\u0275\u0275pipe"](16,"async"),d["\u0275\u0275text"](17,"\n")),2&e&&(d["\u0275\u0275advance"](1),d["\u0275\u0275textInterpolate1"]("\n    ",d["\u0275\u0275pipeBind1"](2,4,d["\u0275\u0275pipeBind1"](3,6,t.getRelationshipMessageKey())),"\n    "),d["\u0275\u0275advance"](3),d["\u0275\u0275property"]("disabled",d["\u0275\u0275pipeBind1"](5,8,t.hasChanges)),d["\u0275\u0275advance"](6),d["\u0275\u0275textInterpolate1"]("\xa0",d["\u0275\u0275pipeBind1"](11,10,"item.edit.relationships.edit.buttons.add"),""),d["\u0275\u0275advance"](5),d["\u0275\u0275property"]("ngVar",d["\u0275\u0275pipeBind1"](16,12,t.updates$)))},directives:[me.a,u.p,pt.a,u.o,Ln,u.m,Ct.a],pipes:[S.d,u.b,mt.a],styles:[".relationship-row[_ngcontent-%COMP%]:not(.alert){padding:var(--bs-alert-padding-y) 0}.relationship-row.alert[_ngcontent-%COMP%]{margin-left:calc(-1 * var(--bs-alert-padding-x));margin-right:calc(-1 * var(--bs-alert-padding-x));margin-top:-1px;margin-bottom:-1px}"]}),Jn);function Gn(e,t){if(1&e){var n=d["\u0275\u0275getCurrentView"]();d["\u0275\u0275elementStart"](0,"button",14),d["\u0275\u0275listener"]("click",(function(){return d["\u0275\u0275restoreView"](n),d["\u0275\u0275nextContext"](3).discard()})),d["\u0275\u0275pipe"](1,"async"),d["\u0275\u0275element"](2,"i",15),d["\u0275\u0275text"](3,"\n          "),d["\u0275\u0275elementStart"](4,"span",9),d["\u0275\u0275text"](5),d["\u0275\u0275pipe"](6,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](7,"\n        "),d["\u0275\u0275elementEnd"]()}if(2&e){var i=d["\u0275\u0275nextContext"](3);d["\u0275\u0275property"]("disabled",!d["\u0275\u0275pipeBind1"](1,2,i.hasChanges())),d["\u0275\u0275advance"](5),d["\u0275\u0275textInterpolate1"]("\xa0",d["\u0275\u0275pipeBind1"](6,4,"item.edit.metadata.discard-button"),"")}}function Yn(e,t){if(1&e){var n=d["\u0275\u0275getCurrentView"]();d["\u0275\u0275elementStart"](0,"button",16),d["\u0275\u0275listener"]("click",(function(){return d["\u0275\u0275restoreView"](n),d["\u0275\u0275nextContext"](3).reinstate()})),d["\u0275\u0275element"](1,"i",17),d["\u0275\u0275text"](2,"\n          "),d["\u0275\u0275elementStart"](3,"span",9),d["\u0275\u0275text"](4),d["\u0275\u0275pipe"](5,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](6,"\n        "),d["\u0275\u0275elementEnd"]()}2&e&&(d["\u0275\u0275advance"](4),d["\u0275\u0275textInterpolate1"]("\xa0",d["\u0275\u0275pipeBind1"](5,1,"item.edit.metadata.reinstate-button"),""))}function Zn(e,t){if(1&e){var n=d["\u0275\u0275getCurrentView"]();d["\u0275\u0275elementStart"](0,"div",19),d["\u0275\u0275text"](1,"\n            "),d["\u0275\u0275elementStart"](2,"ds-edit-relationship-list",20),d["\u0275\u0275listener"]("submit",(function(){return d["\u0275\u0275restoreView"](n),d["\u0275\u0275nextContext"](5).submit()})),d["\u0275\u0275pipe"](3,"async"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](4,"\n          "),d["\u0275\u0275elementEnd"]()}if(2&e){var i=t.$implicit,a=d["\u0275\u0275nextContext"](5);d["\u0275\u0275advance"](2),d["\u0275\u0275property"]("url",a.url)("item",a.item)("itemType",d["\u0275\u0275pipeBind1"](3,5,a.entityType$))("relationshipType",i)("hasChanges",a.hasChanges())}}function ei(e,t){if(1&e&&(d["\u0275\u0275elementContainerStart"](0),d["\u0275\u0275text"](1,"\n          "),d["\u0275\u0275template"](2,Zn,5,7,"div",18),d["\u0275\u0275text"](3,"\n        "),d["\u0275\u0275elementContainerEnd"]()),2&e){var n=d["\u0275\u0275nextContext"]().ngVar;d["\u0275\u0275advance"](2),d["\u0275\u0275property"]("ngForOf",n)}}function ti(e,t){1&e&&d["\u0275\u0275element"](0,"ds-loading")}function ni(e,t){if(1&e&&(d["\u0275\u0275elementContainerStart"](0),d["\u0275\u0275text"](1,"\n        "),d["\u0275\u0275template"](2,ei,4,1,"ng-container",2),d["\u0275\u0275text"](3,"\n        "),d["\u0275\u0275template"](4,ti,1,0,"ds-loading",2),d["\u0275\u0275text"](5,"\n      "),d["\u0275\u0275elementContainerEnd"]()),2&e){var n=t.ngVar;d["\u0275\u0275advance"](2),d["\u0275\u0275property"]("ngIf",n),d["\u0275\u0275advance"](2),d["\u0275\u0275property"]("ngIf",!n)}}function ii(e,t){if(1&e){var n=d["\u0275\u0275getCurrentView"]();d["\u0275\u0275elementStart"](0,"button",21),d["\u0275\u0275listener"]("click",(function(){return d["\u0275\u0275restoreView"](n),d["\u0275\u0275nextContext"](3).discard()})),d["\u0275\u0275pipe"](1,"async"),d["\u0275\u0275element"](2,"i",15),d["\u0275\u0275text"](3,"\n            "),d["\u0275\u0275elementStart"](4,"span",9),d["\u0275\u0275text"](5),d["\u0275\u0275pipe"](6,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](7,"\n          "),d["\u0275\u0275elementEnd"]()}if(2&e){var i=d["\u0275\u0275nextContext"](3);d["\u0275\u0275property"]("disabled",!d["\u0275\u0275pipeBind1"](1,2,i.hasChanges())),d["\u0275\u0275advance"](5),d["\u0275\u0275textInterpolate1"]("\xa0",d["\u0275\u0275pipeBind1"](6,4,"item.edit.metadata.discard-button"),"")}}function ai(e,t){if(1&e){var n=d["\u0275\u0275getCurrentView"]();d["\u0275\u0275elementStart"](0,"button",22),d["\u0275\u0275listener"]("click",(function(){return d["\u0275\u0275restoreView"](n),d["\u0275\u0275nextContext"](3).reinstate()})),d["\u0275\u0275element"](1,"i",17),d["\u0275\u0275text"](2,"\n            "),d["\u0275\u0275elementStart"](3,"span",9),d["\u0275\u0275text"](4),d["\u0275\u0275pipe"](5,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](6,"\n          "),d["\u0275\u0275elementEnd"]()}2&e&&(d["\u0275\u0275advance"](4),d["\u0275\u0275textInterpolate1"]("\xa0",d["\u0275\u0275pipeBind1"](5,1,"item.edit.metadata.reinstate-button"),""))}function ri(e,t){if(1&e){var n=d["\u0275\u0275getCurrentView"]();d["\u0275\u0275elementContainerStart"](0),d["\u0275\u0275text"](1,"\n      "),d["\u0275\u0275elementStart"](2,"div",4),d["\u0275\u0275text"](3,"\n        "),d["\u0275\u0275template"](4,Gn,8,6,"button",5),d["\u0275\u0275pipe"](5,"async"),d["\u0275\u0275text"](6,"\n        "),d["\u0275\u0275template"](7,Yn,7,3,"button",6),d["\u0275\u0275pipe"](8,"async"),d["\u0275\u0275text"](9,"\n        "),d["\u0275\u0275elementStart"](10,"button",7),d["\u0275\u0275listener"]("click",(function(){return d["\u0275\u0275restoreView"](n),d["\u0275\u0275nextContext"](2).submit()})),d["\u0275\u0275pipe"](11,"async"),d["\u0275\u0275element"](12,"i",8),d["\u0275\u0275text"](13,"\n          "),d["\u0275\u0275elementStart"](14,"span",9),d["\u0275\u0275text"](15),d["\u0275\u0275pipe"](16,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](17,"\n        "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](18,"\n      "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](19,"\n      "),d["\u0275\u0275template"](20,ni,6,2,"ng-container",1),d["\u0275\u0275pipe"](21,"async"),d["\u0275\u0275text"](22,"\n      "),d["\u0275\u0275elementStart"](23,"div",10),d["\u0275\u0275text"](24,"\n        "),d["\u0275\u0275elementStart"](25,"div",11),d["\u0275\u0275text"](26,"\n          "),d["\u0275\u0275template"](27,ii,8,6,"button",12),d["\u0275\u0275pipe"](28,"async"),d["\u0275\u0275text"](29,"\n          "),d["\u0275\u0275template"](30,ai,7,3,"button",13),d["\u0275\u0275pipe"](31,"async"),d["\u0275\u0275text"](32,"\n          "),d["\u0275\u0275elementStart"](33,"button",7),d["\u0275\u0275listener"]("click",(function(){return d["\u0275\u0275restoreView"](n),d["\u0275\u0275nextContext"](2).submit()})),d["\u0275\u0275pipe"](34,"async"),d["\u0275\u0275element"](35,"i",8),d["\u0275\u0275text"](36,"\n            "),d["\u0275\u0275elementStart"](37,"span",9),d["\u0275\u0275text"](38),d["\u0275\u0275pipe"](39,"translate"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](40,"\n          "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](41,"\n        "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](42,"\n      "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](43,"\n    "),d["\u0275\u0275elementContainerEnd"]()}if(2&e){var i=d["\u0275\u0275nextContext"](2);d["\u0275\u0275advance"](4),d["\u0275\u0275property"]("ngIf",!d["\u0275\u0275pipeBind1"](5,9,i.isReinstatable())),d["\u0275\u0275advance"](3),d["\u0275\u0275property"]("ngIf",d["\u0275\u0275pipeBind1"](8,11,i.isReinstatable())),d["\u0275\u0275advance"](3),d["\u0275\u0275property"]("disabled",!d["\u0275\u0275pipeBind1"](11,13,i.hasChanges())),d["\u0275\u0275advance"](5),d["\u0275\u0275textInterpolate1"]("\xa0",d["\u0275\u0275pipeBind1"](16,15,"item.edit.metadata.save-button"),""),d["\u0275\u0275advance"](5),d["\u0275\u0275property"]("ngVar",d["\u0275\u0275pipeBind1"](21,17,i.relationshipTypes$)),d["\u0275\u0275advance"](7),d["\u0275\u0275property"]("ngIf",!d["\u0275\u0275pipeBind1"](28,19,i.isReinstatable())),d["\u0275\u0275advance"](3),d["\u0275\u0275property"]("ngIf",d["\u0275\u0275pipeBind1"](31,21,i.isReinstatable())),d["\u0275\u0275advance"](3),d["\u0275\u0275property"]("disabled",!d["\u0275\u0275pipeBind1"](34,23,i.hasChanges())),d["\u0275\u0275advance"](5),d["\u0275\u0275textInterpolate1"]("\xa0",d["\u0275\u0275pipeBind1"](39,25,"item.edit.metadata.save-button"),"")}}function oi(e,t){1&e&&(d["\u0275\u0275elementStart"](0,"div",23),d["\u0275\u0275text"](1),d["\u0275\u0275pipe"](2,"translate"),d["\u0275\u0275elementEnd"]()),2&e&&(d["\u0275\u0275advance"](1),d["\u0275\u0275textInterpolate1"]("\n      ",d["\u0275\u0275pipeBind1"](2,1,"item.edit.relationships.no-entity-type"),"\n    "))}function ci(e,t){if(1&e&&(d["\u0275\u0275elementContainerStart"](0),d["\u0275\u0275text"](1,"\n    "),d["\u0275\u0275template"](2,ri,44,27,"ng-container",2),d["\u0275\u0275text"](3,"\n    "),d["\u0275\u0275template"](4,oi,3,3,"div",3),d["\u0275\u0275text"](5,"\n  "),d["\u0275\u0275elementContainerEnd"]()),2&e){var n=t.ngVar;d["\u0275\u0275advance"](2),d["\u0275\u0275property"]("ngIf",n),d["\u0275\u0275advance"](2),d["\u0275\u0275property"]("ngIf",!n)}}var si,li=((si=function(n){l(a,n);var i=p(a);function a(e,t,n,r,c,s,l,d,p,u,m,f,b){var v;return o(this,a),(v=i.call(this,e,t,n,r,c,s)).itemService=e,v.objectUpdatesService=t,v.router=n,v.notificationsService=r,v.translateService=c,v.route=s,v.relationshipService=l,v.objectCache=d,v.requestService=p,v.entityTypeService=u,v.relationshipTypeService=m,v.cdr=f,v.modalService=b,v}return s(a,[{key:"initializeUpdates",value:function(){var e,n=this.item.firstMetadataValue("dspace.entity.type");void 0!==n?(this.relationshipTypes$=(e=this.relationshipTypeService).searchByEntityType.apply(e,[n,!0,!0].concat(t(this.getRelationshipTypeFollowLinks()))).pipe(Object(y.a)((function(e){return e.page}))),this.entityType$=this.entityTypeService.getEntityTypeByLabel(n).pipe(Object($.i)(),Object($.o)())):this.entityType$=Object(g.a)(void 0)}},{key:"initializeNotificationsPrefix",value:function(){this.notificationsPrefix="item.edit.relationships.notifications."}},{key:"submit",value:function(){var t=this,n=this.relationshipService.getItemRelationshipsArray(this.item).pipe(Object(tn.a)([]),Object(y.a)((function(e){return e.map((function(e){return Object.assign(new wn.a,e,{uuid:e.id})}))})),Object(ne.a)((function(e){return t.objectUpdatesService.getFieldUpdatesExclusive(t.url,e)})),Object(y.a)((function(e){return Object.values(e).filter((function(e){return e.changeType===He.c.REMOVE})).map((function(e){return e.field}))}))),i=this.objectUpdatesService.getFieldUpdates(this.url,[]).pipe(Object(y.a)((function(e){return Object.values(e).filter((function(e){return Object(j.b)(e)})).filter((function(e){return e.changeType===He.c.ADD})).map((function(e){return e.field}))})));Object(x.a)(n,i).pipe(Object(ie.a)(1)).subscribe((function(n){var i=e(n,2),a=i[0],r=i[1];[t.deleteRelationships(a),t.addRelationships(r)].forEach((function(e){return e.subscribe((function(e){e.length>0&&(t.initializeOriginalFields(),t.cdr.detectChanges(),t.displayNotifications(e),t.modalService.dismissAll())}))}))}))}},{key:"deleteRelationships",value:function(e){var n=this;return Object(Je.a).apply(void 0,t(e.map((function(e){var t;return t=e.keepLeftVirtualMetadata&&e.keepRightVirtualMetadata?"all":e.keepLeftVirtualMetadata?"left":e.keepRightVirtualMetadata?"right":"none",n.relationshipService.deleteRelationship(e.uuid,t)}))))}},{key:"addRelationships",value:function(e){var n=this;return Object(Je.a).apply(void 0,t(e.map((function(e){return n.entityType$.pipe(Object(ne.a)((function(t){return n.entityTypeService.isLeftType(e.type,t)})),Object(ne.a)((function(t){var i,a,r,o;return t?(i=n.item,a=e.relatedItem,r=null,o=e.nameVariant):(i=e.relatedItem,a=n.item,r=e.nameVariant,o=null),n.relationshipService.addRelationship(e.type.id,i,a,r,o)})))}))))}},{key:"displayNotifications",value:function(e){var t=this,n=e.filter((function(e){return e.hasFailed})),i=e.filter((function(e){return e.hasSucceeded}));n.forEach((function(e){t.notificationsService.error(t.getNotificationTitle("failed"),e.errorMessage)})),i.length>0&&this.notificationsService.success(this.getNotificationTitle("saved"),this.getNotificationContent("saved"))}},{key:"initializeOriginalFields",value:function(){var e=this;return this.relationshipService.getRelatedItems(this.item).pipe(Object(ie.a)(1)).subscribe((function(t){e.objectUpdatesService.initialize(e.url,t,e.item.lastModified)}))}},{key:"getRelationshipTypeFollowLinks",value:function(){return[Object(ce.a)("leftType"),Object(ce.a)("rightType")]}}]),a}(We.a)).\u0275fac=function(e){return new(e||si)(d["\u0275\u0275directiveInject"](z.a),d["\u0275\u0275directiveInject"](le.a),d["\u0275\u0275directiveInject"](v.h),d["\u0275\u0275directiveInject"](U.a),d["\u0275\u0275directiveInject"](S.e),d["\u0275\u0275directiveInject"](v.a),d["\u0275\u0275directiveInject"](de.a),d["\u0275\u0275directiveInject"](tt.a),d["\u0275\u0275directiveInject"](nt.a),d["\u0275\u0275directiveInject"](pe.a),d["\u0275\u0275directiveInject"](kn.a),d["\u0275\u0275directiveInject"](d.ChangeDetectorRef),d["\u0275\u0275directiveInject"](f.q))},si.\u0275cmp=d["\u0275\u0275defineComponent"]({type:si,selectors:[["ds-item-relationships"]],features:[d["\u0275\u0275InheritDefinitionFeature"]],decls:6,vars:3,consts:[[1,"item-relationships"],[4,"ngVar"],[4,"ngIf"],["class","alert alert-info mt-2","role","alert",4,"ngIf"],[1,"button-row","top","d-flex"],["class","btn btn-danger ml-auto",3,"disabled","click",4,"ngIf"],["class","btn btn-warning ml-auto",3,"click",4,"ngIf"],[1,"btn","btn-primary",3,"disabled","click"],[1,"fas","fa-save"],[1,"d-none","d-sm-inline"],[1,"button-row","bottom"],[1,"float-right"],["class","btn btn-danger",3,"disabled","click",4,"ngIf"],["class","btn btn-warning",3,"click",4,"ngIf"],[1,"btn","btn-danger","ml-auto",3,"disabled","click"],[1,"fas","fa-times"],[1,"btn","btn-warning","ml-auto",3,"click"],[1,"fas","fa-undo-alt"],["class","mb-4",4,"ngFor","ngForOf"],[1,"mb-4"],[3,"url","item","itemType","relationshipType","hasChanges","submit"],[1,"btn","btn-danger",3,"disabled","click"],[1,"btn","btn-warning",3,"click"],["role","alert",1,"alert","alert-info","mt-2"]],template:function(e,t){1&e&&(d["\u0275\u0275elementStart"](0,"div",0),d["\u0275\u0275text"](1,"\n  "),d["\u0275\u0275template"](2,ci,6,2,"ng-container",1),d["\u0275\u0275pipe"](3,"async"),d["\u0275\u0275text"](4,"\n"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](5,"\n")),2&e&&(d["\u0275\u0275advance"](2),d["\u0275\u0275property"]("ngVar",d["\u0275\u0275pipeBind1"](3,1,t.entityType$)))},directives:[me.a,u.p,u.o,Hn,Ct.a],pipes:[u.b,S.d],styles:[".button-row[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{margin-right:calc(.5 * var(--bs-spacer))}.button-row[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:last-child{margin-right:0}@media screen and (min-width:576px){.button-row[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{min-width:var(--ds-edit-item-button-min-width)}}.button-row.top[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{margin-top:calc(var(--bs-spacer) / 2);margin-bottom:calc(var(--bs-spacer) / 2)}"]}),si),di=c("A0IO"),pi=c("ac5F"),ui=c("Y9an");function mi(e,t){if(1&e&&d["\u0275\u0275element"](0,"ds-item-versions",3),2&e){var n=d["\u0275\u0275nextContext"]().ngVar;d["\u0275\u0275property"]("item",n)("displayWhenEmpty",!0)("displayTitle",!1)("displayActions",!0)}}function fi(e,t){if(1&e&&(d["\u0275\u0275elementStart"](0,"div",1),d["\u0275\u0275text"](1,"\n  "),d["\u0275\u0275template"](2,mi,1,4,"ds-item-versions",2),d["\u0275\u0275text"](3,"\n"),d["\u0275\u0275elementEnd"]()),2&e){var n=t.ngVar;d["\u0275\u0275advance"](2),d["\u0275\u0275property"]("ngIf",n)}}var bi,vi=((bi=function(){function e(t){o(this,e),this.route=t,this.AlertTypeEnum=pi.a}return s(e,[{key:"ngOnInit",value:function(){this.itemRD$=this.route.parent.parent.data.pipe(Object(y.a)((function(e){return e.dso}))).pipe(Object($.i)())}}]),e}()).\u0275fac=function(e){return new(e||bi)(d["\u0275\u0275directiveInject"](v.a))},bi.\u0275cmp=d["\u0275\u0275defineComponent"]({type:bi,selectors:[["ds-item-version-history"]],decls:3,vars:3,consts:[["class","mt-2",4,"ngVar"],[1,"mt-2"],[3,"item","displayWhenEmpty","displayTitle","displayActions",4,"ngIf"],[3,"item","displayWhenEmpty","displayTitle","displayActions"]],template:function(e,t){var n;(1&e&&(d["\u0275\u0275template"](0,fi,4,1,"div",0),d["\u0275\u0275pipe"](1,"async"),d["\u0275\u0275text"](2,"\n")),2&e)&&d["\u0275\u0275property"]("ngVar",null==(n=d["\u0275\u0275pipeBind1"](1,1,t.itemRD$))?null:n.payload)},directives:[me.a,u.p,ui.a],pipes:[u.b],encapsulation:2}),bi),hi=c("JIr8"),gi=c("f+Ev"),xi=c("VYMa"),yi=c("+Bs4"),ji=c("xPuV");function Oi(e,t){if(1&e&&(d["\u0275\u0275elementContainerStart"](0),d["\u0275\u0275text"](1,"\n      "),d["\u0275\u0275element"](2,"ds-resource-policies",2),d["\u0275\u0275text"](3,"\n    "),d["\u0275\u0275elementContainerEnd"]()),2&e){var n=t.$implicit;d["\u0275\u0275advance"](2),d["\u0275\u0275property"]("resourceType","bitstream")("resourceUUID",n.id)}}function Si(e,t){if(1&e&&(d["\u0275\u0275elementContainerStart"](0),d["\u0275\u0275text"](1,"\n    "),d["\u0275\u0275element"](2,"ds-resource-policies",2),d["\u0275\u0275text"](3,"\n    "),d["\u0275\u0275template"](4,Oi,4,2,"ng-container",3),d["\u0275\u0275pipe"](5,"async"),d["\u0275\u0275text"](6,"\n  "),d["\u0275\u0275elementContainerEnd"]()),2&e){var n,i=t.$implicit,a=d["\u0275\u0275nextContext"]();d["\u0275\u0275advance"](2),d["\u0275\u0275property"]("resourceType","bundle")("resourceUUID",i.id),d["\u0275\u0275advance"](2),d["\u0275\u0275property"]("ngForOf",null==(n=d["\u0275\u0275pipeBind1"](5,3,a.bundleBitstreamsMap.get(i.id)))?null:n.page)}}var Ii,Ci,wi,ki,Ei,Mi,Bi,Vi,Ri,Pi,Ti=((Ii=function(){function e(t,n){o(this,e),this.linkService=t,this.route=n,this.bundleBitstreamsMap=new Map,this.bundles$=new Pe.a([]),this.subs=[]}return s(e,[{key:"ngOnInit",value:function(){var e=this;this.item$=this.route.data.pipe(Object(y.a)((function(e){return e.dso})),Object($.k)(),Object(y.a)((function(t){return e.linkService.resolveLink(t,Object(ce.a)("bundles",{},Object(ce.a)("bitstreams")))})));var t=this.item$.pipe(Object(re.a)((function(e){return Object(j.e)(e.bundles)})),Object(Be.a)((function(e){return e.bundles})),Object($.k)(),Object(hi.a)((function(e){return console.error(e),Object(g.a)(Object(gi.b)(null,[]))})));this.subs.push(t.pipe(Object(ie.a)(1),Object(y.a)((function(e){return e.page}))).subscribe((function(t){e.bundles$.next(t)})),t.pipe(Object(ie.a)(1),Object(Be.a)((function(e){return e.page})),Object(y.a)((function(t){return{id:t.id,bitstreams:e.getBundleBitstreams(t)}}))).subscribe((function(t){e.bundleBitstreamsMap.set(t.id,t.bitstreams)})))}},{key:"getItemUUID",value:function(){return this.item$.pipe(Object(y.a)((function(e){return e.id})),Object(D.a)((function(e){return Object(j.e)(e)})))}},{key:"getItemBundles",value:function(){return this.bundles$.asObservable()}},{key:"getBundleBitstreams",value:function(e){return e.bitstreams.pipe(Object($.j)(),Object(hi.a)((function(e){return console.error(e),Object(g.a)(Object(gi.b)(null,[]))})))}},{key:"ngOnDestroy",value:function(){this.subs.filter((function(e){return Object(j.b)(e)})).forEach((function(e){return e.unsubscribe()}))}}]),e}()).\u0275fac=function(e){return new(e||Ii)(d["\u0275\u0275directiveInject"](ue.a),d["\u0275\u0275directiveInject"](v.a))},Ii.\u0275cmp=d["\u0275\u0275defineComponent"]({type:Ii,selectors:[["ds-item-authorizations"]],decls:11,vars:9,consts:[[1,"container"],[3,"type","content"],[3,"resourceType","resourceUUID"],[4,"ngFor","ngForTrackById","ngForOf"]],template:function(e,t){1&e&&(d["\u0275\u0275elementStart"](0,"div",0),d["\u0275\u0275text"](1,"\n  "),d["\u0275\u0275element"](2,"ds-alert",1),d["\u0275\u0275text"](3,"\n  "),d["\u0275\u0275element"](4,"ds-resource-policies",2),d["\u0275\u0275pipe"](5,"async"),d["\u0275\u0275text"](6,"\n  "),d["\u0275\u0275template"](7,Si,7,5,"ng-container",3),d["\u0275\u0275pipe"](8,"async"),d["\u0275\u0275text"](9,"\n"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](10,"\n\n")),2&e&&(d["\u0275\u0275advance"](2),d["\u0275\u0275property"]("type","alert-info")("content","item.edit.authorizations.heading"),d["\u0275\u0275advance"](2),d["\u0275\u0275property"]("resourceType","item")("resourceUUID",d["\u0275\u0275pipeBind1"](5,5,t.getItemUUID())),d["\u0275\u0275advance"](3),d["\u0275\u0275property"]("ngForOf",d["\u0275\u0275pipeBind1"](8,7,t.getItemBundles())))},directives:[xi.a,yi.a,u.o,ji.a],pipes:[u.b],encapsulation:2}),Ii),Fi=c("n1Qy"),$i=c("G5zm"),Di=c("EEUA"),Ui=c("ALMP"),zi=c("tv3Y"),Li=c("jrTz"),_i=c("0TMo"),Ai=c("z3/6"),Ni=c("Vurf"),qi=((ki=function(e){l(n,e);var t=p(n);function n(e,i,a,r){var c;return o(this,n),(c=t.call(this,e,i,a,r)).resolver=e,c.authorizationService=i,c.router=a,c.authService=r,c}return s(n,[{key:"getFeatureID",value:function(e,t){return Object(g.a)(Fe.a.ReinstateItem)}}]),n}(_i.a)).\u0275fac=function(e){return new(e||ki)(d["\u0275\u0275inject"](Ai.a),d["\u0275\u0275inject"]($e.a),d["\u0275\u0275inject"](v.h),d["\u0275\u0275inject"](Ni.a))},ki.\u0275prov=d["\u0275\u0275defineInjectable"]({token:ki,factory:ki.\u0275fac,providedIn:"root"}),ki),Ki=((wi=function(e){l(n,e);var t=p(n);function n(e,i,a,r){var c;return o(this,n),(c=t.call(this,e,i,a,r)).resolver=e,c.authorizationService=i,c.router=a,c.authService=r,c}return s(n,[{key:"getFeatureID",value:function(e,t){return Object(g.a)(Fe.a.WithdrawItem)}}]),n}(_i.a)).\u0275fac=function(e){return new(e||wi)(d["\u0275\u0275inject"](Ai.a),d["\u0275\u0275inject"]($e.a),d["\u0275\u0275inject"](v.h),d["\u0275\u0275inject"](Ni.a))},wi.\u0275prov=d["\u0275\u0275defineInjectable"]({token:wi,factory:wi.\u0275fac,providedIn:"root"}),wi),Xi=((Ci=function(e){l(n,e);var t=p(n);function n(e,i,a,r){var c;return o(this,n),(c=t.call(this,e,i,a,r)).resolver=e,c.authorizationService=i,c.router=a,c.authService=r,c}return s(n,[{key:"getFeatureID",value:function(e,t){return Object(g.a)(Fe.a.CanEditMetadata)}}]),n}(_i.a)).\u0275fac=function(e){return new(e||Ci)(d["\u0275\u0275inject"](Ai.a),d["\u0275\u0275inject"]($e.a),d["\u0275\u0275inject"](v.h),d["\u0275\u0275inject"](Ni.a))},Ci.\u0275prov=d["\u0275\u0275defineInjectable"]({token:Ci,factory:Ci.\u0275fac,providedIn:"root"}),Ci),Qi=c("920W"),Wi=c("HENg"),Ji=((Pi=function(e){l(n,e);var t=p(n);function n(e,i,a,r){var c;return o(this,n),(c=t.call(this,e,i,a,r)).resolver=e,c.authorizationService=i,c.router=a,c.authService=r,c}return s(n,[{key:"getFeatureIDs",value:function(e,t){return Object(g.a)([Fe.a.CanManageMappings,Fe.a.WithdrawItem,Fe.a.ReinstateItem,Fe.a.CanManagePolicies,Fe.a.CanMakePrivate,Fe.a.CanDelete,Fe.a.CanMove])}}]),n}(Wi.a)).\u0275fac=function(e){return new(e||Pi)(d["\u0275\u0275inject"](Ai.a),d["\u0275\u0275inject"]($e.a),d["\u0275\u0275inject"](v.h),d["\u0275\u0275inject"](Ni.a))},Pi.\u0275prov=d["\u0275\u0275defineInjectable"]({token:Pi,factory:Pi.\u0275fac,providedIn:"root"}),Pi),Hi=((Ri=function(e){l(n,e);var t=p(n);function n(e,i,a,r){var c;return o(this,n),(c=t.call(this,e,i,a,r)).resolver=e,c.authorizationService=i,c.router=a,c.authService=r,c}return s(n,[{key:"getFeatureID",value:function(e,t){return Object(g.a)(Fe.a.CanManageBitstreamBundles)}}]),n}(_i.a)).\u0275fac=function(e){return new(e||Ri)(d["\u0275\u0275inject"](Ai.a),d["\u0275\u0275inject"]($e.a),d["\u0275\u0275inject"](v.h),d["\u0275\u0275inject"](Ni.a))},Ri.\u0275prov=d["\u0275\u0275defineInjectable"]({token:Ri,factory:Ri.\u0275fac,providedIn:"root"}),Ri),Gi=((Vi=function(e){l(n,e);var t=p(n);function n(e,i,a,r){var c;return o(this,n),(c=t.call(this,e,i,a,r)).resolver=e,c.authorizationService=i,c.router=a,c.authService=r,c}return s(n,[{key:"getFeatureID",value:function(e,t){return Object(g.a)(Fe.a.CanManageRelationships)}}]),n}(_i.a)).\u0275fac=function(e){return new(e||Vi)(d["\u0275\u0275inject"](Ai.a),d["\u0275\u0275inject"]($e.a),d["\u0275\u0275inject"](v.h),d["\u0275\u0275inject"](Ni.a))},Vi.\u0275prov=d["\u0275\u0275defineInjectable"]({token:Vi,factory:Vi.\u0275fac,providedIn:"root"}),Vi),Yi=((Bi=function(e){l(n,e);var t=p(n);function n(e,i,a,r){var c;return o(this,n),(c=t.call(this,e,i,a,r)).resolver=e,c.authorizationService=i,c.router=a,c.authService=r,c}return s(n,[{key:"getFeatureID",value:function(e,t){return Object(g.a)(Fe.a.CanManageVersions)}}]),n}(_i.a)).\u0275fac=function(e){return new(e||Bi)(d["\u0275\u0275inject"](Ai.a),d["\u0275\u0275inject"]($e.a),d["\u0275\u0275inject"](v.h),d["\u0275\u0275inject"](Ni.a))},Bi.\u0275prov=d["\u0275\u0275defineInjectable"]({token:Bi,factory:Bi.\u0275fac,providedIn:"root"}),Bi),Zi=((Mi=function(e){l(n,e);var t=p(n);function n(e,i,a,r){var c;return o(this,n),(c=t.call(this,e,i,a,r)).resolver=e,c.authorizationService=i,c.router=a,c.authService=r,c}return s(n,[{key:"getFeatureID",value:function(e,t){return Object(g.a)(Fe.a.CanManageMappings)}}]),n}(_i.a)).\u0275fac=function(e){return new(e||Mi)(d["\u0275\u0275inject"](Ai.a),d["\u0275\u0275inject"]($e.a),d["\u0275\u0275inject"](v.h),d["\u0275\u0275inject"](Ni.a))},Mi.\u0275prov=d["\u0275\u0275defineInjectable"]({token:Mi,factory:Mi.\u0275fac,providedIn:"root"}),Mi),ea=((Ei=function e(){o(this,e)}).\u0275fac=function(e){return new(e||Ei)},Ei.\u0275mod=d["\u0275\u0275defineNgModule"]({type:Ei}),Ei.\u0275inj=d["\u0275\u0275defineInjector"]({providers:[di.a,zi.a,$i.a,Fi.a,qi,Ki,Qi.a,Xi,Ji,Hi,Gi,Yi,Zi],imports:[[v.l.forChild([{path:"",resolve:{breadcrumb:di.a},data:{breadcrumbKey:"item.edit"},children:[{path:"",component:F,children:[{path:"",redirectTo:"status",pathMatch:"full"},{path:"status",component:Xe,data:{title:"item.edit.tabs.status.title",showBreadcrumbs:!0},canActivate:[Ji]},{path:"bitstreams",component:en,data:{title:"item.edit.tabs.bitstreams.title",showBreadcrumbs:!0},canActivate:[Hi]},{path:"metadata",component:Qe.a,data:{title:"item.edit.tabs.metadata.title",showBreadcrumbs:!0},canActivate:[Xi]},{path:"relationships",component:li,data:{title:"item.edit.tabs.relationships.title",showBreadcrumbs:!0},canActivate:[Gi]},{path:"versionhistory",component:vi,data:{title:"item.edit.tabs.versionhistory.title",showBreadcrumbs:!0},canActivate:[Yi]},{path:"mapper",component:vn,data:{title:"item.edit.tabs.item-mapper.title",showBreadcrumbs:!0},canActivate:[Zi]}]},{path:"mapper",component:vn},{path:Li.g,component:X,canActivate:[Ki]},{path:Li.f,component:J,canActivate:[qi]},{path:Li.d,component:Y},{path:Li.e,component:te},{path:Li.b,component:Ee},{path:Li.c,component:Cn,data:{title:"item.edit.move.title"}},{path:Li.a,children:[{path:"create",resolve:{resourcePolicyTarget:Fi.a},component:Di.a,data:{title:"resource-policies.create.page.title"}},{path:"edit",resolve:{resourcePolicy:$i.a},component:Ui.a,data:{title:"resource-policies.edit.page.title"}},{path:"",component:Ti,data:{title:"item.edit.authorizations.title"}}]}]}])]]}),Ei);c("mo41");var ta,na=c("iprd"),ia=c("GFj5"),aa=((ta=function e(){o(this,e)}).\u0275fac=function(e){return new(e||ta)},ta.\u0275mod=d["\u0275\u0275defineNgModule"]({type:ta}),ta.\u0275inj=d["\u0275\u0275defineInjector"]({providers:[it.a,mt.a],imports:[[u.c,b.a,f.P,ea,na.a,dt.d,ia.a]]}),ta)},GCaJ:function(e,n,i){"use strict";i.d(n,"a",(function(){return h}));var a=i("zr/d"),r=i("LRne"),c=i("84Zn"),l=i("cBqT"),d=i("eIep"),p=i("lJxs"),u=i("J3qs"),m=i("fXoL"),f=i("TVZh"),b=i("sfEo"),v=i("C765"),h=function(){var e=function(){function e(t,n){o(this,e),this.linkService=t,this.dsoNameService=n}return s(e,[{key:"getBreadcrumbs",value:function(e,n){var i=this,o=this.dsoNameService.getName(e),s=new a.a(o,n),m=e.getParentLinkKey();return this.linkService.resolveLink(e,Object(c.a)(m))[m].pipe(Object(l.a)((function(e){return e.hasSucceeded||204===e.statusCode})),Object(d.a)((function(e){if(Object(u.b)(e.payload)){var t=e.payload;return i.getBreadcrumbs(t,Object(f.r)(t))}return Object(r.a)([])})),Object(p.a)((function(e){return[].concat(t(e),[s])})))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(m["\u0275\u0275inject"](b.a),m["\u0275\u0275inject"](v.a))},e.\u0275prov=m["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()},GsQf:function(n,i,a){"use strict";a.d(i,"a",(function(){return w}));var r=a("fXoL"),c=a("itXk"),d=a("lJxs"),u=a("vkgz"),m=a("eIep"),f=a("SxV6"),b=a("daFX"),v=a("AytR"),h=a("Xioo"),g=a("1QIV"),x=a("J3qs"),y=a("kGaT"),j=a("iqTE"),O=a("loKC"),S=a("tyNb"),I=a("lI3o"),C=a("sYmb"),w=function(){var n=function(n){l(a,n);var i=p(a);function a(e,t,n,r,c,s){var l;return o(this,a),(l=i.call(this,t,r,c)).itemService=e,l.objectUpdatesService=t,l.router=n,l.notificationsService=r,l.translateService=c,l.route=s,l}return s(a,[{key:"ngOnInit",value:function(){var n=this;Object(x.b)(this.item)?this.setItem(this.item):this.itemUpdateSubscription=Object(c.a)([this.route.data,this.route.parent.data]).pipe(Object(d.a)((function(t){var n=e(t,2),i=n[0],a=n[1];return Object.assign({},i,a)})),Object(d.a)((function(e){return e.dso})),Object(u.a)((function(e){n.item=e.payload})),Object(m.a)((function(e){var i;return(i=n.itemService).findByHref.apply(i,[e.payload._links.self.href,!0,!0].concat(t(y.a)))})),Object(g.c)()).subscribe((function(e){n.setItem(e.payload)})),this.discardTimeOut=v.a.item.edit.undoTimeout,this.url=this.router.url,this.url.indexOf("?")>0&&(this.url=this.url.substr(0,this.url.indexOf("?"))),this.hasChanges().pipe(Object(f.a)()).subscribe((function(e){e?n.checkLastModified():n.initializeOriginalFields()})),this.initializeNotificationsPrefix(),this.initializeUpdates()}},{key:"setItem",value:function(e){this.item=e,this.itemPageRoute=Object(h.h)(this.item),this.postItemInit(),this.initializeUpdates()}},{key:"ngOnDestroy",value:function(){Object(x.b)(this.itemUpdateSubscription)&&this.itemUpdateSubscription.unsubscribe()}},{key:"postItemInit",value:function(){}},{key:"initializeUpdates",value:function(){}},{key:"initializeNotificationsPrefix",value:function(){}},{key:"initializeOriginalFields",value:function(){}},{key:"submit",value:function(){}},{key:"trackUpdate",value:function(e,t){return t&&t.field?t.field.uuid:void 0}},{key:"isValid",value:function(){return this.objectUpdatesService.isValidPage(this.url)}},{key:"checkLastModified",value:function(){var e=this,t=this.item.lastModified;this.objectUpdatesService.getLastModified(this.url).pipe(Object(f.a)()).subscribe((function(n){n.getDate()!==t.getDate()&&(e.notificationsService.warning(e.getNotificationTitle("outdated"),e.getNotificationContent("outdated")),e.initializeOriginalFields())}))}}]),a}(b.a);return n.\u0275fac=function(e){return new(e||n)(r["\u0275\u0275directiveInject"](j.a),r["\u0275\u0275directiveInject"](O.a),r["\u0275\u0275directiveInject"](S.h),r["\u0275\u0275directiveInject"](I.a),r["\u0275\u0275directiveInject"](C.e),r["\u0275\u0275directiveInject"](S.a))},n.\u0275cmp=r["\u0275\u0275defineComponent"]({type:n,selectors:[["ds-abstract-item-update"]],inputs:{item:"item"},features:[r["\u0275\u0275InheritDefinitionFeature"]],decls:0,vars:0,template:function(e,t){},encapsulation:2}),n}()},HENg:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n("1QIV"),a=n("lJxs"),r=n("J3qs"),c=function(e){l(n,e);var t=p(n);function n(e,i,a,r){var c;return o(this,n),(c=t.call(this,i,a,r)).resolver=e,c.authorizationService=i,c.router=a,c.authService=r,c}return s(n,[{key:"getObjectUrl",value:function(e,t){var n=this.getRouteWithDSOId(e);return this.resolver.resolve(n,t).pipe(Object(i.d)(),Object(a.a)((function(e){return e.self})))}},{key:"getRouteWithDSOId",value:function(e){for(var t=e;Object(r.a)(t.params.id)&&Object(r.b)(t.parent);)t=t.parent;return t}}]),n}(n("a8lL").a)},ONIj:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n("fXoL"),a=n("JTKQ");function r(e,t){}var c=function(){var e=function(e){l(i,e);var t=p(i);function i(){return o(this,i),t.apply(this,arguments)}return s(i,[{key:"getComponentName",value:function(){return"SearchPageComponent"}},{key:"importThemedComponent",value:function(e){return n("VxFp")("./".concat(e,"/app/search-page/search-page.component"))}},{key:"importUnthemedComponent",value:function(){return Promise.resolve().then(n.bind(null,"xSRh"))}}]),i}(a.a);return e.\u0275fac=function(t){return d(t||e)},e.\u0275cmp=i["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-themed-search-page"]],features:[i["\u0275\u0275InheritDefinitionFeature"]],decls:3,vars:0,consts:[["vcr",""]],template:function(e,t){1&e&&(i["\u0275\u0275template"](0,r,0,0,"ng-template",null,0,i["\u0275\u0275templateRefExtractor"]),i["\u0275\u0275text"](2,"\n"))},encapsulation:2}),e}(),d=i["\u0275\u0275getInheritedFactory"](c)},TrCT:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var i=n("fXoL"),a=n("eIep"),r=n("lJxs"),c=n("9H8w"),d=n("dtp9"),u=n("joI/"),m=n("1QIV"),f=n("gWc+"),b=n("7LZ0"),v=n("14tD"),h=n("ppE2"),g=n("wQXg"),x=n("tyNb"),y=function(){var e=function(e){l(n,e);var t=p(n);function n(e,i,a,r,c,s,l){var d;return o(this,n),(d=t.call(this,e,i,a,r,c,l)).service=e,d.sidebarService=i,d.windowService=a,d.searchConfigService=r,d.routeService=c,d.angulartics2=s,d.router=l,d}return s(n,[{key:"ngOnInit",value:function(){var e=this;this.getSearchOptions().pipe(Object(a.a)((function(t){return e.service.searchEntries(t).pipe(Object(m.i)(),Object(r.a)((function(e){return{config:t,searchQueryResponse:e.payload}})))}))).subscribe((function(t){for(var n=t.config,i=t.searchQueryResponse,a=[],r=i.appliedFilters||[],o=0,c=r.length;o<c;o++)a.push(r[o]);e.angulartics2.eventTrack.next({action:"search",properties:{searchOptions:n,page:{size:n.pagination.size,totalElements:i.pageInfo.totalElements,totalPages:i.pageInfo.totalPages,number:n.pagination.currentPage},sort:{by:n.sort.field,order:n.sort.direction},filters:a}})}))}}]),n}(c.a);return e.\u0275fac=function(t){return new(t||e)(i["\u0275\u0275directiveInject"](f.a),i["\u0275\u0275directiveInject"](b.a),i["\u0275\u0275directiveInject"](v.a),i["\u0275\u0275directiveInject"](d.SEARCH_CONFIG_SERVICE),i["\u0275\u0275directiveInject"](h.a),i["\u0275\u0275directiveInject"](g.b),i["\u0275\u0275directiveInject"](x.h))},e.\u0275cmp=i["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-search-tracker"]],features:[i["\u0275\u0275ProvidersFeature"]([{provide:d.SEARCH_CONFIG_SERVICE,useClass:u.a}]),i["\u0275\u0275InheritDefinitionFeature"]],decls:1,vars:0,template:function(e,t){1&e&&i["\u0275\u0275text"](0,"\xa0\n")},styles:["[_nghost-%COMP%]{display:none}"]}),e}()},VxFp:function(e,t,n){var i={"./custom/app/search-page/search-page.component":["Bvb0",73]};function a(e){if(!n.o(i,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=i[e],a=t[0];return n.e(t[1]).then((function(){return n(a)}))}a.keys=function(){return Object.keys(i)},a.id="VxFp",e.exports=a},hucJ:function(e,n,i){"use strict";i.d(n,"a",(function(){return u}));var a=i("fXoL"),r=i("1QIV"),c=i("lJxs"),l=i("J3qs"),d=i("GCaJ"),p=i("h5qW"),u=function(){var e=function(){function e(t,n){o(this,e),this.breadcrumbService=t,this.dataService=n}return s(e,[{key:"resolve",value:function(e,n){var i,a=this,o=e.params.id;return(i=this.dataService).findById.apply(i,[o,!0,!1].concat(t(this.followLinks))).pipe(Object(r.g)(),Object(r.o)(),Object(c.a)((function(e){if(Object(l.b)(e)){var t=n.url,i=t.substr(0,t.indexOf(o))+o;return{provider:a.breadcrumbService,key:e,url:i}}})))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(a["\u0275\u0275inject"](d.a),a["\u0275\u0275inject"](p.a))},e.\u0275prov=a["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()},iprd:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var i=n("fXoL"),a=n("ofXK"),r=n("pKmL"),c=n("PCNd"),s=n("7LZ0"),l=n("0qhl"),d=(n("TrCT"),n("9i+i")),p=(n("xSRh"),n("2XvB")),u=n("kesd"),m=n("joI/"),f=n("N0eT"),b=n("udvk"),v=(n("ONIj"),n("kMeL")),h=function(){var e=function e(){o(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=i["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=i["\u0275\u0275defineInjector"]({providers:[s.a,p.a,u.c,l.a,m.a],imports:[[a.c,v.a,c.a.withEntryComponents(),r.a.forRoot(),d.a.forRoot(),f.a.withEntryComponents(),b.a.withEntryComponents()]]}),e}()},kGaT:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return m}));var i=n("fXoL"),a=n("84Zn"),r=n("1QIV"),c=n("8jtY"),l=n("iqTE"),d=n("l7P3"),p=n("tyNb"),u=[Object(a.a)("owningCollection",{},Object(a.a)("parentCommunity",{},Object(a.a)("parentCommunity"))),Object(a.a)("relationships"),Object(a.a)("version",{},Object(a.a)("versionhistory")),Object(a.a)("thumbnail")],m=function(){var e=function(){function e(t,n,i){o(this,e),this.itemService=t,this.store=n,this.router=i}return s(e,[{key:"resolve",value:function(e,t){var n,i=this,a=(n=this.itemService).findById.apply(n,[e.params.id,!0,!1].concat(u)).pipe(Object(r.g)());return a.subscribe((function(e){i.store.dispatch(new c.a(t.url,e.payload))})),a}}]),e}();return e.\u0275fac=function(t){return new(t||e)(i["\u0275\u0275inject"](l.a),i["\u0275\u0275inject"](d.i),i["\u0275\u0275inject"](p.h))},e.\u0275prov=i["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac}),e}()},mOAm:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var i=n("zZO8"),a=n("TVZh"),r="groups";function o(e){return new i.a(Object(a.m)(),r,e).toString()}},mo41:function(e,t,n){"use strict";n.d(t,"a",(function(){return T}));var i=n("fXoL"),a=n("1QIV"),r=n("J3qs"),c=n("LvDl"),l=n("2Vo4"),d=n("LRne"),p=n("lJxs"),u=n("X8f1"),m=n("84Zn"),f=n("Y6Ni"),b=n("loKC"),v=n("ofXK"),h=n("8pnQ"),g=n("aojn"),x=n("3Pt+"),y=n("awfb"),j=n("jOLk"),O=n("sYmb"),S=["ds-edit-in-place-field",""];function I(e,t){if(1&e&&(i["\u0275\u0275elementStart"](0,"div"),i["\u0275\u0275text"](1,"\n            "),i["\u0275\u0275elementStart"](2,"span"),i["\u0275\u0275text"](3),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](4,"\n        "),i["\u0275\u0275elementEnd"]()),2&e){var n=i["\u0275\u0275nextContext"]();i["\u0275\u0275advance"](3),i["\u0275\u0275textInterpolate"](null==n.metadata||null==n.metadata.key?null:n.metadata.key.split(".").join(".\u200b"))}}var C=function(){return{standalone:!0}};function w(e,t){if(1&e){var n=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"div",15),i["\u0275\u0275text"](1,"\n            "),i["\u0275\u0275elementStart"](2,"ds-validation-suggestions",16,17),i["\u0275\u0275listener"]("ngModelChange",(function(e){return i["\u0275\u0275restoreView"](n),i["\u0275\u0275nextContext"]().metadata.key=e}))("submitSuggestion",(function(){i["\u0275\u0275restoreView"](n);var e=i["\u0275\u0275reference"](3);return i["\u0275\u0275nextContext"]().update(e)}))("clickSuggestion",(function(){i["\u0275\u0275restoreView"](n);var e=i["\u0275\u0275reference"](3);return i["\u0275\u0275nextContext"]().update(e)}))("typeSuggestion",(function(){i["\u0275\u0275restoreView"](n);var e=i["\u0275\u0275reference"](3);return i["\u0275\u0275nextContext"]().update(e)}))("dsClickOutside",(function(){i["\u0275\u0275restoreView"](n);var e=i["\u0275\u0275reference"](3);return i["\u0275\u0275nextContext"]().checkValidity(e)}))("findSuggestions",(function(e){return i["\u0275\u0275restoreView"](n),i["\u0275\u0275nextContext"]().findMetadataFieldSuggestions(e)})),i["\u0275\u0275pipe"](4,"async"),i["\u0275\u0275pipe"](5,"async"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](6,"\n        "),i["\u0275\u0275elementEnd"]()}if(2&e){var a=i["\u0275\u0275nextContext"]();i["\u0275\u0275advance"](2),i["\u0275\u0275property"]("disable",1!=a.fieldUpdate.changeType)("suggestions",i["\u0275\u0275pipeBind1"](4,7,a.metadataFieldSuggestions))("ngModel",a.metadata.key)("url",a.url)("metadata",a.metadata)("valid",!1!==i["\u0275\u0275pipeBind1"](5,9,a.valid))("ngModelOptions",i["\u0275\u0275pureFunction0"](11,C))}}function k(e,t){1&e&&(i["\u0275\u0275elementStart"](0,"small",18),i["\u0275\u0275text"](1),i["\u0275\u0275pipe"](2,"translate"),i["\u0275\u0275elementEnd"]()),2&e&&(i["\u0275\u0275advance"](1),i["\u0275\u0275textInterpolate"](i["\u0275\u0275pipeBind1"](2,1,"item.edit.metadata.metadatafield.invalid")))}function E(e,t){if(1&e&&(i["\u0275\u0275elementStart"](0,"div"),i["\u0275\u0275text"](1,"\n            "),i["\u0275\u0275elementStart"](2,"span",19),i["\u0275\u0275text"](3),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](4,"\n        "),i["\u0275\u0275elementEnd"]()),2&e){var n=i["\u0275\u0275nextContext"]();i["\u0275\u0275advance"](3),i["\u0275\u0275textInterpolate"](null==n.metadata?null:n.metadata.value)}}function M(e,t){if(1&e){var n=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"div",15),i["\u0275\u0275text"](1,"\n            "),i["\u0275\u0275elementStart"](2,"textarea",20),i["\u0275\u0275listener"]("ngModelChange",(function(e){return i["\u0275\u0275restoreView"](n),i["\u0275\u0275nextContext"]().metadata.value=e}))("onDebounce",(function(){return i["\u0275\u0275restoreView"](n),i["\u0275\u0275nextContext"]().update()})),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](3,"\n        "),i["\u0275\u0275elementEnd"]()}if(2&e){var a=i["\u0275\u0275nextContext"]();i["\u0275\u0275advance"](2),i["\u0275\u0275property"]("ngModel",a.metadata.value)}}function B(e,t){if(1&e&&(i["\u0275\u0275elementStart"](0,"div"),i["\u0275\u0275text"](1,"\n            "),i["\u0275\u0275elementStart"](2,"span"),i["\u0275\u0275text"](3),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](4,"\n        "),i["\u0275\u0275elementEnd"]()),2&e){var n=i["\u0275\u0275nextContext"]();i["\u0275\u0275advance"](3),i["\u0275\u0275textInterpolate"](null==n.metadata?null:n.metadata.language)}}function V(e,t){if(1&e){var n=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"div",15),i["\u0275\u0275text"](1,"\n            "),i["\u0275\u0275elementStart"](2,"input",21),i["\u0275\u0275listener"]("ngModelChange",(function(e){return i["\u0275\u0275restoreView"](n),i["\u0275\u0275nextContext"]().metadata.language=e}))("onDebounce",(function(){return i["\u0275\u0275restoreView"](n),i["\u0275\u0275nextContext"]().update()})),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](3,"\n        "),i["\u0275\u0275elementEnd"]()}if(2&e){var a=i["\u0275\u0275nextContext"]();i["\u0275\u0275advance"](2),i["\u0275\u0275property"]("ngModel",a.metadata.language)}}function R(e,t){if(1&e){var n=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"button",22),i["\u0275\u0275listener"]("click",(function(){return i["\u0275\u0275restoreView"](n),i["\u0275\u0275nextContext"]().setEditable(!0)})),i["\u0275\u0275pipe"](1,"async"),i["\u0275\u0275pipe"](2,"translate"),i["\u0275\u0275text"](3,"\n            "),i["\u0275\u0275element"](4,"i",23),i["\u0275\u0275text"](5,"\n        "),i["\u0275\u0275elementEnd"]()}if(2&e){var a=i["\u0275\u0275nextContext"]();i["\u0275\u0275propertyInterpolate"]("title",i["\u0275\u0275pipeBind1"](2,4,"item.edit.metadata.edit.buttons.edit")),i["\u0275\u0275property"]("disabled",!i["\u0275\u0275pipeBind1"](1,2,a.canSetEditable()))}}function P(e,t){if(1&e){var n=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"button",24),i["\u0275\u0275listener"]("click",(function(){return i["\u0275\u0275restoreView"](n),i["\u0275\u0275nextContext"]().setEditable(!1)})),i["\u0275\u0275pipe"](1,"async"),i["\u0275\u0275pipe"](2,"async"),i["\u0275\u0275pipe"](3,"translate"),i["\u0275\u0275text"](4,"\n            "),i["\u0275\u0275element"](5,"i",25),i["\u0275\u0275text"](6,"\n        "),i["\u0275\u0275elementEnd"]()}if(2&e){var a=i["\u0275\u0275nextContext"]();i["\u0275\u0275propertyInterpolate"]("title",i["\u0275\u0275pipeBind1"](3,6,"item.edit.metadata.edit.buttons.unedit")),i["\u0275\u0275property"]("disabled",!i["\u0275\u0275pipeBind1"](1,2,a.canSetUneditable())||!1===i["\u0275\u0275pipeBind1"](2,4,a.valid))}}var T=function(){var e=function(){function e(t,n){o(this,e),this.registryService=t,this.objectUpdatesService=n,this.metadataFieldSuggestions=new l.a([])}return s(e,[{key:"ngOnInit",value:function(){this.editable=this.objectUpdatesService.isEditable(this.url,this.metadata.uuid),this.valid=this.objectUpdatesService.isValid(this.url,this.metadata.uuid)}},{key:"update",value:function(e){this.objectUpdatesService.saveChangeFieldUpdate(this.url,Object(c.cloneDeep)(this.metadata)),Object(r.b)(e)&&this.checkValidity(e)}},{key:"checkValidity",value:function(e){e.control.setValue(e.viewModel),e.control.updateValueAndValidity(),this.objectUpdatesService.setValidFieldUpdate(this.url,this.metadata.uuid,e.control.valid)}},{key:"setEditable",value:function(e){this.objectUpdatesService.setEditableFieldUpdate(this.url,this.metadata.uuid,e)}},{key:"remove",value:function(){this.objectUpdatesService.saveRemoveFieldUpdate(this.url,Object(c.cloneDeep)(this.metadata))}},{key:"removeChangesFromField",value:function(){this.objectUpdatesService.removeSingleFieldUpdate(this.url,this.metadata.uuid)}},{key:"ngOnChanges",value:function(){this.metadata=Object(c.cloneDeep)(this.fieldUpdate.field)}},{key:"findMetadataFieldSuggestions",value:function(e){var t=this;if(Object(r.e)(e))return this.registryService.queryMetadataFields(e,null,!0,!1,Object(m.a)("schema")).pipe(Object(a.i)(),Object(a.r)()).subscribe((function(e){t.setInputSuggestions(e)}));this.metadataFieldSuggestions.next([])}},{key:"setInputSuggestions",value:function(e){this.metadataFieldSuggestions.next(e.map((function(e){return{displayValue:e.split(".").join(".&#8203;"),value:e}})))}},{key:"canSetEditable",value:function(){var e=this;return this.editable.pipe(Object(p.a)((function(t){return!t&&e.fieldUpdate.changeType!==u.c.REMOVE})))}},{key:"canSetUneditable",value:function(){return this.editable}},{key:"canRemove",value:function(){return Object(d.a)(this.fieldUpdate.changeType!==u.c.REMOVE&&this.fieldUpdate.changeType!==u.c.ADD)}},{key:"canUndo",value:function(){var e=this;return this.editable.pipe(Object(p.a)((function(t){return e.fieldUpdate.changeType>=0||t})))}},{key:"isNotEmpty",value:function(e){return Object(r.e)(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(i["\u0275\u0275directiveInject"](f.a),i["\u0275\u0275directiveInject"](b.a))},e.\u0275cmp=i["\u0275\u0275defineComponent"]({type:e,selectors:[["","ds-edit-in-place-field",""]],inputs:{fieldUpdate:"fieldUpdate",url:"url",metadata:"metadata"},features:[i["\u0275\u0275NgOnChangesFeature"]],attrs:S,decls:65,vars:39,consts:[[1,"metadata-field"],[4,"ngIf"],["class","field-container",4,"ngIf"],["class","text-danger",4,"ngIf"],[1,"w-100"],[1,"value-field"],[1,"text-center"],[1,"language-field"],[1,"btn-group","edit-field"],["class","btn btn-outline-primary btn-sm",3,"disabled","title","click",4,"ngIf"],["class","btn btn-outline-success btn-sm",3,"disabled","title","click",4,"ngIf"],[1,"btn","btn-outline-danger","btn-sm",3,"disabled","title","click"],[1,"fas","fa-trash-alt","fa-fw"],[1,"btn","btn-outline-warning","btn-sm",3,"disabled","title","click"],[1,"fas","fa-undo-alt","fa-fw"],[1,"field-container"],["dsAutoFocus","","autoFocusSelector",".suggestion_input",3,"disable","suggestions","ngModel","url","metadata","valid","ngModelOptions","ngModelChange","submitSuggestion","clickSuggestion","typeSuggestion","dsClickOutside","findSuggestions"],["suggestionControl","ngModel"],[1,"text-danger"],[1,"dont-break-out"],["type","textarea","attr.aria-labelledby","fieldValue",1,"form-control",3,"ngModel","dsDebounce","ngModelChange","onDebounce"],["type","text","attr.aria-labelledby","fieldLang",1,"form-control",3,"ngModel","dsDebounce","ngModelChange","onDebounce"],[1,"btn","btn-outline-primary","btn-sm",3,"disabled","title","click"],[1,"fas","fa-edit","fa-fw"],[1,"btn","btn-outline-success","btn-sm",3,"disabled","title","click"],[1,"fas","fa-check","fa-fw"]],template:function(e,t){1&e&&(i["\u0275\u0275elementStart"](0,"td"),i["\u0275\u0275text"](1,"\n    "),i["\u0275\u0275elementStart"](2,"div",0),i["\u0275\u0275text"](3,"\n        "),i["\u0275\u0275template"](4,I,5,1,"div",1),i["\u0275\u0275pipe"](5,"async"),i["\u0275\u0275text"](6,"\n        "),i["\u0275\u0275template"](7,w,7,12,"div",2),i["\u0275\u0275pipe"](8,"async"),i["\u0275\u0275text"](9,"\n        "),i["\u0275\u0275template"](10,k,3,3,"small",3),i["\u0275\u0275pipe"](11,"async"),i["\u0275\u0275text"](12,"\n    "),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](13,"\n"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](14,"\n"),i["\u0275\u0275elementStart"](15,"td",4),i["\u0275\u0275text"](16,"\n    "),i["\u0275\u0275elementStart"](17,"div",5),i["\u0275\u0275text"](18,"\n        "),i["\u0275\u0275template"](19,E,5,1,"div",1),i["\u0275\u0275pipe"](20,"async"),i["\u0275\u0275text"](21,"\n        "),i["\u0275\u0275template"](22,M,4,1,"div",2),i["\u0275\u0275pipe"](23,"async"),i["\u0275\u0275text"](24,"\n    "),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](25,"\n"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](26,"\n"),i["\u0275\u0275elementStart"](27,"td",6),i["\u0275\u0275text"](28,"\n    "),i["\u0275\u0275elementStart"](29,"div",7),i["\u0275\u0275text"](30,"\n        "),i["\u0275\u0275template"](31,B,5,1,"div",1),i["\u0275\u0275pipe"](32,"async"),i["\u0275\u0275text"](33,"\n        "),i["\u0275\u0275template"](34,V,4,1,"div",2),i["\u0275\u0275pipe"](35,"async"),i["\u0275\u0275text"](36,"\n    "),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](37,"\n"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](38,"\n"),i["\u0275\u0275elementStart"](39,"td",6),i["\u0275\u0275text"](40,"\n    "),i["\u0275\u0275elementStart"](41,"div",8),i["\u0275\u0275text"](42,"\n        "),i["\u0275\u0275template"](43,R,6,6,"button",9),i["\u0275\u0275pipe"](44,"async"),i["\u0275\u0275text"](45,"\n        "),i["\u0275\u0275template"](46,P,7,8,"button",10),i["\u0275\u0275pipe"](47,"async"),i["\u0275\u0275text"](48,"\n        "),i["\u0275\u0275elementStart"](49,"button",11),i["\u0275\u0275listener"]("click",(function(){return t.remove()})),i["\u0275\u0275pipe"](50,"async"),i["\u0275\u0275pipe"](51,"translate"),i["\u0275\u0275text"](52,"\n            "),i["\u0275\u0275element"](53,"i",12),i["\u0275\u0275text"](54,"\n        "),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](55,"\n        "),i["\u0275\u0275elementStart"](56,"button",13),i["\u0275\u0275listener"]("click",(function(){return t.removeChangesFromField()})),i["\u0275\u0275pipe"](57,"async"),i["\u0275\u0275pipe"](58,"translate"),i["\u0275\u0275text"](59,"\n            "),i["\u0275\u0275element"](60,"i",14),i["\u0275\u0275text"](61,"\n        "),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](62,"\n    "),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](63,"\n"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](64,"\n")),2&e&&(i["\u0275\u0275advance"](4),i["\u0275\u0275property"]("ngIf",!i["\u0275\u0275pipeBind1"](5,13,t.editable)),i["\u0275\u0275advance"](3),i["\u0275\u0275property"]("ngIf",i["\u0275\u0275pipeBind1"](8,15,t.editable)),i["\u0275\u0275advance"](3),i["\u0275\u0275property"]("ngIf",!1===i["\u0275\u0275pipeBind1"](11,17,t.valid)),i["\u0275\u0275advance"](9),i["\u0275\u0275property"]("ngIf",!i["\u0275\u0275pipeBind1"](20,19,t.editable)),i["\u0275\u0275advance"](3),i["\u0275\u0275property"]("ngIf",i["\u0275\u0275pipeBind1"](23,21,t.editable)),i["\u0275\u0275advance"](9),i["\u0275\u0275property"]("ngIf",!i["\u0275\u0275pipeBind1"](32,23,t.editable)),i["\u0275\u0275advance"](3),i["\u0275\u0275property"]("ngIf",i["\u0275\u0275pipeBind1"](35,25,t.editable)),i["\u0275\u0275advance"](9),i["\u0275\u0275property"]("ngIf",!i["\u0275\u0275pipeBind1"](44,27,t.editable)),i["\u0275\u0275advance"](3),i["\u0275\u0275property"]("ngIf",i["\u0275\u0275pipeBind1"](47,29,t.editable)),i["\u0275\u0275advance"](3),i["\u0275\u0275propertyInterpolate"]("title",i["\u0275\u0275pipeBind1"](51,33,"item.edit.metadata.edit.buttons.remove")),i["\u0275\u0275property"]("disabled",!i["\u0275\u0275pipeBind1"](50,31,t.canRemove())),i["\u0275\u0275advance"](7),i["\u0275\u0275propertyInterpolate"]("title",i["\u0275\u0275pipeBind1"](58,37,"item.edit.metadata.edit.buttons.undo")),i["\u0275\u0275property"]("disabled",!i["\u0275\u0275pipeBind1"](57,35,t.canUndo())))},directives:[v.p,h.a,g.a,x.NgControlStatus,x.NgModel,y.a,x.DefaultValueAccessor,j.a],pipes:[v.b,O.d],styles:[".btn[disabled][_ngcontent-%COMP%]{color:var(--bs-gray-600);border-color:var(--bs-gray-600);z-index:0}.metadata-field[_ngcontent-%COMP%]{width:var(--ds-edit-item-metadata-field-width)}.language-field[_ngcontent-%COMP%]{width:var(--ds-edit-item-language-field-width)}"]}),e}()},tv3Y:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n("zr/d"),a=n("LRne"),r=n("fXoL"),c=function(){var e=function(){function e(){o(this,e)}return s(e,[{key:"getBreadcrumbs",value:function(e,t){return Object(a.a)([new i.a(e+".breadcrumbs",t)])}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=r["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()},xSRh:function(e,t,n){"use strict";n.r(t),n.d(t,"SearchPageComponent",(function(){return l}));var i=n("fXoL"),a=n("dtp9"),r=n("joI/"),c=n("9H8w"),s=n("TrCT"),l=function(){var e=function e(){o(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-search-page"]],features:[i["\u0275\u0275ProvidersFeature"]([{provide:a.SEARCH_CONFIG_SERVICE,useClass:r.a}])],decls:4,vars:0,template:function(e,t){1&e&&(i["\u0275\u0275element"](0,"ds-search"),i["\u0275\u0275text"](1,"\n"),i["\u0275\u0275element"](2,"ds-search-tracker"),i["\u0275\u0275text"](3,"\n"))},directives:[c.a,s.a],encapsulation:2}),e}()},"z3/6":function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var i=n("fXoL"),r=n("lJxs"),c=n("J3qs"),d=n("Xioo"),u=n("kGaT"),f=n("iqTE"),b=n("l7P3"),v=n("tyNb"),h=function(){var e=function(e){l(n,e);var t=p(n);function n(e,i,a){var r;return o(this,n),(r=t.call(this,e,i,a)).itemService=e,r.store=i,r.router=a,r}return s(n,[{key:"resolve",value:function(e,t){var i=this;return a(m(n.prototype),"resolve",this).call(this,e,t).pipe(Object(r.a)((function(e){if(e.hasSucceeded&&Object(c.b)(e.payload)){var n=Object(d.h)(e.payload),a=t.url;if(!a.startsWith(n)){var r=e.payload.uuid,o=a.substring(a.indexOf(r)+r.length,a.length);i.router.navigateByUrl(n+o)}}return e})))}}]),n}(u.b);return e.\u0275fac=function(t){return new(t||e)(i["\u0275\u0275inject"](f.a),i["\u0275\u0275inject"](b.i),i["\u0275\u0275inject"](v.h))},e.\u0275prov=i["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac}),e}()},"zr/d":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function e(t,n){o(this,e),this.text=t,this.url=n}}}])}();
//# sourceMappingURL=6-es5.2d6340f7076e2f469218.js.map