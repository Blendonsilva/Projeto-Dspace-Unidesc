(window.webpackJsonp=window.webpackJsonp||[]).push([[9,14],{A0IO:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("fXoL"),o=n("J3qs"),i=n("q5u1"),a=n("tv3Y");let s=(()=>{class e{constructor(e){this.breadcrumbService=e}resolve(e,t){const n=e.data.breadcrumbKey;if(Object(o.a)(n))throw new Error('You provided an i18nBreadcrumbResolver for url "'+e.url+"\" but no breadcrumbKey in the route's data");const r=Object(i.b)(e);return{provider:this.breadcrumbService,key:n,url:r}}}return e.\u0275fac=function(t){return new(t||e)(r["\u0275\u0275inject"](a.a))},e.\u0275prov=r["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},GVwY:function(e,t,n){"use strict";n.r(t),n.d(t,"ProfilePageModule",(function(){return f}));var r=n("fXoL"),o=n("ofXK"),i=n("PCNd"),a=n("tyNb"),s=n("A0IO"),c=n("JTKQ");function l(e,t){}let d=(()=>{class e extends c.a{getComponentName(){return"ProfilePageComponent"}importThemedComponent(e){return n("gG8J")(`./${e}/app/profile-page/profile-page.component`)}importUnthemedComponent(){return Promise.resolve().then(n.bind(null,"wStq"))}}return e.\u0275fac=function(t){return u(t||e)},e.\u0275cmp=r["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-themed-profile-page"]],features:[r["\u0275\u0275InheritDefinitionFeature"]],decls:3,vars:0,consts:[["vcr",""]],template:function(e,t){1&e&&(r["\u0275\u0275template"](0,l,0,0,"ng-template",null,0,r["\u0275\u0275templateRefExtractor"]),r["\u0275\u0275text"](2,"\n"))},encapsulation:2}),e})();const u=r["\u0275\u0275getInheritedFactory"](d);let p=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=r["\u0275\u0275defineInjector"]({imports:[[a.l.forChild([{path:"",pathMatch:"full",component:d,resolve:{breadcrumb:s.a},data:{breadcrumbKey:"profile",title:"profile.title"}}])]]}),e})();n("wStq"),n("ibDM"),n("JKx6");var m=n("kcqd");let f=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=r["\u0275\u0275defineInjector"]({imports:[[p,o.c,i.a,m.a]]}),e})()},JKx6:function(e,t,n){"use strict";n.d(t,"a",(function(){return I}));var r=n("fXoL"),o=n("e+Av"),i=n("J3qs"),a=n("Kj3r"),s=n("lJxs"),c=n("sYmb"),l=n("wLgS"),d=n("lI3o"),u=n("ofXK"),p=n("hqmO"),m=n("3Pt+");function f(e,t){if(1&e&&(r["\u0275\u0275elementStart"](0,"ds-form",5),r["\u0275\u0275text"](1,"\n"),r["\u0275\u0275elementEnd"]()),2&e){const e=r["\u0275\u0275nextContext"]();r["\u0275\u0275property"]("formId",e.FORM_PREFIX)("formModel",e.formModel)("formGroup",e.formGroup)("displaySubmit",!1)("displayCancel",!1)}}function h(e,t){if(1&e&&(r["\u0275\u0275elementStart"](0,"div",6),r["\u0275\u0275text"](1),r["\u0275\u0275pipe"](2,"translate"),r["\u0275\u0275elementEnd"]()),2&e){const e=r["\u0275\u0275nextContext"]();r["\u0275\u0275advance"](1),r["\u0275\u0275textInterpolate"](r["\u0275\u0275pipeBind1"](2,1,e.FORM_PREFIX+"error.password-length"))}}function v(e,t){if(1&e&&(r["\u0275\u0275elementStart"](0,"div",7),r["\u0275\u0275text"](1),r["\u0275\u0275pipe"](2,"translate"),r["\u0275\u0275elementEnd"]()),2&e){const e=r["\u0275\u0275nextContext"]();r["\u0275\u0275advance"](1),r["\u0275\u0275textInterpolate"](r["\u0275\u0275pipeBind1"](2,1,e.FORM_PREFIX+"error.matching-passwords"))}}function g(e,t){if(1&e&&(r["\u0275\u0275elementStart"](0,"div",8),r["\u0275\u0275text"](1),r["\u0275\u0275pipe"](2,"translate"),r["\u0275\u0275elementEnd"]()),2&e){const e=r["\u0275\u0275nextContext"]();r["\u0275\u0275advance"](1),r["\u0275\u0275textInterpolate"](r["\u0275\u0275pipeBind1"](2,1,e.FORM_PREFIX+"error.empty-password"))}}let I=(()=>{class e{constructor(e,t,n,i){this.formService=e,this.translate=t,this.epersonService=n,this.notificationsService=i,this.isInvalid=new r.EventEmitter,this.passwordValue=new r.EventEmitter,this.formModel=[new o.J({id:"password",name:"password",inputType:"password"}),new o.J({id:"passwordrepeat",name:"passwordrepeat",inputType:"password"})],this.passwordCanBeEmpty=!0,this.subs=[]}ngOnInit(){this.formGroup=this.formService.createFormGroup(this.formModel,this.passwordCanBeEmpty?{validators:[this.checkPasswordsEqual,this.checkPasswordLength]}:{validators:[this.checkPasswordsEqual,this.checkPasswordLength,this.checkPasswordEmpty]}),this.updateFieldTranslations(),this.translate.onLangChange.subscribe(()=>{this.updateFieldTranslations()}),this.subs.push(this.formGroup.statusChanges.pipe(Object(a.a)(300),Object(s.a)(e=>"VALID"!==e)).subscribe(e=>this.isInvalid.emit(e))),this.subs.push(this.formGroup.valueChanges.pipe(Object(a.a)(300)).subscribe(e=>{this.passwordValue.emit(e.password)}))}updateFieldTranslations(){this.formModel.forEach(e=>{e.label=this.translate.instant(this.FORM_PREFIX+"label."+e.id)})}checkPasswordsEqual(e){return e.get("password").value===e.get("passwordrepeat").value?null:{notSame:!0}}checkPasswordLength(e){const t=e.get("password").value;return Object(i.d)(t)||t.length>=6?null:{notLongEnough:!0}}checkPasswordEmpty(e){const t=e.get("password").value;return Object(i.d)(t)?{emptyPassword:!0}:null}ngOnDestroy(){this.subs.filter(e=>Object(i.b)(e)).forEach(e=>e.unsubscribe())}}return e.\u0275fac=function(t){return new(t||e)(r["\u0275\u0275directiveInject"](o.G),r["\u0275\u0275directiveInject"](c.e),r["\u0275\u0275directiveInject"](l.a),r["\u0275\u0275directiveInject"](d.a))},e.\u0275cmp=r["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-profile-page-security-form"]],inputs:{passwordCanBeEmpty:"passwordCanBeEmpty",FORM_PREFIX:"FORM_PREFIX"},outputs:{isInvalid:"isInvalid",passwordValue:"passwordValue"},decls:12,vars:7,consts:[[1,"container-fluid","mb-4"],[3,"formId","formModel","formGroup","displaySubmit","displayCancel",4,"ngIf"],["id","notLongEnough","class","container-fluid text-danger",4,"ngIf"],["id","notSame","class","container-fluid text-danger",4,"ngIf"],["id","emptyPassword","class","container-fluid text-danger",4,"ngIf"],[3,"formId","formModel","formGroup","displaySubmit","displayCancel"],["id","notLongEnough",1,"container-fluid","text-danger"],["id","notSame",1,"container-fluid","text-danger"],["id","emptyPassword",1,"container-fluid","text-danger"]],template:function(e,t){1&e&&(r["\u0275\u0275elementStart"](0,"div",0),r["\u0275\u0275text"](1),r["\u0275\u0275pipe"](2,"translate"),r["\u0275\u0275elementEnd"](),r["\u0275\u0275text"](3,"\n"),r["\u0275\u0275template"](4,f,2,5,"ds-form",1),r["\u0275\u0275text"](5,"\n"),r["\u0275\u0275template"](6,h,3,3,"div",2),r["\u0275\u0275text"](7,"\n"),r["\u0275\u0275template"](8,v,3,3,"div",3),r["\u0275\u0275text"](9,"\n"),r["\u0275\u0275template"](10,g,3,3,"div",4),r["\u0275\u0275text"](11,"\n")),2&e&&(r["\u0275\u0275advance"](1),r["\u0275\u0275textInterpolate"](r["\u0275\u0275pipeBind1"](2,5,t.FORM_PREFIX+"info")),r["\u0275\u0275advance"](3),r["\u0275\u0275property"]("ngIf",t.formModel),r["\u0275\u0275advance"](2),r["\u0275\u0275property"]("ngIf",t.formGroup.hasError("notLongEnough")),r["\u0275\u0275advance"](2),r["\u0275\u0275property"]("ngIf",t.formGroup.hasError("notSame")),r["\u0275\u0275advance"](2),r["\u0275\u0275property"]("ngIf",(t.formGroup.dirty||t.formGroup.touched)&&t.formGroup.hasError("emptyPassword")))},directives:[u.p,p.a,m.NgControlStatusGroup,m.FormGroupDirective],pipes:[c.d],encapsulation:2}),e})()},gG8J:function(e,t,n){var r={"./custom/app/profile-page/profile-page.component":["qgOg",69]};function o(e){if(!n.o(r,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=r[e],o=t[0];return n.e(t[1]).then((function(){return n(o)}))}o.keys=function(){return Object.keys(r)},o.id="gG8J",e.exports=o},ibDM:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var r=n("fXoL"),o=n("e+Av"),i=n("J3qs"),a=n("LvDl"),s=n("1QIV"),c=n("AytR"),l=n("Q5/L"),d=n("sYmb"),u=n("wLgS"),p=n("lI3o"),m=n("ofXK"),f=n("hqmO"),h=n("3Pt+");function v(e,t){if(1&e&&(r["\u0275\u0275elementStart"](0,"ds-form",1),r["\u0275\u0275text"](1,"\n"),r["\u0275\u0275elementEnd"]()),2&e){const e=r["\u0275\u0275nextContext"]();r["\u0275\u0275property"]("formId","profile-page-metadata-form-id")("formModel",e.formModel)("formGroup",e.formGroup)("displaySubmit",!1)("displayCancel",!1)}}let g=(()=>{class e{constructor(e,t,n,r){this.formBuilderService=e,this.translate=t,this.epersonService=n,this.notificationsService=r,this.formModel=[new o.J({id:"email",name:"email",readOnly:!0}),new o.J({id:"firstname",name:"eperson.firstname",required:!0,validators:{required:null},errorMessages:{required:"This field is required"}}),new o.J({id:"lastname",name:"eperson.lastname",required:!0,validators:{required:null},errorMessages:{required:"This field is required"}}),new o.J({id:"phone",name:"eperson.phone"}),new o.N({id:"language",name:"eperson.language"})],this.LABEL_PREFIX="profile.metadata.form.label.",this.ERROR_PREFIX="profile.metadata.form.error.",this.NOTIFICATION_PREFIX="profile.metadata.form.notifications."}ngOnInit(){this.activeLangs=c.a.languages.filter(e=>!0===e.active),this.setFormValues(),this.updateFieldTranslations(),this.translate.onLangChange.subscribe(()=>{this.updateFieldTranslations()})}setFormValues(){this.formModel.forEach(e=>{e.value="email"===e.name?this.user.email:this.user.firstMetadataValue(e.name),"language"===e.id&&(e.options=this.activeLangs.map(e=>Object.assign({value:e.code,label:e.label})))}),this.formGroup=this.formBuilderService.createFormGroup(this.formModel)}updateFieldTranslations(){this.formModel.forEach(e=>{e.label=this.translate.instant(this.LABEL_PREFIX+e.id),Object(i.e)(e.validators)&&(e.errorMessages={},Object.keys(e.validators).forEach(t=>{e.errorMessages[t]=this.translate.instant(this.ERROR_PREFIX+e.id+"."+t)}))})}updateProfile(){if(!this.formGroup.valid)return!1;const e=Object(a.cloneDeep)(this.user.metadata);let t=!1;return this.formModel.filter(e=>"email"!==e.id).forEach(n=>{e.hasOwnProperty(n.name)&&e[n.name].length>0?Object(i.b)(n.value)?e[n.name][0].value!==n.value&&(e[n.name][0].value=n.value,t=!0):(e[n.name]=[],t=!0):Object(i.b)(n.value)&&(e[n.name]=[{value:n.value,language:null}],t=!0)}),t&&this.epersonService.update(Object.assign(Object(a.cloneDeep)(this.user),{metadata:e})).pipe(Object(s.i)(),Object(s.o)()).subscribe(e=>{this.user=e,this.setFormValues(),this.notificationsService.success(this.translate.instant(this.NOTIFICATION_PREFIX+"success.title"),this.translate.instant(this.NOTIFICATION_PREFIX+"success.content"))}),t}}return e.\u0275fac=function(t){return new(t||e)(r["\u0275\u0275directiveInject"](l.a),r["\u0275\u0275directiveInject"](d.e),r["\u0275\u0275directiveInject"](u.a),r["\u0275\u0275directiveInject"](p.a))},e.\u0275cmp=r["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-profile-page-metadata-form"]],inputs:{user:"user"},decls:2,vars:1,consts:[[3,"formId","formModel","formGroup","displaySubmit","displayCancel",4,"ngIf"],[3,"formId","formModel","formGroup","displaySubmit","displayCancel"]],template:function(e,t){1&e&&(r["\u0275\u0275template"](0,v,2,5,"ds-form",0),r["\u0275\u0275text"](1,"\n")),2&e&&r["\u0275\u0275property"]("ngIf",t.formModel)},directives:[m.p,f.a,h.NgControlStatusGroup,h.FormGroupDirective],encapsulation:2}),e})()},kcqd:function(e,t,n){"use strict";n.d(t,"a",(function(){return I}));var r=n("fXoL"),o=n("ofXK"),i=n("hqmO"),a=n("e+Av"),s=n("NvTF");function c(e,t){if(1&e){const e=r["\u0275\u0275getCurrentView"]();r["\u0275\u0275elementStart"](0,"ds-dynamic-form-control-container",1),r["\u0275\u0275listener"]("dfBlur",(function(t){r["\u0275\u0275restoreView"](e);const n=r["\u0275\u0275nextContext"]();return n.onCustomEvent(t,n.blur)}))("dfChange",(function(t){r["\u0275\u0275restoreView"](e);const n=r["\u0275\u0275nextContext"]();return n.onCustomEvent(t,n.change)}))("dfFocus",(function(t){r["\u0275\u0275restoreView"](e);const n=r["\u0275\u0275nextContext"]();return n.onCustomEvent(t,n.focus)}))("ngbEvent",(function(t){r["\u0275\u0275restoreView"](e);const n=r["\u0275\u0275nextContext"]();return n.onCustomEvent(t,n.ngbEvent)})),r["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,n=r["\u0275\u0275nextContext"]();r["\u0275\u0275property"]("formId",n.formId)("group",n.formGroup)("hasErrorMessaging",e.hasErrorMessages)("hidden",e.hidden)("layout",n.formLayout)("model",e)("templates",n.templates)("asBootstrapFormGroup",!0)}}let l=(()=>{class e extends a.x{constructor(e,t){super(e,t),this.blur=new r.EventEmitter,this.change=new r.EventEmitter,this.focus=new r.EventEmitter,this.ngbEvent=new r.EventEmitter}}return e.\u0275fac=function(t){return new(t||e)(r["\u0275\u0275directiveInject"](r.ChangeDetectorRef),r["\u0275\u0275directiveInject"](a.y))},e.\u0275cmp=r["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-dynamic-form"]],contentQueries:function(e,t,n){if(1&e&&r["\u0275\u0275contentQuery"](n,a.O,0),2&e){let e;r["\u0275\u0275queryRefresh"](e=r["\u0275\u0275loadQuery"]())&&(t.templates=e)}},viewQuery:function(e,t){if(1&e&&r["\u0275\u0275viewQuery"](s.a,1),2&e){let e;r["\u0275\u0275queryRefresh"](e=r["\u0275\u0275loadQuery"]())&&(t.components=e)}},inputs:{formId:"formId",formGroup:"formGroup",formModel:"formModel",formLayout:"formLayout"},outputs:{blur:"dfBlur",change:"dfChange",focus:"dfFocus",ngbEvent:"ngbEvent"},features:[r["\u0275\u0275InheritDefinitionFeature"]],decls:2,vars:2,consts:[[3,"formId","group","hasErrorMessaging","hidden","layout","model","templates","asBootstrapFormGroup","dfBlur","dfChange","dfFocus","ngbEvent",4,"ngFor","ngForOf","ngForTrackBy"],[3,"formId","group","hasErrorMessaging","hidden","layout","model","templates","asBootstrapFormGroup","dfBlur","dfChange","dfFocus","ngbEvent"]],template:function(e,t){1&e&&(r["\u0275\u0275template"](0,c,1,8,"ds-dynamic-form-control-container",0),r["\u0275\u0275text"](1,"\n")),2&e&&r["\u0275\u0275property"]("ngForOf",t.formModel)("ngForTrackBy",t.trackByFn)},directives:[o.o,s.a],encapsulation:2}),e})();n("ZO65"),n("0pnk"),n("sw+l"),n("1Pbu"),n("bPV6"),n("Gu/b"),n("A/iK"),n("KKO+"),n("Ysrn");var d=n("tqJZ"),u=n("ZTun"),p=(n("uyTL"),n("Ui2r"),n("8HnP"),n("zVKZ"),n("PCNd")),m=n("sYmb"),f=n("kMeL"),h=(n("yXJd"),n("/Vzl"),n("zGzN"),n("xjoE"),n("n7Wa")),v=n("3Pt+"),g=n("5+WD");let I=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=r["\u0275\u0275defineInjector"]({providers:[{provide:a.c,useValue:s.b}],imports:[[o.c,a.I,h.a,f.a,p.a,m.c]]}),e})();r["\u0275\u0275setComponentScope"](d.a,[v.NgControlStatusGroup,v.FormGroupDirective,v.FormGroupName,o.m,o.o,s.a],[]),r["\u0275\u0275setComponentScope"](u.a,[v.NgControlStatusGroup,v.FormGroupDirective,v.FormArrayName,o.m,g.c,o.o,g.a,g.b,v.FormGroupName,o.t,s.a],[]),r["\u0275\u0275setComponentScope"](i.a,[v["\u0275angular_packages_forms_forms_ba"],v.NgControlStatusGroup,v.FormGroupDirective,l,a.O,o.p],[m.d,o.b])},tv3Y:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("zr/d"),o=n("LRne"),i=n("fXoL");let a=(()=>{class e{getBreadcrumbs(e,t){return Object(o.a)([new r.a(e+".breadcrumbs",t)])}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=i["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},wStq:function(e,t,n){"use strict";n.r(t),n.d(t,"ProfilePageComponent",(function(){return F}));var r=n("fXoL"),o=n("ibDM"),i=n("pLZG"),a=n("eIep"),s=n("vkgz"),c=n("1QIV"),l=n("J3qs"),d=n("84Zn"),u=n("FU+A"),p=n("Vurf"),m=n("lI3o"),f=n("sYmb"),h=n("wLgS"),v=n("1mcE"),g=n("O/5o"),I=n("ofXK"),b=n("JKx6");function y(e,t){if(1&e){const e=r["\u0275\u0275getCurrentView"]();r["\u0275\u0275elementStart"](0,"div",12),r["\u0275\u0275text"](1,"\n      "),r["\u0275\u0275elementStart"](2,"div",5),r["\u0275\u0275text"](3),r["\u0275\u0275pipe"](4,"translate"),r["\u0275\u0275elementEnd"](),r["\u0275\u0275text"](5,"\n      "),r["\u0275\u0275elementStart"](6,"div",6),r["\u0275\u0275text"](7,"\n        "),r["\u0275\u0275elementStart"](8,"ds-profile-page-security-form",13),r["\u0275\u0275listener"]("isInvalid",(function(t){return r["\u0275\u0275restoreView"](e),r["\u0275\u0275nextContext"](3).setInvalid(t)}))("passwordValue",(function(t){return r["\u0275\u0275restoreView"](e),r["\u0275\u0275nextContext"](3).setPasswordValue(t)})),r["\u0275\u0275elementEnd"](),r["\u0275\u0275text"](9,"\n      "),r["\u0275\u0275elementEnd"](),r["\u0275\u0275text"](10,"\n    "),r["\u0275\u0275elementEnd"]()}2&e&&(r["\u0275\u0275advance"](3),r["\u0275\u0275textInterpolate"](r["\u0275\u0275pipeBind1"](4,2,"profile.card.security")),r["\u0275\u0275advance"](5),r["\u0275\u0275property"]("FORM_PREFIX","profile.security.form."))}function x(e,t){if(1&e&&(r["\u0275\u0275elementStart"](0,"li",18),r["\u0275\u0275text"](1),r["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;r["\u0275\u0275advance"](1),r["\u0275\u0275textInterpolate"](e.name)}}function E(e,t){if(1&e&&(r["\u0275\u0275elementStart"](0,"div"),r["\u0275\u0275text"](1,"\n        "),r["\u0275\u0275elementStart"](2,"h3",15),r["\u0275\u0275text"](3),r["\u0275\u0275pipe"](4,"translate"),r["\u0275\u0275elementEnd"](),r["\u0275\u0275text"](5,"\n        "),r["\u0275\u0275elementStart"](6,"ul",16),r["\u0275\u0275text"](7,"\n          "),r["\u0275\u0275template"](8,x,2,1,"li",17),r["\u0275\u0275text"](9,"\n        "),r["\u0275\u0275elementEnd"](),r["\u0275\u0275text"](10,"\n      "),r["\u0275\u0275elementEnd"]()),2&e){const e=r["\u0275\u0275nextContext"]().ngVar;r["\u0275\u0275advance"](3),r["\u0275\u0275textInterpolate"](r["\u0275\u0275pipeBind1"](4,2,"profile.groups.head")),r["\u0275\u0275advance"](5),r["\u0275\u0275property"]("ngForOf",e)}}function w(e,t){if(1&e&&(r["\u0275\u0275elementContainerStart"](0),r["\u0275\u0275text"](1,"\n      "),r["\u0275\u0275template"](2,E,11,4,"div",14),r["\u0275\u0275text"](3,"\n    "),r["\u0275\u0275elementContainerEnd"]()),2&e){const e=t.ngVar;r["\u0275\u0275advance"](2),r["\u0275\u0275property"]("ngIf",e)}}function S(e,t){if(1&e){const e=r["\u0275\u0275getCurrentView"]();r["\u0275\u0275elementStart"](0,"div",2),r["\u0275\u0275text"](1,"\n    "),r["\u0275\u0275elementStart"](2,"h3",3),r["\u0275\u0275text"](3),r["\u0275\u0275pipe"](4,"translate"),r["\u0275\u0275elementEnd"](),r["\u0275\u0275text"](5,"\n    "),r["\u0275\u0275elementStart"](6,"div",4),r["\u0275\u0275text"](7,"\n      "),r["\u0275\u0275elementStart"](8,"div",5),r["\u0275\u0275text"](9),r["\u0275\u0275pipe"](10,"translate"),r["\u0275\u0275elementEnd"](),r["\u0275\u0275text"](11,"\n      "),r["\u0275\u0275elementStart"](12,"div",6),r["\u0275\u0275text"](13,"\n        "),r["\u0275\u0275element"](14,"ds-profile-page-metadata-form",7),r["\u0275\u0275text"](15,"\n      "),r["\u0275\u0275elementEnd"](),r["\u0275\u0275text"](16,"\n    "),r["\u0275\u0275elementEnd"](),r["\u0275\u0275text"](17,"\n    "),r["\u0275\u0275template"](18,y,11,4,"div",8),r["\u0275\u0275pipe"](19,"async"),r["\u0275\u0275text"](20,"\n    "),r["\u0275\u0275elementStart"](21,"div",9),r["\u0275\u0275text"](22,"\n      "),r["\u0275\u0275elementStart"](23,"button",10),r["\u0275\u0275listener"]("click",(function(){return r["\u0275\u0275restoreView"](e),r["\u0275\u0275nextContext"](2).updateProfile()})),r["\u0275\u0275element"](24,"i",11),r["\u0275\u0275text"](25),r["\u0275\u0275pipe"](26,"translate"),r["\u0275\u0275elementEnd"](),r["\u0275\u0275text"](27,"\n    "),r["\u0275\u0275elementEnd"](),r["\u0275\u0275text"](28,"\n\n    "),r["\u0275\u0275template"](29,w,4,1,"ng-container",0),r["\u0275\u0275pipe"](30,"async"),r["\u0275\u0275text"](31,"\n  "),r["\u0275\u0275elementEnd"]()}if(2&e){const e=r["\u0275\u0275nextContext"]().ngVar,t=r["\u0275\u0275nextContext"]();let n=null;r["\u0275\u0275advance"](3),r["\u0275\u0275textInterpolate"](r["\u0275\u0275pipeBind1"](4,6,"profile.head")),r["\u0275\u0275advance"](6),r["\u0275\u0275textInterpolate"](r["\u0275\u0275pipeBind1"](10,8,"profile.card.identify")),r["\u0275\u0275advance"](5),r["\u0275\u0275property"]("user",e),r["\u0275\u0275advance"](4),r["\u0275\u0275property"]("ngIf",r["\u0275\u0275pipeBind1"](19,10,t.canChangePassword$)),r["\u0275\u0275advance"](7),r["\u0275\u0275textInterpolate1"](" ",r["\u0275\u0275pipeBind1"](26,12,"profile.form.submit"),""),r["\u0275\u0275advance"](4),r["\u0275\u0275property"]("ngVar",null==(n=r["\u0275\u0275pipeBind1"](30,14,t.groupsRD$))||null==n.payload?null:n.payload.page)}}function O(e,t){if(1&e&&(r["\u0275\u0275elementContainerStart"](0),r["\u0275\u0275text"](1,"\n  "),r["\u0275\u0275template"](2,S,32,16,"div",1),r["\u0275\u0275text"](3,"\n"),r["\u0275\u0275elementContainerEnd"]()),2&e){const e=t.ngVar;r["\u0275\u0275advance"](2),r["\u0275\u0275property"]("ngIf",e)}}let F=(()=>{class e{constructor(e,t,n,r,o){this.authService=e,this.notificationsService=t,this.translate=n,this.epersonService=r,this.authorizationService=o,this.NOTIFICATIONS_PREFIX="profile.notifications.",this.PASSWORD_NOTIFICATIONS_PREFIX="profile.security.form.notifications."}ngOnInit(){this.user$=this.authService.getAuthenticatedUserFromStore().pipe(Object(i.a)(e=>Object(l.b)(e.id)),Object(a.a)(e=>this.epersonService.findById(e.id,!0,!0,Object(d.a)("groups"))),Object(c.c)(),Object(c.o)(),Object(s.a)(e=>this.currentUser=e)),this.groupsRD$=this.user$.pipe(Object(a.a)(e=>e.groups)),this.canChangePassword$=this.user$.pipe(Object(a.a)(e=>this.authorizationService.isAuthorized(u.a.CanChangePassword,e._links.self.href)))}updateProfile(){const e=this.metadataForm.updateProfile(),t=this.updateSecurity();e||t||this.notificationsService.warning(this.translate.instant(this.NOTIFICATIONS_PREFIX+"warning.no-changes.title"),this.translate.instant(this.NOTIFICATIONS_PREFIX+"warning.no-changes.content"))}setInvalid(e){this.invalidSecurity=e}updateSecurity(){const e=Object(l.e)(this.password);return this.invalidSecurity&&this.notificationsService.error(this.translate.instant(this.PASSWORD_NOTIFICATIONS_PREFIX+"error.general")),!this.invalidSecurity&&e&&this.epersonService.patch(this.currentUser,[{op:"add",path:"/password",value:this.password}]).pipe(Object(c.g)()).subscribe(e=>{e.hasSucceeded?this.notificationsService.success(this.translate.instant(this.PASSWORD_NOTIFICATIONS_PREFIX+"success.title"),this.translate.instant(this.PASSWORD_NOTIFICATIONS_PREFIX+"success.content")):this.notificationsService.error(this.translate.instant(this.PASSWORD_NOTIFICATIONS_PREFIX+"error.title"),e.errorMessage)}),e}setPasswordValue(e){this.password=e}submit(){this.updateProfile()}}return e.\u0275fac=function(t){return new(t||e)(r["\u0275\u0275directiveInject"](p.a),r["\u0275\u0275directiveInject"](m.a),r["\u0275\u0275directiveInject"](f.e),r["\u0275\u0275directiveInject"](h.a),r["\u0275\u0275directiveInject"](v.a))},e.\u0275cmp=r["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-profile-page"]],viewQuery:function(e,t){if(1&e&&r["\u0275\u0275viewQuery"](o.a,1),2&e){let e;r["\u0275\u0275queryRefresh"](e=r["\u0275\u0275loadQuery"]())&&(t.metadataForm=e.first)}},decls:3,vars:3,consts:[[4,"ngVar"],["class","container",4,"ngIf"],[1,"container"],[1,"mb-4"],[1,"card","mb-4"],[1,"card-header"],[1,"card-body"],[3,"user"],["class","card mb-4 security-section",4,"ngIf"],[1,"col-12","text-right","pr-0"],[1,"btn","btn-primary",3,"click"],[1,"fas","fa-edit"],[1,"card","mb-4","security-section"],[3,"FORM_PREFIX","isInvalid","passwordValue"],[4,"ngIf"],[1,"mt-4"],[1,"list-group","list-group-flush"],["class","list-group-item",4,"ngFor","ngForOf"],[1,"list-group-item"]],template:function(e,t){1&e&&(r["\u0275\u0275template"](0,O,4,1,"ng-container",0),r["\u0275\u0275pipe"](1,"async"),r["\u0275\u0275text"](2,"\n")),2&e&&r["\u0275\u0275property"]("ngVar",r["\u0275\u0275pipeBind1"](1,1,t.user$))},directives:[g.a,I.p,o.a,b.a,I.o],pipes:[I.b,f.d],styles:[""]}),e})()},"zr/d":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));class r{constructor(e,t){this.text=e,this.url=t}}}}]);
//# sourceMappingURL=9-es2015.0fc906ffd139e4e628b7.js.map