exports.ids=[14],exports.modules={"6yod":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"EditCollectionPageModule",(function(){return EditCollectionPageModule}));var core=__webpack_require__("fXoL"),edit_comcol_page_component=__webpack_require__("tfjI"),collection_page_routing_paths=__webpack_require__("Obj/"),fesm2015_router=__webpack_require__("tyNb"),common=__webpack_require__("ofXK"),ngx_translate_core=__webpack_require__("sYmb");const _c0=function(a0){return{active:a0}},_c1=function(a0){return[a0]};function EditCollectionPageComponent_li_27_Template(rf,ctx){if(1&rf&&(core["\u0275\u0275elementStart"](0,"li",13),core["\u0275\u0275text"](1,"\n            "),core["\u0275\u0275elementStart"](2,"a",14),core["\u0275\u0275text"](3),core["\u0275\u0275pipe"](4,"translate"),core["\u0275\u0275elementEnd"](),core["\u0275\u0275text"](5,"\n          "),core["\u0275\u0275elementEnd"]()),2&rf){const page_r2=ctx.$implicit,ctx_r0=core["\u0275\u0275nextContext"]();core["\u0275\u0275advance"](2),core["\u0275\u0275property"]("ngClass",core["\u0275\u0275pureFunction1"](5,_c0,page_r2===ctx_r0.currentPage))("routerLink",core["\u0275\u0275pureFunction1"](7,_c1,"./"+page_r2)),core["\u0275\u0275advance"](1),core["\u0275\u0275textInterpolate1"]("\n              ",core["\u0275\u0275pipeBind1"](4,3,ctx_r0.type+".edit.tabs."+page_r2+".head"),"\n            ")}}function EditCollectionPageComponent_a_39_Template(rf,ctx){if(1&rf&&(core["\u0275\u0275elementStart"](0,"a",15),core["\u0275\u0275pipe"](1,"async"),core["\u0275\u0275text"](2,"\n              "),core["\u0275\u0275element"](3,"i",16),core["\u0275\u0275text"](4),core["\u0275\u0275pipe"](5,"translate"),core["\u0275\u0275elementEnd"]()),2&rf){const ctx_r1=core["\u0275\u0275nextContext"]();let tmp_0_0=null;core["\u0275\u0275property"]("routerLink",ctx_r1.getPageUrl(null==(tmp_0_0=core["\u0275\u0275pipeBind1"](1,2,ctx_r1.dsoRD$))?null:tmp_0_0.payload)),core["\u0275\u0275advance"](4),core["\u0275\u0275textInterpolate1"](" ",core["\u0275\u0275pipeBind1"](5,4,ctx_r1.type+".edit.return"),"\n            ")}}class edit_collection_page_component_EditCollectionPageComponent extends edit_comcol_page_component.a{constructor(router,route){super(router,route),this.router=router,this.route=route,this.type="collection"}getPageUrl(collection){return Object(collection_page_routing_paths.j)(collection.id)}}edit_collection_page_component_EditCollectionPageComponent.\u0275fac=function EditCollectionPageComponent_Factory(t){return new(t||edit_collection_page_component_EditCollectionPageComponent)(core["\u0275\u0275directiveInject"](fesm2015_router.g),core["\u0275\u0275directiveInject"](fesm2015_router.a))},edit_collection_page_component_EditCollectionPageComponent.\u0275cmp=core["\u0275\u0275defineComponent"]({type:edit_collection_page_component_EditCollectionPageComponent,selectors:[["ds-edit-collection"]],features:[core["\u0275\u0275InheritDefinitionFeature"]],decls:47,vars:11,consts:[[1,"container"],[1,"row"],[1,"col-12"],[1,"d-flex","justify-content-between","border-bottom"],[1,"btn","btn-danger",3,"routerLink"],[1,"fas","fa-trash"],[1,"pt-2"],[1,"nav","nav-tabs","justify-content-start","mb-2"],["class","nav-item",4,"ngFor","ngForOf"],[1,"tab-pane","active"],[1,"mb-4"],[1,"col-12","text-right"],["class","btn btn-outline-secondary",3,"routerLink",4,"ngIf"],[1,"nav-item"],[1,"nav-link",3,"ngClass","routerLink"],[1,"btn","btn-outline-secondary",3,"routerLink"],[1,"fas","fa-arrow-left"]],template:function EditCollectionPageComponent_Template(rf,ctx){if(1&rf&&(core["\u0275\u0275elementStart"](0,"div",0),core["\u0275\u0275text"](1,"\n  "),core["\u0275\u0275elementStart"](2,"div",1),core["\u0275\u0275text"](3,"\n    "),core["\u0275\u0275elementStart"](4,"div",2),core["\u0275\u0275text"](5,"\n      "),core["\u0275\u0275elementStart"](6,"div",3),core["\u0275\u0275text"](7,"\n        "),core["\u0275\u0275elementStart"](8,"h2"),core["\u0275\u0275text"](9),core["\u0275\u0275pipe"](10,"translate"),core["\u0275\u0275elementEnd"](),core["\u0275\u0275text"](11,"\n        "),core["\u0275\u0275elementStart"](12,"div"),core["\u0275\u0275text"](13,"\n          "),core["\u0275\u0275elementStart"](14,"a",4),core["\u0275\u0275pipe"](15,"async"),core["\u0275\u0275text"](16,"\n            "),core["\u0275\u0275element"](17,"i",5),core["\u0275\u0275text"](18),core["\u0275\u0275pipe"](19,"translate"),core["\u0275\u0275elementEnd"](),core["\u0275\u0275text"](20,"\n        "),core["\u0275\u0275elementEnd"](),core["\u0275\u0275text"](21,"\n      "),core["\u0275\u0275elementEnd"](),core["\u0275\u0275text"](22,"\n      "),core["\u0275\u0275elementStart"](23,"div",6),core["\u0275\u0275text"](24,"\n        "),core["\u0275\u0275elementStart"](25,"ul",7),core["\u0275\u0275text"](26,"\n          "),core["\u0275\u0275template"](27,EditCollectionPageComponent_li_27_Template,6,9,"li",8),core["\u0275\u0275text"](28,"\n        "),core["\u0275\u0275elementEnd"](),core["\u0275\u0275text"](29,"\n        "),core["\u0275\u0275elementStart"](30,"div",9),core["\u0275\u0275text"](31,"\n          "),core["\u0275\u0275elementStart"](32,"div",10),core["\u0275\u0275text"](33,"\n            "),core["\u0275\u0275element"](34,"router-outlet"),core["\u0275\u0275text"](35,"\n          "),core["\u0275\u0275elementEnd"](),core["\u0275\u0275text"](36,"\n          "),core["\u0275\u0275elementStart"](37,"div",11),core["\u0275\u0275text"](38,"\n            "),core["\u0275\u0275template"](39,EditCollectionPageComponent_a_39_Template,6,6,"a",12),core["\u0275\u0275text"](40,"\n          "),core["\u0275\u0275elementEnd"](),core["\u0275\u0275text"](41,"\n        "),core["\u0275\u0275elementEnd"](),core["\u0275\u0275text"](42,"\n      "),core["\u0275\u0275elementEnd"](),core["\u0275\u0275text"](43,"\n    "),core["\u0275\u0275elementEnd"](),core["\u0275\u0275text"](44,"\n  "),core["\u0275\u0275elementEnd"](),core["\u0275\u0275text"](45,"\n"),core["\u0275\u0275elementEnd"](),core["\u0275\u0275text"](46,"\n")),2&rf){let tmp_1_0=null;core["\u0275\u0275advance"](9),core["\u0275\u0275textInterpolate"](core["\u0275\u0275pipeBind1"](10,5,ctx.type+".edit.head")),core["\u0275\u0275advance"](5),core["\u0275\u0275property"]("routerLink",("community"===ctx.type?"/communities/":"/collections/")+(null==(tmp_1_0=core["\u0275\u0275pipeBind1"](15,7,ctx.dsoRD$))?null:tmp_1_0.payload.uuid)+"/delete"),core["\u0275\u0275advance"](4),core["\u0275\u0275textInterpolate1"](" ",core["\u0275\u0275pipeBind1"](19,9,ctx.type+".edit.delete"),""),core["\u0275\u0275advance"](9),core["\u0275\u0275property"]("ngForOf",ctx.pages),core["\u0275\u0275advance"](12),core["\u0275\u0275property"]("ngIf",!ctx.hideReturnButton)}},directives:[fesm2015_router.j,common.NgForOf,fesm2015_router.l,common.NgIf,common.NgClass],pipes:[ngx_translate_core.d,common.AsyncPipe],encapsulation:2});var shared_module=__webpack_require__("PCNd"),collection_item_mapper_component=__webpack_require__("pBGb"),comcol_metadata_component=__webpack_require__("AqgH"),collection_model=__webpack_require__("ye/0"),collection_data_service=__webpack_require__("DNva"),item_template_data_service=__webpack_require__("lP90"),combineLatest=__webpack_require__("itXk"),item_model=__webpack_require__("PN+Z"),operators=__webpack_require__("1QIV"),switchMap=__webpack_require__("eIep"),tap=__webpack_require__("vkgz"),notifications_service=__webpack_require__("lI3o"),object_cache_service=__webpack_require__("mycY"),request_service=__webpack_require__("X/78"),var_directive=__webpack_require__("O/5o"),collection_form_component=__webpack_require__("+6qv");function CollectionMetadataComponent_div_0_button_8_Template(rf,ctx){if(1&rf){const _r6=core["\u0275\u0275getCurrentView"]();core["\u0275\u0275elementStart"](0,"button",7),core["\u0275\u0275listener"]("click",(function CollectionMetadataComponent_div_0_button_8_Template_button_click_0_listener(){core["\u0275\u0275restoreView"](_r6);return core["\u0275\u0275nextContext"](2).addItemTemplate()})),core["\u0275\u0275text"](1,"\n      "),core["\u0275\u0275element"](2,"i",8),core["\u0275\u0275text"](3,"\n      "),core["\u0275\u0275elementStart"](4,"span",9),core["\u0275\u0275text"](5),core["\u0275\u0275pipe"](6,"translate"),core["\u0275\u0275elementEnd"](),core["\u0275\u0275text"](7,"\n    "),core["\u0275\u0275elementEnd"]()}2&rf&&(core["\u0275\u0275advance"](5),core["\u0275\u0275textInterpolate1"]("\xa0",core["\u0275\u0275pipeBind1"](6,1,"collection.edit.template.add-button"),""))}function CollectionMetadataComponent_div_0_button_10_Template(rf,ctx){if(1&rf){const _r8=core["\u0275\u0275getCurrentView"]();core["\u0275\u0275elementStart"](0,"button",10),core["\u0275\u0275listener"]("click",(function CollectionMetadataComponent_div_0_button_10_Template_button_click_0_listener(){core["\u0275\u0275restoreView"](_r8);return core["\u0275\u0275nextContext"](2).deleteItemTemplate()})),core["\u0275\u0275text"](1,"\n      "),core["\u0275\u0275element"](2,"i",11),core["\u0275\u0275text"](3,"\n      "),core["\u0275\u0275elementStart"](4,"span",9),core["\u0275\u0275text"](5),core["\u0275\u0275pipe"](6,"translate"),core["\u0275\u0275elementEnd"](),core["\u0275\u0275text"](7,"\n    "),core["\u0275\u0275elementEnd"]()}2&rf&&(core["\u0275\u0275advance"](5),core["\u0275\u0275textInterpolate1"]("\xa0",core["\u0275\u0275pipeBind1"](6,1,"collection.edit.template.delete-button"),""))}function CollectionMetadataComponent_div_0_button_12_Template(rf,ctx){if(1&rf&&(core["\u0275\u0275elementStart"](0,"button",12),core["\u0275\u0275pipe"](1,"async"),core["\u0275\u0275text"](2,"\n      "),core["\u0275\u0275element"](3,"i",13),core["\u0275\u0275text"](4,"\n      "),core["\u0275\u0275elementStart"](5,"span",9),core["\u0275\u0275text"](6),core["\u0275\u0275pipe"](7,"translate"),core["\u0275\u0275elementEnd"](),core["\u0275\u0275text"](8,"\n    "),core["\u0275\u0275elementEnd"]()),2&rf){const ctx_r4=core["\u0275\u0275nextContext"](2);let tmp_0_0=null;core["\u0275\u0275property"]("routerLink","/collections/"+(null==(tmp_0_0=core["\u0275\u0275pipeBind1"](1,2,ctx_r4.dsoRD$))?null:tmp_0_0.payload.uuid)+"/itemtemplate"),core["\u0275\u0275advance"](6),core["\u0275\u0275textInterpolate1"]("\xa0",core["\u0275\u0275pipeBind1"](7,4,"collection.edit.template.edit-button"),"")}}function CollectionMetadataComponent_div_0_Template(rf,ctx){if(1&rf&&(core["\u0275\u0275elementStart"](0,"div",2),core["\u0275\u0275text"](1,"\n  "),core["\u0275\u0275elementStart"](2,"label"),core["\u0275\u0275text"](3),core["\u0275\u0275pipe"](4,"translate"),core["\u0275\u0275elementEnd"](),core["\u0275\u0275text"](5,"\n  "),core["\u0275\u0275elementStart"](6,"div",3),core["\u0275\u0275text"](7,"\n    "),core["\u0275\u0275template"](8,CollectionMetadataComponent_div_0_button_8_Template,8,3,"button",4),core["\u0275\u0275text"](9,"\n    "),core["\u0275\u0275template"](10,CollectionMetadataComponent_div_0_button_10_Template,8,3,"button",5),core["\u0275\u0275text"](11,"\n    "),core["\u0275\u0275template"](12,CollectionMetadataComponent_div_0_button_12_Template,9,6,"button",6),core["\u0275\u0275text"](13,"\n  "),core["\u0275\u0275elementEnd"](),core["\u0275\u0275text"](14,"\n"),core["\u0275\u0275elementEnd"]()),2&rf){const itemTemplateRD_r1=ctx.ngVar;core["\u0275\u0275advance"](3),core["\u0275\u0275textInterpolate"](core["\u0275\u0275pipeBind1"](4,4,"collection.edit.template.label")),core["\u0275\u0275advance"](5),core["\u0275\u0275property"]("ngIf",!(null!=itemTemplateRD_r1&&itemTemplateRD_r1.payload)),core["\u0275\u0275advance"](2),core["\u0275\u0275property"]("ngIf",null==itemTemplateRD_r1?null:itemTemplateRD_r1.payload),core["\u0275\u0275advance"](2),core["\u0275\u0275property"]("ngIf",null==itemTemplateRD_r1?null:itemTemplateRD_r1.payload)}}class collection_metadata_component_CollectionMetadataComponent extends comcol_metadata_component.a{constructor(collectionDataService,itemTemplateService,router,route,notificationsService,translate,objectCache,requestService){super(collectionDataService,router,route,notificationsService,translate),this.collectionDataService=collectionDataService,this.itemTemplateService=itemTemplateService,this.router=router,this.route=route,this.notificationsService=notificationsService,this.translate=translate,this.objectCache=objectCache,this.requestService=requestService,this.frontendURL="/collections/",this.type=collection_model.a.type}ngOnInit(){super.ngOnInit(),this.initTemplateItem()}initTemplateItem(){this.itemTemplateRD$=this.dsoRD$.pipe(Object(operators.j)(),Object(switchMap.a)((collection=>this.itemTemplateService.findByCollectionID(collection.uuid))))}addItemTemplate(){const collection$=this.dsoRD$.pipe(Object(operators.j)()),template$=collection$.pipe(Object(switchMap.a)((collection=>this.itemTemplateService.create(new item_model.a,collection.uuid).pipe(Object(operators.j)())))),templateHref$=collection$.pipe(Object(switchMap.a)((collection=>this.itemTemplateService.getCollectionEndpoint(collection.id))));Object(combineLatest.a)(collection$,template$,templateHref$).subscribe((([collection,template,templateHref])=>{this.requestService.setStaleByHrefSubstring(templateHref),this.router.navigate([Object(collection_page_routing_paths.i)(collection.uuid)])}))}deleteItemTemplate(){const collection$=this.dsoRD$.pipe(Object(operators.j)()),template$=collection$.pipe(Object(switchMap.a)((collection=>this.itemTemplateService.findByCollectionID(collection.uuid).pipe(Object(operators.j)())))),templateHref$=collection$.pipe(Object(switchMap.a)((collection=>this.itemTemplateService.getCollectionEndpoint(collection.id))));Object(combineLatest.a)(collection$,template$,templateHref$).pipe(Object(switchMap.a)((([collection,template,templateHref])=>this.itemTemplateService.deleteByCollectionID(template,collection.uuid).pipe(Object(tap.a)((success=>{success&&(this.objectCache.remove(templateHref),this.objectCache.remove(template.self),this.requestService.setStaleByHrefSubstring(template.self),this.requestService.setStaleByHrefSubstring(templateHref),this.requestService.setStaleByHrefSubstring(collection.self))})))))).subscribe((success=>{success?this.notificationsService.success(null,this.translate.get("collection.edit.template.notifications.delete.success")):this.notificationsService.error(null,this.translate.get("collection.edit.template.notifications.delete.error")),this.initTemplateItem()}))}}collection_metadata_component_CollectionMetadataComponent.\u0275fac=function CollectionMetadataComponent_Factory(t){return new(t||collection_metadata_component_CollectionMetadataComponent)(core["\u0275\u0275directiveInject"](collection_data_service.a),core["\u0275\u0275directiveInject"](item_template_data_service.a),core["\u0275\u0275directiveInject"](fesm2015_router.g),core["\u0275\u0275directiveInject"](fesm2015_router.a),core["\u0275\u0275directiveInject"](notifications_service.a),core["\u0275\u0275directiveInject"](ngx_translate_core.e),core["\u0275\u0275directiveInject"](object_cache_service.a),core["\u0275\u0275directiveInject"](request_service.a))},collection_metadata_component_CollectionMetadataComponent.\u0275cmp=core["\u0275\u0275defineComponent"]({type:collection_metadata_component_CollectionMetadataComponent,selectors:[["ds-collection-metadata"]],features:[core["\u0275\u0275InheritDefinitionFeature"]],decls:6,vars:6,consts:[["class","container-fluid mb-2",4,"ngVar"],[3,"dso","submitForm","back","finish"],[1,"container-fluid","mb-2"],[1,"button-row"],["class","btn btn-success",3,"click",4,"ngIf"],["class","btn btn-danger",3,"click",4,"ngIf"],["class","btn btn-primary",3,"routerLink",4,"ngIf"],[1,"btn","btn-success",3,"click"],[1,"fas","fa-plus"],[1,"d-none","d-sm-inline"],[1,"btn","btn-danger",3,"click"],[1,"fas","fa-trash-alt"],[1,"btn","btn-primary",3,"routerLink"],[1,"fas","fa-edit"]],template:function CollectionMetadataComponent_Template(rf,ctx){if(1&rf&&(core["\u0275\u0275template"](0,CollectionMetadataComponent_div_0_Template,15,6,"div",0),core["\u0275\u0275pipe"](1,"async"),core["\u0275\u0275text"](2,"\n"),core["\u0275\u0275elementStart"](3,"ds-collection-form",1),core["\u0275\u0275listener"]("submitForm",(function CollectionMetadataComponent_Template_ds_collection_form_submitForm_3_listener($event){return ctx.onSubmit($event)}))("back",(function CollectionMetadataComponent_Template_ds_collection_form_back_3_listener(){return ctx.navigateToHomePage()}))("finish",(function CollectionMetadataComponent_Template_ds_collection_form_finish_3_listener(){return ctx.navigateToHomePage()})),core["\u0275\u0275pipe"](4,"async"),core["\u0275\u0275elementEnd"](),core["\u0275\u0275text"](5,"\n")),2&rf){let tmp_1_0=null;core["\u0275\u0275property"]("ngVar",core["\u0275\u0275pipeBind1"](1,2,ctx.itemTemplateRD$)),core["\u0275\u0275advance"](3),core["\u0275\u0275property"]("dso",null==(tmp_1_0=core["\u0275\u0275pipeBind1"](4,4,ctx.dsoRD$))?null:tmp_1_0.payload)}},directives:[var_directive.a,collection_form_component.a,common.NgIf,fesm2015_router.h],pipes:[common.AsyncPipe,ngx_translate_core.d],encapsulation:2});var first=__webpack_require__("SxV6"),map=__webpack_require__("lJxs"),comcol_role_component=__webpack_require__("0EDX");function CollectionRolesComponent_ds_comcol_role_0_Template(rf,ctx){if(1&rf&&(core["\u0275\u0275elementStart"](0,"ds-comcol-role",1),core["\u0275\u0275pipe"](1,"async"),core["\u0275\u0275text"](2,"\n"),core["\u0275\u0275elementEnd"]()),2&rf){const comcolRole_r1=ctx.$implicit,ctx_r0=core["\u0275\u0275nextContext"]();core["\u0275\u0275property"]("dso",core["\u0275\u0275pipeBind1"](1,2,ctx_r0.collection$))("comcolRole",comcolRole_r1)}}class collection_roles_component_CollectionRolesComponent{constructor(route){this.route=route}ngOnInit(){this.dsoRD$=this.route.parent.data.pipe(Object(first.a)(),Object(map.a)((data=>data.dso))),this.collection$=this.dsoRD$.pipe(Object(operators.i)(),Object(operators.o)()),this.comcolRoles$=this.collection$.pipe(Object(map.a)((collection=>[{name:"collection-admin",href:collection._links.adminGroup.href},{name:"submitters",href:collection._links.submittersGroup.href},{name:"item_read",href:collection._links.itemReadGroup.href},{name:"bitstream_read",href:collection._links.bitstreamReadGroup.href},...collection._links.workflowGroups])))}}collection_roles_component_CollectionRolesComponent.\u0275fac=function CollectionRolesComponent_Factory(t){return new(t||collection_roles_component_CollectionRolesComponent)(core["\u0275\u0275directiveInject"](fesm2015_router.a))},collection_roles_component_CollectionRolesComponent.\u0275cmp=core["\u0275\u0275defineComponent"]({type:collection_roles_component_CollectionRolesComponent,selectors:[["ds-collection-roles"]],decls:3,vars:3,consts:[[3,"dso","comcolRole",4,"ngFor","ngForOf"],[3,"dso","comcolRole"]],template:function CollectionRolesComponent_Template(rf,ctx){1&rf&&(core["\u0275\u0275template"](0,CollectionRolesComponent_ds_comcol_role_0_Template,3,4,"ds-comcol-role",0),core["\u0275\u0275pipe"](1,"async"),core["\u0275\u0275text"](2,"\n")),2&rf&&core["\u0275\u0275property"]("ngForOf",core["\u0275\u0275pipeBind1"](1,1,ctx.comcolRoles$))},directives:[common.NgForOf,comcol_role_component.a],pipes:[common.AsyncPipe],encapsulation:2});var abstract_trackable_component=__webpack_require__("daFX"),fesm2015_core=__webpack_require__("e+Av"),object_updates_service=__webpack_require__("loKC"),empty_util=__webpack_require__("J3qs"),content_source_model=__webpack_require__("q7s5"),take=__webpack_require__("IzEk"),lodash=__webpack_require__("LvDl"),environment=__webpack_require__("AytR"),script_data_service=__webpack_require__("TtJg"),process_data_service=__webpack_require__("NqqP"),filter=__webpack_require__("pLZG"),process_status_model=__webpack_require__("AQcY"),BehaviorSubject=__webpack_require__("2Vo4"),bitstream_data_service=__webpack_require__("PCBh"),content_source_set_serializer=__webpack_require__("RZ9z"),http=__webpack_require__("tk/3");function CollectionSourceControlsComponent_div_0_div_2_button_49_Template(rf,ctx){if(1&rf){const _r11=core["\u0275\u0275getCurrentView"]();core["\u0275\u0275elementStart"](0,"button",8),core["\u0275\u0275listener"]("click",(function CollectionSourceControlsComponent_div_0_div_2_button_49_Template_button_click_0_listener(){core["\u0275\u0275restoreView"](_r11);const contentSource_r1=core["\u0275\u0275nextContext"](2).ngVar;return core["\u0275\u0275nextContext"]().testConfiguration(contentSource_r1)})),core["\u0275\u0275text"](1,"\n            "),core["\u0275\u0275elementStart"](2,"span"),core["\u0275\u0275text"](3),core["\u0275\u0275pipe"](4,"translate"),core["\u0275\u0275elementEnd"](),core["\u0275\u0275text"](5,"\n        "),core["\u0275\u0275elementEnd"]()}if(2&rf){const ctx_r3=core["\u0275\u0275nextContext"](3);core["\u0275\u0275property"]("disabled",!ctx_r3.isEnabled),core["\u0275\u0275advance"](3),core["\u0275\u0275textInterpolate"](core["\u0275\u0275pipeBind1"](4,2,"collection.source.controls.test.submit"))}}function CollectionSourceControlsComponent_div_0_div_2_button_52_Template(rf,ctx){1&rf&&(core["\u0275\u0275elementStart"](0,"button",9),core["\u0275\u0275text"](1,"\n            "),core["\u0275\u0275element"](2,"span",10),core["\u0275\u0275text"](3,"\n            "),core["\u0275\u0275elementStart"](4,"span"),core["\u0275\u0275text"](5),core["\u0275\u0275pipe"](6,"translate"),core["\u0275\u0275elementEnd"](),core["\u0275\u0275text"](7,"\n        "),core["\u0275\u0275elementEnd"]()),2&rf&&(core["\u0275\u0275property"]("disabled",!0),core["\u0275\u0275advance"](5),core["\u0275\u0275textInterpolate"](core["\u0275\u0275pipeBind1"](6,2,"collection.source.controls.test.running")))}function CollectionSourceControlsComponent_div_0_div_2_button_55_Template(rf,ctx){if(1&rf){const _r13=core["\u0275\u0275getCurrentView"]();core["\u0275\u0275elementStart"](0,"button",11),core["\u0275\u0275listener"]("click",(function CollectionSourceControlsComponent_div_0_div_2_button_55_Template_button_click_0_listener(){core["\u0275\u0275restoreView"](_r13);return core["\u0275\u0275nextContext"](3).importNow()})),core["\u0275\u0275text"](1,"\n            "),core["\u0275\u0275elementStart"](2,"span",12),core["\u0275\u0275text"](3),core["\u0275\u0275pipe"](4,"translate"),core["\u0275\u0275elementEnd"](),core["\u0275\u0275text"](5,"\n        "),core["\u0275\u0275elementEnd"]()}if(2&rf){const ctx_r5=core["\u0275\u0275nextContext"](3);core["\u0275\u0275property"]("disabled",!ctx_r5.isEnabled),core["\u0275\u0275advance"](3),core["\u0275\u0275textInterpolate"](core["\u0275\u0275pipeBind1"](4,2,"collection.source.controls.import.submit"))}}function CollectionSourceControlsComponent_div_0_div_2_button_58_Template(rf,ctx){1&rf&&(core["\u0275\u0275elementStart"](0,"button",13),core["\u0275\u0275text"](1,"\n            "),core["\u0275\u0275element"](2,"span",10),core["\u0275\u0275text"](3,"\n            "),core["\u0275\u0275elementStart"](4,"span",12),core["\u0275\u0275text"](5),core["\u0275\u0275pipe"](6,"translate"),core["\u0275\u0275elementEnd"](),core["\u0275\u0275text"](7,"\n        "),core["\u0275\u0275elementEnd"]()),2&rf&&(core["\u0275\u0275property"]("disabled",!0),core["\u0275\u0275advance"](5),core["\u0275\u0275textInterpolate"](core["\u0275\u0275pipeBind1"](6,2,"collection.source.controls.import.running")))}function CollectionSourceControlsComponent_div_0_div_2_button_61_Template(rf,ctx){if(1&rf){const _r15=core["\u0275\u0275getCurrentView"]();core["\u0275\u0275elementStart"](0,"button",11),core["\u0275\u0275listener"]("click",(function CollectionSourceControlsComponent_div_0_div_2_button_61_Template_button_click_0_listener(){core["\u0275\u0275restoreView"](_r15);return core["\u0275\u0275nextContext"](3).resetAndReimport()})),core["\u0275\u0275text"](1,"\n            "),core["\u0275\u0275elementStart"](2,"span",12),core["\u0275\u0275text"](3),core["\u0275\u0275pipe"](4,"translate"),core["\u0275\u0275elementEnd"](),core["\u0275\u0275text"](5,"\n        "),core["\u0275\u0275elementEnd"]()}if(2&rf){const ctx_r7=core["\u0275\u0275nextContext"](3);core["\u0275\u0275property"]("disabled",!ctx_r7.isEnabled),core["\u0275\u0275advance"](3),core["\u0275\u0275textInterpolate1"]("\xa0",core["\u0275\u0275pipeBind1"](4,2,"collection.source.controls.reset.submit"),"")}}function CollectionSourceControlsComponent_div_0_div_2_button_64_Template(rf,ctx){1&rf&&(core["\u0275\u0275elementStart"](0,"button",13),core["\u0275\u0275text"](1,"\n            "),core["\u0275\u0275element"](2,"span",10),core["\u0275\u0275text"](3,"\n            "),core["\u0275\u0275elementStart"](4,"span",12),core["\u0275\u0275text"](5),core["\u0275\u0275pipe"](6,"translate"),core["\u0275\u0275elementEnd"](),core["\u0275\u0275text"](7,"\n        "),core["\u0275\u0275elementEnd"]()),2&rf&&(core["\u0275\u0275property"]("disabled",!0),core["\u0275\u0275advance"](5),core["\u0275\u0275textInterpolate1"]("\xa0",core["\u0275\u0275pipeBind1"](6,2,"collection.source.controls.reset.running"),""))}function CollectionSourceControlsComponent_div_0_div_2_Template(rf,ctx){if(1&rf&&(core["\u0275\u0275elementStart"](0,"div",2),core["\u0275\u0275text"](1,"\n        "),core["\u0275\u0275elementStart"](2,"h4"),core["\u0275\u0275text"](3),core["\u0275\u0275pipe"](4,"translate"),core["\u0275\u0275elementEnd"](),core["\u0275\u0275text"](5,"\n        "),core["\u0275\u0275elementStart"](6,"div"),core["\u0275\u0275text"](7,"\n            "),core["\u0275\u0275elementStart"](8,"span",3),core["\u0275\u0275text"](9),core["\u0275\u0275pipe"](10,"translate"),core["\u0275\u0275elementEnd"](),core["\u0275\u0275text"](11,"\n            "),core["\u0275\u0275elementStart"](12,"span"),core["\u0275\u0275text"](13),core["\u0275\u0275elementEnd"](),core["\u0275\u0275text"](14,"\n        "),core["\u0275\u0275elementEnd"](),core["\u0275\u0275text"](15,"\n        "),core["\u0275\u0275elementStart"](16,"div"),core["\u0275\u0275text"](17,"\n            "),core["\u0275\u0275elementStart"](18,"span",3),core["\u0275\u0275text"](19),core["\u0275\u0275pipe"](20,"translate"),core["\u0275\u0275elementEnd"](),core["\u0275\u0275text"](21,"\n            "),core["\u0275\u0275elementStart"](22,"span"),core["\u0275\u0275text"](23),core["\u0275\u0275pipe"](24,"translate"),core["\u0275\u0275elementEnd"](),core["\u0275\u0275text"](25,"\n        "),core["\u0275\u0275elementEnd"](),core["\u0275\u0275text"](26,"\n        "),core["\u0275\u0275elementStart"](27,"div"),core["\u0275\u0275text"](28,"\n            "),core["\u0275\u0275elementStart"](29,"span",3),core["\u0275\u0275text"](30),core["\u0275\u0275pipe"](31,"translate"),core["\u0275\u0275elementEnd"](),core["\u0275\u0275text"](32,"\n            "),core["\u0275\u0275elementStart"](33,"span"),core["\u0275\u0275text"](34),core["\u0275\u0275pipe"](35,"translate"),core["\u0275\u0275elementEnd"](),core["\u0275\u0275text"](36,"\n        "),core["\u0275\u0275elementEnd"](),core["\u0275\u0275text"](37,"\n        "),core["\u0275\u0275elementStart"](38,"div"),core["\u0275\u0275text"](39,"\n            "),core["\u0275\u0275elementStart"](40,"span",3),core["\u0275\u0275text"](41),core["\u0275\u0275pipe"](42,"translate"),core["\u0275\u0275elementEnd"](),core["\u0275\u0275text"](43,"\n            "),core["\u0275\u0275elementStart"](44,"span"),core["\u0275\u0275text"](45),core["\u0275\u0275pipe"](46,"translate"),core["\u0275\u0275elementEnd"](),core["\u0275\u0275text"](47,"\n        "),core["\u0275\u0275elementEnd"](),core["\u0275\u0275text"](48,"\n\n        "),core["\u0275\u0275template"](49,CollectionSourceControlsComponent_div_0_div_2_button_49_Template,6,4,"button",4),core["\u0275\u0275pipe"](50,"async"),core["\u0275\u0275text"](51,"\n        "),core["\u0275\u0275template"](52,CollectionSourceControlsComponent_div_0_div_2_button_52_Template,8,4,"button",5),core["\u0275\u0275pipe"](53,"async"),core["\u0275\u0275text"](54,"\n        "),core["\u0275\u0275template"](55,CollectionSourceControlsComponent_div_0_div_2_button_55_Template,6,4,"button",6),core["\u0275\u0275pipe"](56,"async"),core["\u0275\u0275text"](57,"\n        "),core["\u0275\u0275template"](58,CollectionSourceControlsComponent_div_0_div_2_button_58_Template,8,4,"button",7),core["\u0275\u0275pipe"](59,"async"),core["\u0275\u0275text"](60,"\n        "),core["\u0275\u0275template"](61,CollectionSourceControlsComponent_div_0_div_2_button_61_Template,6,4,"button",6),core["\u0275\u0275pipe"](62,"async"),core["\u0275\u0275text"](63,"\n        "),core["\u0275\u0275template"](64,CollectionSourceControlsComponent_div_0_div_2_button_64_Template,8,4,"button",7),core["\u0275\u0275pipe"](65,"async"),core["\u0275\u0275text"](66,"\n\n\n    "),core["\u0275\u0275elementEnd"]()),2&rf){const contentSource_r1=core["\u0275\u0275nextContext"]().ngVar,ctx_r2=core["\u0275\u0275nextContext"]();core["\u0275\u0275advance"](3),core["\u0275\u0275textInterpolate"](core["\u0275\u0275pipeBind1"](4,15,"collection.source.controls.head")),core["\u0275\u0275advance"](6),core["\u0275\u0275textInterpolate"](core["\u0275\u0275pipeBind1"](10,17,"collection.source.controls.harvest.status")),core["\u0275\u0275advance"](4),core["\u0275\u0275textInterpolate"](null==contentSource_r1?null:contentSource_r1.harvestStatus),core["\u0275\u0275advance"](6),core["\u0275\u0275textInterpolate"](core["\u0275\u0275pipeBind1"](20,19,"collection.source.controls.harvest.start")),core["\u0275\u0275advance"](4),core["\u0275\u0275textInterpolate"](null!=contentSource_r1&&contentSource_r1.harvestStartTime?null==contentSource_r1?null:contentSource_r1.harvestStartTime:core["\u0275\u0275pipeBind1"](24,21,"collection.source.controls.harvest.no-information")),core["\u0275\u0275advance"](7),core["\u0275\u0275textInterpolate"](core["\u0275\u0275pipeBind1"](31,23,"collection.source.controls.harvest.last")),core["\u0275\u0275advance"](4),core["\u0275\u0275textInterpolate"](null!=contentSource_r1&&contentSource_r1.message?null==contentSource_r1?null:contentSource_r1.message:core["\u0275\u0275pipeBind1"](35,25,"collection.source.controls.harvest.no-information")),core["\u0275\u0275advance"](7),core["\u0275\u0275textInterpolate"](core["\u0275\u0275pipeBind1"](42,27,"collection.source.controls.harvest.message")),core["\u0275\u0275advance"](4),core["\u0275\u0275textInterpolate"](null!=contentSource_r1&&contentSource_r1.lastHarvested?null==contentSource_r1?null:contentSource_r1.lastHarvested:core["\u0275\u0275pipeBind1"](46,29,"collection.source.controls.harvest.no-information")),core["\u0275\u0275advance"](4),core["\u0275\u0275property"]("ngIf",!core["\u0275\u0275pipeBind1"](50,31,ctx_r2.testConfigRunning$)),core["\u0275\u0275advance"](3),core["\u0275\u0275property"]("ngIf",core["\u0275\u0275pipeBind1"](53,33,ctx_r2.testConfigRunning$)),core["\u0275\u0275advance"](3),core["\u0275\u0275property"]("ngIf",!core["\u0275\u0275pipeBind1"](56,35,ctx_r2.importRunning$)),core["\u0275\u0275advance"](3),core["\u0275\u0275property"]("ngIf",core["\u0275\u0275pipeBind1"](59,37,ctx_r2.importRunning$)),core["\u0275\u0275advance"](3),core["\u0275\u0275property"]("ngIf",!core["\u0275\u0275pipeBind1"](62,39,ctx_r2.reImportRunning$)),core["\u0275\u0275advance"](3),core["\u0275\u0275property"]("ngIf",core["\u0275\u0275pipeBind1"](65,41,ctx_r2.reImportRunning$))}}function CollectionSourceControlsComponent_div_0_Template(rf,ctx){if(1&rf&&(core["\u0275\u0275elementStart"](0,"div"),core["\u0275\u0275text"](1,"\n    "),core["\u0275\u0275template"](2,CollectionSourceControlsComponent_div_0_div_2_Template,67,43,"div",1),core["\u0275\u0275text"](3,"\n"),core["\u0275\u0275elementEnd"]()),2&rf){const ctx_r0=core["\u0275\u0275nextContext"]();core["\u0275\u0275advance"](2),core["\u0275\u0275property"]("ngIf",ctx_r0.shouldShow)}}class collection_source_controls_component_CollectionSourceControlsComponent{constructor(scriptDataService,processDataService,requestService,notificationsService,collectionService,translateService,httpClient,bitstreamService){this.scriptDataService=scriptDataService,this.processDataService=processDataService,this.requestService=requestService,this.notificationsService=notificationsService,this.collectionService=collectionService,this.translateService=translateService,this.httpClient=httpClient,this.bitstreamService=bitstreamService,this.subs=[],this.testConfigRunning$=new BehaviorSubject.a(!1),this.importRunning$=new BehaviorSubject.a(!1),this.reImportRunning$=new BehaviorSubject.a(!1)}ngOnInit(){this.contentSource$=this.collectionService.findByHref(this.collection._links.self.href,!1).pipe(Object(operators.d)(),Object(switchMap.a)((collection=>this.collectionService.getContentSource(collection.uuid,!1))),Object(operators.d)())}testConfiguration(contentSource){this.testConfigRunning$.next(!0),this.subs.push(this.scriptDataService.invoke("harvest",[{name:"-g",value:null},{name:"-a",value:contentSource.oaiSource},{name:"-i",value:(new content_source_set_serializer.a).Serialize(contentSource.oaiSetId)}],[]).pipe(Object(operators.g)(),Object(tap.a)((rd=>{rd.hasFailed&&(this.notificationsService.error(this.translateService.get("collection.source.controls.test.submit.error")),this.testConfigRunning$.next(!1))})),Object(filter.a)((rd=>rd.hasSucceeded&&Object(empty_util.b)(rd.payload))),Object(switchMap.a)((rd=>this.processDataService.findById(rd.payload.processId,!1))),Object(operators.b)(),Object(filter.a)((rd=>!rd.isStale&&(rd.hasSucceeded||rd.hasFailed))),Object(map.a)((rd=>rd.payload)),Object(empty_util.c)()).subscribe((process=>{process.processStatus.toString()!==process_status_model.a[process_status_model.a.COMPLETED].toString()&&process.processStatus.toString()!==process_status_model.a[process_status_model.a.FAILED].toString()&&setTimeout((()=>{this.requestService.setStaleByHrefSubstring(process._links.self.href)}),5e3),process.processStatus.toString()===process_status_model.a[process_status_model.a.FAILED].toString()&&(this.notificationsService.error(this.translateService.get("collection.source.controls.test.failed")),this.testConfigRunning$.next(!1)),process.processStatus.toString()===process_status_model.a[process_status_model.a.COMPLETED].toString()&&(this.bitstreamService.findByHref(process._links.output.href).pipe(Object(operators.j)()).subscribe((bitstream=>{this.httpClient.get(bitstream._links.content.href,{responseType:"text"}).subscribe((data=>{const output=data.replaceAll(new RegExp(".*\\@(.*)","g"),"$1").replaceAll("The script has started","").replaceAll("The script has completed","");this.notificationsService.info(this.translateService.get("collection.source.controls.test.completed"),output)}))})),this.testConfigRunning$.next(!1))})))}importNow(){this.importRunning$.next(!0),this.subs.push(this.scriptDataService.invoke("harvest",[{name:"-r",value:null},{name:"-c",value:this.collection.uuid}],[]).pipe(Object(operators.g)(),Object(tap.a)((rd=>{rd.hasFailed?(this.notificationsService.error(this.translateService.get("collection.source.controls.import.submit.error")),this.importRunning$.next(!1)):this.notificationsService.success(this.translateService.get("collection.source.controls.import.submit.success"))})),Object(filter.a)((rd=>rd.hasSucceeded&&Object(empty_util.b)(rd.payload))),Object(switchMap.a)((rd=>this.processDataService.findById(rd.payload.processId,!1))),Object(operators.b)(),Object(filter.a)((rd=>!rd.isStale&&(rd.hasSucceeded||rd.hasFailed))),Object(map.a)((rd=>rd.payload)),Object(empty_util.c)()).subscribe((process=>{process.processStatus.toString()!==process_status_model.a[process_status_model.a.COMPLETED].toString()&&process.processStatus.toString()!==process_status_model.a[process_status_model.a.FAILED].toString()&&setTimeout((()=>{this.requestService.setStaleByHrefSubstring(process._links.self.href),this.requestService.setStaleByHrefSubstring(this.collection._links.self.href)}),5e3),process.processStatus.toString()===process_status_model.a[process_status_model.a.FAILED].toString()&&(this.notificationsService.error(this.translateService.get("collection.source.controls.import.failed")),this.importRunning$.next(!1)),process.processStatus.toString()===process_status_model.a[process_status_model.a.COMPLETED].toString()&&(this.notificationsService.success(this.translateService.get("collection.source.controls.import.completed")),this.requestService.setStaleByHrefSubstring(this.collection._links.self.href),this.importRunning$.next(!1))})))}resetAndReimport(){this.reImportRunning$.next(!0),this.subs.push(this.scriptDataService.invoke("harvest",[{name:"-o",value:null},{name:"-c",value:this.collection.uuid}],[]).pipe(Object(operators.g)(),Object(tap.a)((rd=>{rd.hasFailed?(this.notificationsService.error(this.translateService.get("collection.source.controls.reset.submit.error")),this.reImportRunning$.next(!1)):this.notificationsService.success(this.translateService.get("collection.source.controls.reset.submit.success"))})),Object(filter.a)((rd=>rd.hasSucceeded&&Object(empty_util.b)(rd.payload))),Object(switchMap.a)((rd=>this.processDataService.findById(rd.payload.processId,!1))),Object(operators.b)(),Object(filter.a)((rd=>!rd.isStale&&(rd.hasSucceeded||rd.hasFailed))),Object(map.a)((rd=>rd.payload)),Object(empty_util.c)()).subscribe((process=>{process.processStatus.toString()!==process_status_model.a[process_status_model.a.COMPLETED].toString()&&process.processStatus.toString()!==process_status_model.a[process_status_model.a.FAILED].toString()&&setTimeout((()=>{this.requestService.setStaleByHrefSubstring(process._links.self.href),this.requestService.setStaleByHrefSubstring(this.collection._links.self.href)}),5e3),process.processStatus.toString()===process_status_model.a[process_status_model.a.FAILED].toString()&&(this.notificationsService.error(this.translateService.get("collection.source.controls.reset.failed")),this.reImportRunning$.next(!1)),process.processStatus.toString()===process_status_model.a[process_status_model.a.COMPLETED].toString()&&(this.notificationsService.success(this.translateService.get("collection.source.controls.reset.completed")),this.requestService.setStaleByHrefSubstring(this.collection._links.self.href),this.reImportRunning$.next(!1))})))}ngOnDestroy(){this.subs.forEach((sub=>{Object(empty_util.b)(sub)&&sub.unsubscribe()}))}}collection_source_controls_component_CollectionSourceControlsComponent.\u0275fac=function CollectionSourceControlsComponent_Factory(t){return new(t||collection_source_controls_component_CollectionSourceControlsComponent)(core["\u0275\u0275directiveInject"](script_data_service.c),core["\u0275\u0275directiveInject"](process_data_service.a),core["\u0275\u0275directiveInject"](request_service.a),core["\u0275\u0275directiveInject"](notifications_service.a),core["\u0275\u0275directiveInject"](collection_data_service.a),core["\u0275\u0275directiveInject"](ngx_translate_core.e),core["\u0275\u0275directiveInject"](http.c),core["\u0275\u0275directiveInject"](bitstream_data_service.a))},collection_source_controls_component_CollectionSourceControlsComponent.\u0275cmp=core["\u0275\u0275defineComponent"]({type:collection_source_controls_component_CollectionSourceControlsComponent,selectors:[["ds-collection-source-controls"]],inputs:{isEnabled:"isEnabled",collection:"collection",shouldShow:"shouldShow"},decls:2,vars:3,consts:[[4,"ngVar"],["class","container-fluid",4,"ngIf"],[1,"container-fluid"],[1,"font-weight-bold"],["class","btn btn-secondary",3,"disabled","click",4,"ngIf"],["class","btn btn-secondary",3,"disabled",4,"ngIf"],["class","btn btn-primary",3,"disabled","click",4,"ngIf"],["class","btn btn-primary",3,"disabled",4,"ngIf"],[1,"btn","btn-secondary",3,"disabled","click"],[1,"btn","btn-secondary",3,"disabled"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm","spinner-button"],[1,"btn","btn-primary",3,"disabled","click"],[1,"d-none","d-sm-inline"],[1,"btn","btn-primary",3,"disabled"]],template:function CollectionSourceControlsComponent_Template(rf,ctx){1&rf&&(core["\u0275\u0275template"](0,CollectionSourceControlsComponent_div_0_Template,4,1,"div",0),core["\u0275\u0275pipe"](1,"async")),2&rf&&core["\u0275\u0275property"]("ngVar",core["\u0275\u0275pipeBind1"](1,1,ctx.contentSource$))},directives:[var_directive.a,common.NgIf],pipes:[common.AsyncPipe,ngx_translate_core.d],styles:[".spinner-button[_ngcontent-%COMP%]{margin-bottom:calc((var(--bs-line-height-base) * 1rem - var(--bs-font-size-base)) / 2)}"]});var loading_component=__webpack_require__("Frqi"),form_component=__webpack_require__("hqmO"),fesm2015_forms=__webpack_require__("3Pt+");function CollectionSourceComponent_button_4_Template(rf,ctx){if(1&rf){const _r8=core["\u0275\u0275getCurrentView"]();core["\u0275\u0275elementStart"](0,"button",14),core["\u0275\u0275listener"]("click",(function CollectionSourceComponent_button_4_Template_button_click_0_listener(){core["\u0275\u0275restoreView"](_r8);return core["\u0275\u0275nextContext"]().discard()})),core["\u0275\u0275pipe"](1,"async"),core["\u0275\u0275element"](2,"i",15),core["\u0275\u0275text"](3,"\n            "),core["\u0275\u0275elementStart"](4,"span",6),core["\u0275\u0275text"](5),core["\u0275\u0275pipe"](6,"translate"),core["\u0275\u0275elementEnd"](),core["\u0275\u0275text"](7,"\n        "),core["\u0275\u0275elementEnd"]()}if(2&rf){const ctx_r0=core["\u0275\u0275nextContext"]();core["\u0275\u0275property"]("disabled",!core["\u0275\u0275pipeBind1"](1,2,ctx_r0.hasChanges())),core["\u0275\u0275advance"](5),core["\u0275\u0275textInterpolate1"]("\xa0",core["\u0275\u0275pipeBind1"](6,4,"item.edit.metadata.discard-button"),"")}}function CollectionSourceComponent_button_7_Template(rf,ctx){if(1&rf){const _r10=core["\u0275\u0275getCurrentView"]();core["\u0275\u0275elementStart"](0,"button",16),core["\u0275\u0275listener"]("click",(function CollectionSourceComponent_button_7_Template_button_click_0_listener(){core["\u0275\u0275restoreView"](_r10);return core["\u0275\u0275nextContext"]().reinstate()})),core["\u0275\u0275element"](1,"i",17),core["\u0275\u0275text"](2,"\n            "),core["\u0275\u0275elementStart"](3,"span",6),core["\u0275\u0275text"](4),core["\u0275\u0275pipe"](5,"translate"),core["\u0275\u0275elementEnd"](),core["\u0275\u0275text"](6,"\n        "),core["\u0275\u0275elementEnd"]()}2&rf&&(core["\u0275\u0275advance"](4),core["\u0275\u0275textInterpolate1"]("\xa0",core["\u0275\u0275pipeBind1"](5,1,"item.edit.metadata.reinstate-button"),""))}function CollectionSourceComponent_div_24_Template(rf,ctx){if(1&rf){const _r12=core["\u0275\u0275getCurrentView"]();core["\u0275\u0275elementStart"](0,"div",18),core["\u0275\u0275text"](1,"\n        "),core["\u0275\u0275elementStart"](2,"input",19),core["\u0275\u0275listener"]("change",(function CollectionSourceComponent_div_24_Template_input_change_2_listener(){core["\u0275\u0275restoreView"](_r12);return core["\u0275\u0275nextContext"]().changeExternalSource()})),core["\u0275\u0275elementEnd"](),core["\u0275\u0275text"](3,"\n        "),core["\u0275\u0275elementStart"](4,"label",20),core["\u0275\u0275text"](5),core["\u0275\u0275pipe"](6,"translate"),core["\u0275\u0275elementEnd"](),core["\u0275\u0275text"](7,"\n    "),core["\u0275\u0275elementEnd"]()}if(2&rf){const ctx_r2=core["\u0275\u0275nextContext"]();core["\u0275\u0275advance"](2),core["\u0275\u0275property"]("checked",(null==ctx_r2.contentSource?null:ctx_r2.contentSource.harvestType)!==ctx_r2.harvestTypeNone),core["\u0275\u0275advance"](3),core["\u0275\u0275textInterpolate"](core["\u0275\u0275pipeBind1"](6,2,"collection.edit.tabs.source.external"))}}function CollectionSourceComponent_ds_loading_26_Template(rf,ctx){1&rf&&(core["\u0275\u0275element"](0,"ds-loading",21),core["\u0275\u0275pipe"](1,"translate")),2&rf&&core["\u0275\u0275property"]("message",core["\u0275\u0275pipeBind1"](1,1,"loading.content-source"))}function CollectionSourceComponent_h4_28_Template(rf,ctx){1&rf&&(core["\u0275\u0275elementStart"](0,"h4"),core["\u0275\u0275text"](1),core["\u0275\u0275pipe"](2,"translate"),core["\u0275\u0275elementEnd"]()),2&rf&&(core["\u0275\u0275advance"](1),core["\u0275\u0275textInterpolate"](core["\u0275\u0275pipeBind1"](2,1,"collection.edit.tabs.source.form.head")))}function CollectionSourceComponent_ds_form_33_Template(rf,ctx){if(1&rf){const _r14=core["\u0275\u0275getCurrentView"]();core["\u0275\u0275elementStart"](0,"ds-form",22),core["\u0275\u0275listener"]("dfChange",(function CollectionSourceComponent_ds_form_33_Template_ds_form_dfChange_0_listener($event){core["\u0275\u0275restoreView"](_r14);return core["\u0275\u0275nextContext"]().onChange($event)}))("submitForm",(function CollectionSourceComponent_ds_form_33_Template_ds_form_submitForm_0_listener(){core["\u0275\u0275restoreView"](_r14);return core["\u0275\u0275nextContext"]().onSubmit()}))("cancel",(function CollectionSourceComponent_ds_form_33_Template_ds_form_cancel_0_listener(){core["\u0275\u0275restoreView"](_r14);return core["\u0275\u0275nextContext"]().onCancel()})),core["\u0275\u0275elementEnd"]()}if(2&rf){const ctx_r5=core["\u0275\u0275nextContext"]();core["\u0275\u0275property"]("formId","collection-source-form-id")("formGroup",ctx_r5.formGroup)("formModel",ctx_r5.formModel)("formLayout",ctx_r5.formLayout)("displaySubmit",!1)("displayCancel",!1)}}function CollectionSourceComponent_div_36_button_8_Template(rf,ctx){if(1&rf){const _r20=core["\u0275\u0275getCurrentView"]();core["\u0275\u0275elementStart"](0,"button",14),core["\u0275\u0275listener"]("click",(function CollectionSourceComponent_div_36_button_8_Template_button_click_0_listener(){core["\u0275\u0275restoreView"](_r20);return core["\u0275\u0275nextContext"](2).discard()})),core["\u0275\u0275pipe"](1,"async"),core["\u0275\u0275element"](2,"i",15),core["\u0275\u0275text"](3,"\n                    "),core["\u0275\u0275elementStart"](4,"span",6),core["\u0275\u0275text"](5),core["\u0275\u0275pipe"](6,"translate"),core["\u0275\u0275elementEnd"](),core["\u0275\u0275text"](7,"\n                "),core["\u0275\u0275elementEnd"]()}if(2&rf){const ctx_r17=core["\u0275\u0275nextContext"](2);core["\u0275\u0275property"]("disabled",!core["\u0275\u0275pipeBind1"](1,2,ctx_r17.hasChanges())),core["\u0275\u0275advance"](5),core["\u0275\u0275textInterpolate1"]("\xa0",core["\u0275\u0275pipeBind1"](6,4,"item.edit.metadata.discard-button"),"")}}function CollectionSourceComponent_div_36_button_11_Template(rf,ctx){if(1&rf){const _r22=core["\u0275\u0275getCurrentView"]();core["\u0275\u0275elementStart"](0,"button",16),core["\u0275\u0275listener"]("click",(function CollectionSourceComponent_div_36_button_11_Template_button_click_0_listener(){core["\u0275\u0275restoreView"](_r22);return core["\u0275\u0275nextContext"](2).reinstate()})),core["\u0275\u0275element"](1,"i",17),core["\u0275\u0275text"](2,"\n                    "),core["\u0275\u0275elementStart"](3,"span",6),core["\u0275\u0275text"](4),core["\u0275\u0275pipe"](5,"translate"),core["\u0275\u0275elementEnd"](),core["\u0275\u0275text"](6,"\n                "),core["\u0275\u0275elementEnd"]()}2&rf&&(core["\u0275\u0275advance"](4),core["\u0275\u0275textInterpolate1"]("\xa0",core["\u0275\u0275pipeBind1"](5,1,"item.edit.metadata.reinstate-button"),""))}function CollectionSourceComponent_div_36_Template(rf,ctx){if(1&rf){const _r24=core["\u0275\u0275getCurrentView"]();core["\u0275\u0275elementStart"](0,"div",23),core["\u0275\u0275text"](1,"\n    "),core["\u0275\u0275elementStart"](2,"div",10),core["\u0275\u0275text"](3,"\n        "),core["\u0275\u0275elementStart"](4,"div",24),core["\u0275\u0275text"](5,"\n            "),core["\u0275\u0275elementStart"](6,"div",25),core["\u0275\u0275text"](7,"\n                "),core["\u0275\u0275template"](8,CollectionSourceComponent_div_36_button_8_Template,8,6,"button",2),core["\u0275\u0275pipe"](9,"async"),core["\u0275\u0275text"](10,"\n                "),core["\u0275\u0275template"](11,CollectionSourceComponent_div_36_button_11_Template,7,3,"button",3),core["\u0275\u0275pipe"](12,"async"),core["\u0275\u0275text"](13,"\n                "),core["\u0275\u0275elementStart"](14,"button",4),core["\u0275\u0275listener"]("click",(function CollectionSourceComponent_div_36_Template_button_click_14_listener(){core["\u0275\u0275restoreView"](_r24);return core["\u0275\u0275nextContext"]().onSubmit()})),core["\u0275\u0275pipe"](15,"async"),core["\u0275\u0275element"](16,"i",5),core["\u0275\u0275text"](17,"\n                    "),core["\u0275\u0275elementStart"](18,"span",6),core["\u0275\u0275text"](19),core["\u0275\u0275pipe"](20,"translate"),core["\u0275\u0275elementEnd"](),core["\u0275\u0275text"](21,"\n                "),core["\u0275\u0275elementEnd"](),core["\u0275\u0275text"](22,"\n            "),core["\u0275\u0275elementEnd"](),core["\u0275\u0275text"](23,"\n        "),core["\u0275\u0275elementEnd"](),core["\u0275\u0275text"](24,"\n    "),core["\u0275\u0275elementEnd"](),core["\u0275\u0275text"](25,"\n"),core["\u0275\u0275elementEnd"]()}if(2&rf){const ctx_r6=core["\u0275\u0275nextContext"]();core["\u0275\u0275advance"](8),core["\u0275\u0275property"]("ngIf",!core["\u0275\u0275pipeBind1"](9,4,ctx_r6.isReinstatable())),core["\u0275\u0275advance"](3),core["\u0275\u0275property"]("ngIf",core["\u0275\u0275pipeBind1"](12,6,ctx_r6.isReinstatable())),core["\u0275\u0275advance"](3),core["\u0275\u0275property"]("disabled",!core["\u0275\u0275pipeBind1"](15,8,ctx_r6.hasChanges())||!ctx_r6.isValid()||ctx_r6.initialHarvestType===ctx_r6.harvestTypeNone&&ctx_r6.contentSource.harvestType===ctx_r6.initialHarvestType),core["\u0275\u0275advance"](5),core["\u0275\u0275textInterpolate1"]("\xa0",core["\u0275\u0275pipeBind1"](20,10,"item.edit.metadata.save-button"),"")}}class collection_source_component_CollectionSourceComponent extends abstract_trackable_component.a{constructor(objectUpdatesService,notificationsService,location,formService,translate,route,router,collectionService,requestService){super(objectUpdatesService,notificationsService,translate),this.objectUpdatesService=objectUpdatesService,this.notificationsService=notificationsService,this.location=location,this.formService=formService,this.translate=translate,this.route=route,this.router=router,this.collectionService=collectionService,this.requestService=requestService,this.LABEL_KEY_PREFIX="collection.edit.tabs.source.form.",this.ERROR_KEY_PREFIX="collection.edit.tabs.source.form.errors.",this.OPTIONS_KEY_PREFIX="collection.edit.tabs.source.form.options.",this.oaiSourceModel=new fesm2015_core.J({id:"oaiSource",name:"oaiSource",required:!0,validators:{required:null},errorMessages:{required:"You must provide a set id of the target collection."}}),this.oaiSetIdModel=new fesm2015_core.J({id:"oaiSetId",name:"oaiSetId"}),this.metadataConfigIdModel=new fesm2015_core.N({id:"metadataConfigId",name:"metadataConfigId"}),this.harvestTypeModel=new fesm2015_core.M({id:"harvestType",name:"harvestType",options:[{value:content_source_model.b.Metadata},{value:content_source_model.b.MetadataAndRef},{value:content_source_model.b.MetadataAndBitstreams}]}),this.inputModels=[this.oaiSourceModel,this.oaiSetIdModel,this.metadataConfigIdModel,this.harvestTypeModel],this.formModel=[new fesm2015_core.D({id:"oaiSourceContainer",group:[this.oaiSourceModel]}),new fesm2015_core.D({id:"oaiSetContainer",group:[this.oaiSetIdModel,this.metadataConfigIdModel]}),new fesm2015_core.D({id:"harvestTypeContainer",group:[this.harvestTypeModel]})],this.formLayout={oaiSource:{grid:{host:"col-12 d-inline-block"}},oaiSetId:{grid:{host:"col col-sm-6 d-inline-block"}},metadataConfigId:{grid:{host:"col col-sm-6 d-inline-block"}},harvestType:{grid:{host:"col-12",option:"btn-outline-secondary"}},oaiSetContainer:{grid:{host:"row"}},oaiSourceContainer:{grid:{host:"row"}},harvestTypeContainer:{grid:{host:"row"}}},this.harvestTypeNone=content_source_model.b.None,this.previouslySelectedHarvestType=content_source_model.b.Metadata,this.displayedNotifications=[]}ngOnInit(){this.notificationsPrefix="collection.edit.tabs.source.notifications.",this.discardTimeOut=environment.a.collection.edit.undoTimeout,this.url=this.router.url,this.url.indexOf("?")>0&&(this.url=this.url.substr(0,this.url.indexOf("?"))),this.formGroup=this.formService.createFormGroup(this.formModel),this.collectionRD$=this.route.parent.data.pipe(Object(first.a)(),Object(map.a)((data=>data.dso))),this.collectionRD$.pipe(Object(operators.i)(),Object(map.a)((col=>col.payload.uuid)),Object(switchMap.a)((uuid=>this.collectionService.getContentSource(uuid))),Object(operators.g)()).subscribe((rd=>{this.initializeOriginalContentSource(rd.payload)})),this.updateFieldTranslations(),this.translate.onLangChange.subscribe((()=>{this.updateFieldTranslations()}))}initializeOriginalContentSource(contentSource){this.contentSource=contentSource,this.initialHarvestType=contentSource.harvestType,this.initializeMetadataConfigs();const initialContentSource=Object(lodash.cloneDeep)(this.contentSource);this.objectUpdatesService.initialize(this.url,[initialContentSource],new Date),this.update$=this.objectUpdatesService.getFieldUpdates(this.url,[initialContentSource]).pipe(Object(map.a)((updates=>updates[initialContentSource.uuid]))),this.updateSub=this.update$.subscribe((update=>{if(update){const field=update.field;let configId;Object(empty_util.b)(this.contentSource)&&Object(empty_util.e)(this.contentSource.metadataConfigs)&&(configId=this.contentSource.metadataConfigs[0].id),Object(empty_util.b)(field)&&Object(empty_util.b)(field.metadataConfigId)&&(configId=field.metadataConfigId),Object(empty_util.b)(field)&&(this.formGroup.patchValue({oaiSourceContainer:{oaiSource:field.oaiSource},oaiSetContainer:{oaiSetId:field.oaiSetId,metadataConfigId:configId},harvestTypeContainer:{harvestType:field.harvestType}}),this.contentSource=Object(lodash.cloneDeep)(field)),this.contentSource.metadataConfigId=configId}}))}initializeMetadataConfigs(){this.metadataConfigIdModel.options=this.contentSource.metadataConfigs.map((metadataConfig=>Object.assign({value:metadataConfig.id,label:metadataConfig.label}))),this.metadataConfigIdModel.options.length>0&&this.formGroup.patchValue({oaiSetContainer:{metadataConfigId:this.metadataConfigIdModel.options[0].value}})}updateFieldTranslations(){this.inputModels.forEach((fieldModel=>{this.updateFieldTranslation(fieldModel)}))}updateFieldTranslation(fieldModel){fieldModel.label=this.translate.instant(this.LABEL_KEY_PREFIX+fieldModel.id),Object(empty_util.e)(fieldModel.validators)&&(fieldModel.errorMessages={},Object.keys(fieldModel.validators).forEach((key=>{fieldModel.errorMessages[key]=this.translate.instant(this.ERROR_KEY_PREFIX+fieldModel.id+"."+key)}))),fieldModel instanceof fesm2015_core.L&&Object(empty_util.e)(fieldModel.options)&&fieldModel.options.forEach((option=>{Object(empty_util.a)(option.label)&&(option.label=this.translate.instant(this.OPTIONS_KEY_PREFIX+fieldModel.id+"."+option.value))}))}onChange(event){this.updateContentSourceField(event.model,!0),this.saveFieldUpdate()}onSubmit(){this.collectionRD$.pipe(Object(operators.i)(),Object(map.a)((col=>col.payload.uuid)),Object(switchMap.a)((uuid=>this.collectionService.getHarvesterEndpoint(uuid))),Object(take.a)(1)).subscribe((endpoint=>this.requestService.removeByHrefSubstring(endpoint))),this.requestService.setStaleByHrefSubstring(this.contentSource._links.self.href),this.collectionRD$.pipe(Object(operators.i)(),Object(map.a)((col=>col.payload.uuid)),Object(switchMap.a)((uuid=>this.collectionService.updateContentSource(uuid,this.contentSource))),Object(take.a)(1)).subscribe((result=>{Object(empty_util.b)(result.harvestType)?(this.clearNotifications(),this.initializeOriginalContentSource(result),this.displayedNotifications.push(this.notificationsService.success(this.getNotificationTitle("saved"),this.getNotificationContent("saved")))):this.displayedNotifications.push(result)}))}onCancel(){this.location.back()}isValid(){return this.contentSource.harvestType===content_source_model.b.None||this.formGroup.valid}changeExternalSource(){this.contentSource.harvestType===content_source_model.b.None?this.contentSource.harvestType=this.previouslySelectedHarvestType:(this.previouslySelectedHarvestType=this.contentSource.harvestType,this.contentSource.harvestType=content_source_model.b.None),this.updateContentSource(!1)}updateContentSource(updateHarvestType){this.inputModels.forEach((fieldModel=>{this.updateContentSourceField(fieldModel,updateHarvestType)})),this.saveFieldUpdate()}updateContentSourceField(fieldModel,updateHarvestType){Object(empty_util.b)(fieldModel.value)&&(fieldModel.id!==this.harvestTypeModel.id||updateHarvestType)&&(this.contentSource[fieldModel.id]=fieldModel.value)}saveFieldUpdate(){this.objectUpdatesService.saveAddFieldUpdate(this.url,Object(lodash.cloneDeep)(this.contentSource))}clearNotifications(){this.displayedNotifications.forEach((notification=>{this.notificationsService.remove(notification)})),this.displayedNotifications=[]}ngOnDestroy(){this.updateSub&&this.updateSub.unsubscribe()}}collection_source_component_CollectionSourceComponent.\u0275fac=function CollectionSourceComponent_Factory(t){return new(t||collection_source_component_CollectionSourceComponent)(core["\u0275\u0275directiveInject"](object_updates_service.a),core["\u0275\u0275directiveInject"](notifications_service.a),core["\u0275\u0275directiveInject"](common.Location),core["\u0275\u0275directiveInject"](fesm2015_core.G),core["\u0275\u0275directiveInject"](ngx_translate_core.e),core["\u0275\u0275directiveInject"](fesm2015_router.a),core["\u0275\u0275directiveInject"](fesm2015_router.g),core["\u0275\u0275directiveInject"](collection_data_service.a),core["\u0275\u0275directiveInject"](request_service.a))},collection_source_component_CollectionSourceComponent.\u0275cmp=core["\u0275\u0275defineComponent"]({type:collection_source_component_CollectionSourceComponent,selectors:[["ds-collection-source"]],features:[core["\u0275\u0275InheritDefinitionFeature"]],decls:43,vars:27,consts:[[1,"container-fluid"],[1,"d-inline-block","float-right"],["class"," btn btn-danger",3,"disabled","click",4,"ngIf"],["class","btn btn-warning",3,"click",4,"ngIf"],[1,"btn","btn-primary",3,"disabled","click"],[1,"fas","fa-save"],[1,"d-none","d-sm-inline"],["class","form-check mb-4",4,"ngIf"],[3,"message",4,"ngIf"],[4,"ngIf"],[1,"row"],[3,"formId","formGroup","formModel","formLayout","displaySubmit","displayCancel","dfChange","submitForm","cancel",4,"ngIf"],["class","container mt-2",4,"ngIf"],[3,"isEnabled","shouldShow","collection"],[1,"btn","btn-danger",3,"disabled","click"],[1,"fas","fa-times"],[1,"btn","btn-warning",3,"click"],[1,"fas","fa-undo-alt"],[1,"form-check","mb-4"],["type","checkbox","id","externalSourceCheck",1,"form-check-input",3,"checked","change"],["for","externalSourceCheck",1,"form-check-label"],[3,"message"],[3,"formId","formGroup","formModel","formLayout","displaySubmit","displayCancel","dfChange","submitForm","cancel"],[1,"container","mt-2"],[1,"col-12"],[1,"d-inline-block","float-right","ml-1"]],template:function CollectionSourceComponent_Template(rf,ctx){if(1&rf&&(core["\u0275\u0275elementStart"](0,"div",0),core["\u0275\u0275text"](1,"\n    "),core["\u0275\u0275elementStart"](2,"div",1),core["\u0275\u0275text"](3,"\n        "),core["\u0275\u0275template"](4,CollectionSourceComponent_button_4_Template,8,6,"button",2),core["\u0275\u0275pipe"](5,"async"),core["\u0275\u0275text"](6,"\n        "),core["\u0275\u0275template"](7,CollectionSourceComponent_button_7_Template,7,3,"button",3),core["\u0275\u0275pipe"](8,"async"),core["\u0275\u0275text"](9,"\n        "),core["\u0275\u0275elementStart"](10,"button",4),core["\u0275\u0275listener"]("click",(function CollectionSourceComponent_Template_button_click_10_listener(){return ctx.onSubmit()})),core["\u0275\u0275pipe"](11,"async"),core["\u0275\u0275element"](12,"i",5),core["\u0275\u0275text"](13,"\n            "),core["\u0275\u0275elementStart"](14,"span",6),core["\u0275\u0275text"](15),core["\u0275\u0275pipe"](16,"translate"),core["\u0275\u0275elementEnd"](),core["\u0275\u0275text"](17,"\n        "),core["\u0275\u0275elementEnd"](),core["\u0275\u0275text"](18,"\n    "),core["\u0275\u0275elementEnd"](),core["\u0275\u0275text"](19,"\n    "),core["\u0275\u0275elementStart"](20,"h4"),core["\u0275\u0275text"](21),core["\u0275\u0275pipe"](22,"translate"),core["\u0275\u0275elementEnd"](),core["\u0275\u0275text"](23,"\n    "),core["\u0275\u0275template"](24,CollectionSourceComponent_div_24_Template,8,4,"div",7),core["\u0275\u0275text"](25,"\n    "),core["\u0275\u0275template"](26,CollectionSourceComponent_ds_loading_26_Template,2,3,"ds-loading",8),core["\u0275\u0275text"](27,"\n    "),core["\u0275\u0275template"](28,CollectionSourceComponent_h4_28_Template,3,3,"h4",9),core["\u0275\u0275text"](29,"\n"),core["\u0275\u0275elementEnd"](),core["\u0275\u0275text"](30,"\n"),core["\u0275\u0275elementStart"](31,"div",10),core["\u0275\u0275text"](32,"\n    "),core["\u0275\u0275template"](33,CollectionSourceComponent_ds_form_33_Template,1,6,"ds-form",11),core["\u0275\u0275text"](34,"\n"),core["\u0275\u0275elementEnd"](),core["\u0275\u0275text"](35,"\n"),core["\u0275\u0275template"](36,CollectionSourceComponent_div_36_Template,26,12,"div",12),core["\u0275\u0275text"](37,"\n"),core["\u0275\u0275elementStart"](38,"ds-collection-source-controls",13),core["\u0275\u0275pipe"](39,"async"),core["\u0275\u0275pipe"](40,"async"),core["\u0275\u0275text"](41,"\n"),core["\u0275\u0275elementEnd"](),core["\u0275\u0275text"](42,"\n\n")),2&rf){let tmp_12_0=null;core["\u0275\u0275advance"](4),core["\u0275\u0275property"]("ngIf",!core["\u0275\u0275pipeBind1"](5,13,ctx.isReinstatable())),core["\u0275\u0275advance"](3),core["\u0275\u0275property"]("ngIf",core["\u0275\u0275pipeBind1"](8,15,ctx.isReinstatable())),core["\u0275\u0275advance"](3),core["\u0275\u0275property"]("disabled",!core["\u0275\u0275pipeBind1"](11,17,ctx.hasChanges())||!ctx.isValid()||ctx.initialHarvestType===ctx.harvestTypeNone&&ctx.contentSource.harvestType===ctx.initialHarvestType),core["\u0275\u0275advance"](5),core["\u0275\u0275textInterpolate1"]("\xa0",core["\u0275\u0275pipeBind1"](16,19,"item.edit.metadata.save-button"),""),core["\u0275\u0275advance"](6),core["\u0275\u0275textInterpolate"](core["\u0275\u0275pipeBind1"](22,21,"collection.edit.tabs.source.head")),core["\u0275\u0275advance"](3),core["\u0275\u0275property"]("ngIf",ctx.contentSource),core["\u0275\u0275advance"](2),core["\u0275\u0275property"]("ngIf",!ctx.contentSource),core["\u0275\u0275advance"](2),core["\u0275\u0275property"]("ngIf",ctx.contentSource&&(null==ctx.contentSource?null:ctx.contentSource.harvestType)!==ctx.harvestTypeNone),core["\u0275\u0275advance"](5),core["\u0275\u0275property"]("ngIf",ctx.formGroup&&ctx.contentSource&&(null==ctx.contentSource?null:ctx.contentSource.harvestType)!==ctx.harvestTypeNone),core["\u0275\u0275advance"](3),core["\u0275\u0275property"]("ngIf",(null==ctx.contentSource?null:ctx.contentSource.harvestType)!==ctx.harvestTypeNone),core["\u0275\u0275advance"](2),core["\u0275\u0275property"]("isEnabled",!core["\u0275\u0275pipeBind1"](39,23,ctx.hasChanges()))("shouldShow",(null==ctx.contentSource?null:ctx.contentSource.harvestType)!==ctx.harvestTypeNone)("collection",null==(tmp_12_0=core["\u0275\u0275pipeBind1"](40,25,ctx.collectionRD$))?null:tmp_12_0.payload)}},directives:[common.NgIf,collection_source_controls_component_CollectionSourceControlsComponent,loading_component.a,form_component.a,fesm2015_forms.NgControlStatusGroup,fesm2015_forms.FormGroupDirective],pipes:[common.AsyncPipe,ngx_translate_core.d],encapsulation:2});var dso_name_service=__webpack_require__("C765"),curation_form_component=__webpack_require__("Rgmz");const collection_curate_component_c0=function(a0){return{collection:a0}};class collection_curate_component_CollectionCurateComponent{constructor(route,dsoNameService){this.route=route,this.dsoNameService=dsoNameService}ngOnInit(){this.dsoRD$=this.route.parent.data.pipe(Object(take.a)(1),Object(map.a)((data=>data.dso))),this.collectionName$=this.dsoRD$.pipe(Object(filter.a)((rd=>Object(empty_util.b)(rd))),Object(map.a)((rd=>this.dsoNameService.getName(rd.payload))))}}collection_curate_component_CollectionCurateComponent.\u0275fac=function CollectionCurateComponent_Factory(t){return new(t||collection_curate_component_CollectionCurateComponent)(core["\u0275\u0275directiveInject"](fesm2015_router.a),core["\u0275\u0275directiveInject"](dso_name_service.a))},collection_curate_component_CollectionCurateComponent.\u0275cmp=core["\u0275\u0275defineComponent"]({type:collection_curate_component_CollectionCurateComponent,selectors:[["ds-collection-curate"]],decls:11,vars:11,consts:[[1,"container"],[3,"dsoHandle"]],template:function CollectionCurateComponent_Template(rf,ctx){if(1&rf&&(core["\u0275\u0275elementStart"](0,"div",0),core["\u0275\u0275text"](1,"\n    "),core["\u0275\u0275elementStart"](2,"h3"),core["\u0275\u0275text"](3),core["\u0275\u0275pipe"](4,"translate"),core["\u0275\u0275pipe"](5,"async"),core["\u0275\u0275elementEnd"](),core["\u0275\u0275text"](6,"\n    "),core["\u0275\u0275element"](7,"ds-curation-form",1),core["\u0275\u0275pipe"](8,"async"),core["\u0275\u0275text"](9,"\n"),core["\u0275\u0275elementEnd"](),core["\u0275\u0275text"](10,"\n")),2&rf){let tmp_1_0=null;core["\u0275\u0275advance"](3),core["\u0275\u0275textInterpolate"](core["\u0275\u0275pipeBind2"](4,2,"collection.curate.header",core["\u0275\u0275pureFunction1"](9,collection_curate_component_c0,core["\u0275\u0275pipeBind1"](5,5,ctx.collectionName$)))),core["\u0275\u0275advance"](4),core["\u0275\u0275property"]("dsoHandle",null==(tmp_1_0=core["\u0275\u0275pipeBind1"](8,7,ctx.dsoRD$))?null:tmp_1_0.payload.handle)}},directives:[curation_form_component.a],pipes:[ngx_translate_core.d,common.AsyncPipe],encapsulation:2});var resource_policies_component=__webpack_require__("+Bs4");class collection_authorizations_component_CollectionAuthorizationsComponent{constructor(route){this.route=route}ngOnInit(){this.dsoRD$=this.route.parent.parent.data.pipe(Object(first.a)(),Object(map.a)((data=>data.dso)))}}collection_authorizations_component_CollectionAuthorizationsComponent.\u0275fac=function CollectionAuthorizationsComponent_Factory(t){return new(t||collection_authorizations_component_CollectionAuthorizationsComponent)(core["\u0275\u0275directiveInject"](fesm2015_router.a))},collection_authorizations_component_CollectionAuthorizationsComponent.\u0275cmp=core["\u0275\u0275defineComponent"]({type:collection_authorizations_component_CollectionAuthorizationsComponent,selectors:[["ds-collection-authorizations"]],decls:6,vars:4,consts:[[1,"container"],[3,"resourceType","resourceUUID"]],template:function CollectionAuthorizationsComponent_Template(rf,ctx){if(1&rf&&(core["\u0275\u0275elementStart"](0,"div",0),core["\u0275\u0275text"](1,"\n  "),core["\u0275\u0275element"](2,"ds-resource-policies",1),core["\u0275\u0275pipe"](3,"async"),core["\u0275\u0275text"](4,"\n"),core["\u0275\u0275elementEnd"](),core["\u0275\u0275text"](5,"\n")),2&rf){let tmp_1_0=null;core["\u0275\u0275advance"](2),core["\u0275\u0275property"]("resourceType","collection")("resourceUUID",null==(tmp_1_0=core["\u0275\u0275pipeBind1"](3,2,ctx.dsoRD$))||null==tmp_1_0.payload?null:tmp_1_0.payload.id)}},directives:[resource_policies_component.a],pipes:[common.AsyncPipe],encapsulation:2});var i18n_breadcrumb_resolver=__webpack_require__("A0IO"),resource_policy_target_resolver=__webpack_require__("n1Qy"),resource_policy_create_component=__webpack_require__("EEUA"),resource_policy_resolver=__webpack_require__("G5zm"),resource_policy_edit_component=__webpack_require__("ALMP"),single_feature_authorization_guard=__webpack_require__("rdLr"),authorization_data_service=__webpack_require__("1mcE"),auth_service=__webpack_require__("Vurf"),of=__webpack_require__("LRne"),feature_id=__webpack_require__("FU+A");class collection_administrator_guard_CollectionAdministratorGuard extends single_feature_authorization_guard.a{constructor(authorizationService,router,authService){super(authorizationService,router,authService),this.authorizationService=authorizationService,this.router=router,this.authService=authService}getFeatureID(route,state){return Object(of.a)(feature_id.a.IsCollectionAdmin)}}collection_administrator_guard_CollectionAdministratorGuard.\u0275fac=function CollectionAdministratorGuard_Factory(t){return new(t||collection_administrator_guard_CollectionAdministratorGuard)(core["\u0275\u0275inject"](authorization_data_service.a),core["\u0275\u0275inject"](fesm2015_router.g),core["\u0275\u0275inject"](auth_service.a))},collection_administrator_guard_CollectionAdministratorGuard.\u0275prov=core["\u0275\u0275defineInjectable"]({token:collection_administrator_guard_CollectionAdministratorGuard,factory:collection_administrator_guard_CollectionAdministratorGuard.\u0275fac,providedIn:"root"});class EditCollectionPageRoutingModule{}EditCollectionPageRoutingModule.\u0275fac=function EditCollectionPageRoutingModule_Factory(t){return new(t||EditCollectionPageRoutingModule)},EditCollectionPageRoutingModule.\u0275mod=core["\u0275\u0275defineNgModule"]({type:EditCollectionPageRoutingModule}),EditCollectionPageRoutingModule.\u0275inj=core["\u0275\u0275defineInjector"]({providers:[resource_policy_resolver.a,resource_policy_target_resolver.a],imports:[[fesm2015_router.k.forChild([{path:"",resolve:{breadcrumb:i18n_breadcrumb_resolver.a},data:{breadcrumbKey:"collection.edit"},component:edit_collection_page_component_EditCollectionPageComponent,canActivate:[collection_administrator_guard_CollectionAdministratorGuard],children:[{path:"",redirectTo:"metadata",pathMatch:"full"},{path:"metadata",component:collection_metadata_component_CollectionMetadataComponent,data:{title:"collection.edit.tabs.metadata.title",hideReturnButton:!0,showBreadcrumbs:!0}},{path:"roles",component:collection_roles_component_CollectionRolesComponent,data:{title:"collection.edit.tabs.roles.title",showBreadcrumbs:!0}},{path:"source",component:collection_source_component_CollectionSourceComponent,data:{title:"collection.edit.tabs.source.title",showBreadcrumbs:!0}},{path:"curate",component:collection_curate_component_CollectionCurateComponent,data:{title:"collection.edit.tabs.curate.title",showBreadcrumbs:!0}},{path:"authorizations",data:{showBreadcrumbs:!0},children:[{path:"create",resolve:{resourcePolicyTarget:resource_policy_target_resolver.a},component:resource_policy_create_component.a,data:{title:"resource-policies.create.page.title"}},{path:"edit",resolve:{resourcePolicy:resource_policy_resolver.a},component:resource_policy_edit_component.a,data:{title:"resource-policies.edit.page.title"}},{path:"",component:collection_authorizations_component_CollectionAuthorizationsComponent,data:{title:"collection.edit.tabs.authorizations.title",showBreadcrumbs:!0}}]},{path:"mapper",component:collection_item_mapper_component.a,data:{title:"collection.edit.tabs.item-mapper.title",hideReturnButton:!0,showBreadcrumbs:!0}}]}])]]});var collection_form_module=__webpack_require__("nVrp"),resource_policies_module=__webpack_require__("GFj5"),form_module=__webpack_require__("kcqd"),comcol_module=__webpack_require__("fY2w");class EditCollectionPageModule{}EditCollectionPageModule.\u0275fac=function EditCollectionPageModule_Factory(t){return new(t||EditCollectionPageModule)},EditCollectionPageModule.\u0275mod=core["\u0275\u0275defineNgModule"]({type:EditCollectionPageModule}),EditCollectionPageModule.\u0275inj=core["\u0275\u0275defineInjector"]({imports:[[common.CommonModule,shared_module.a,EditCollectionPageRoutingModule,collection_form_module.a,resource_policies_module.a,form_module.a,comcol_module.a]]})}};